<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VA Driving Clinic - Age & Driving Simulations</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root {
            --color-primary: #5f17eb;
            --color-primary-soft: #8a5feb;
            --color-secondary: #000000;
            --color-success: #10b981;
            --color-error: #ef4444;
            --color-warning: #f59e0b;
            --color-info: #3b82f6;
            --color-bg: #ffffff;
            --color-text: #000000;
            --color-muted: #6b7280;
            --color-light: #f9fafb;
            --radius-lg: 20px;
            --radius-md: 12px;
            --radius-sm: 8px;
            --shadow-soft: 0 10px 30px rgba(95, 23, 235, 0.1);
            --shadow-hover: 0 15px 35px rgba(95, 23, 235, 0.15);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            color: var(--color-text);
            line-height: 1.6;
            min-height: 100vh;
        }

        @media (max-width: 600px) {
            body { padding: 10px; }
        }

        /* Animations */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(95, 23, 235, 0.5); }
            50% { box-shadow: 0 0 20px rgba(95, 23, 235, 0.8); }
        }

        /* Main Container */
        .page {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            background: var(--color-bg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            padding: 25px;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease-out;
            border: 1px solid rgba(95, 23, 235, 0.1);
        }

        /* Header */
        .brand-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .brand-logo {
            height: 45px;
            width: auto;
            transition: transform 0.3s ease;
        }

        .course-meta {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .course-name {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--color-primary);
            font-weight: 700;
        }

        .week-label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 5px 10px;
            border-radius: 999px;
            background: rgba(95, 23, 235, 0.1);
            font-size: 0.75rem;
            color: var(--color-primary);
            font-weight: 600;
            border: 1px solid rgba(95, 23, 235, 0.2);
        }

        .week-label-dot {
            width: 6px;
            height: 6px;
            border-radius: 999px;
            background: var(--color-primary);
            flex-shrink: 0;
            animation: pulse 2s infinite;
        }

        .badge-mode {
            padding: 5px 10px;
            border-radius: 999px;
            background: rgba(95, 23, 235, 0.08);
            border: 1px solid rgba(95, 23, 235, 0.15);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--color-primary);
            white-space: nowrap;
            font-weight: 600;
        }

        h1 {
            font-size: 1.6rem;
            line-height: 1.1;
            color: var(--color-text);
            margin-bottom: 8px;
        }

        .module-subtitle {
            font-size: 0.9rem;
            color: var(--color-muted);
            margin-bottom: 25px;
            line-height: 1.6;
        }

        /* Time Banner */
        .time-banner {
            background: linear-gradient(135deg, rgba(95, 23, 235, 0.1) 0%, rgba(124, 58, 237, 0.1) 100%);
            border: 2px solid rgba(95, 23, 235, 0.2);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .time-icon {
            font-size: 1.2rem;
            color: var(--color-primary);
            background: rgba(95, 23, 235, 0.1);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .time-content h3 {
            color: var(--color-primary);
            font-size: 0.9rem;
            margin-bottom: 4px;
            font-weight: 700;
        }

        .time-content p {
            color: var(--color-text);
            font-size: 0.8rem;
            margin: 0;
        }

        .time-highlight {
            color: var(--color-primary);
            font-weight: 800;
            font-size: 1em;
        }

        /* Progress Bar */
        .progress-container {
            margin-bottom: 25px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .progress-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--color-primary);
        }

        .progress-percentage {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--color-primary);
        }

        .progress-bar {
            height: 8px;
            background: rgba(95, 23, 235, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--color-primary), var(--color-primary-soft));
            border-radius: 4px;
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Simulation Cards */
        .simulation-cards {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 25px;
        }

        .simulation-card {
            background: var(--color-light);
            border-radius: var(--radius-md);
            padding: 20px;
            border: 2px solid rgba(95, 23, 235, 0.1);
            transition: all 0.3s ease;
        }

        .simulation-card.active {
            border-color: var(--color-primary);
            box-shadow: var(--shadow-hover);
        }

        .simulation-card.completed {
            border-color: var(--color-success);
            background: rgba(16, 185, 129, 0.05);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .simulation-icon {
            width: 40px;
            height: 40px;
            background: var(--color-primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
            flex-shrink: 0;
        }

        .simulation-card.completed .simulation-icon {
            background: var(--color-success);
        }

        .simulation-info h3 {
            font-size: 1.1rem;
            color: var(--color-text);
            margin-bottom: 4px;
        }

        .simulation-info p {
            font-size: 0.8rem;
            color: var(--color-muted);
        }

        .simulation-status {
            margin-left: auto;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            background: rgba(95, 23, 235, 0.1);
            color: var(--color-primary);
        }

        .simulation-card.completed .simulation-status {
            background: rgba(16, 185, 129, 0.1);
            color: var(--color-success);
        }

        /* Simulation Content */
        .simulation-content {
            display: none;
        }

        .simulation-card.active .simulation-content {
            display: block;
            animation: fadeInUp 0.5s ease;
        }

        /* Reaction Time Test */
        .reaction-test {
            text-align: center;
            padding: 20px 0;
        }

        .reaction-visual {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 150px;
            margin: 20px 0;
            position: relative;
        }

        .reaction-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--color-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(95, 23, 235, 0.3);
        }

        .reaction-circle:hover {
            transform: scale(1.05);
        }

        .reaction-circle.waiting {
            background: var(--color-warning);
            animation: pulse 1s infinite;
        }

        .reaction-circle.ready {
            background: var(--color-success);
            animation: pulse 0.5s infinite;
        }

        .reaction-circle.slow {
            background: var(--color-error);
        }

        .reaction-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .stat-box {
            background: white;
            border-radius: var(--radius-sm);
            padding: 15px;
            text-align: center;
            border: 2px solid rgba(95, 23, 235, 0.1);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--color-primary);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--color-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .age-comparison {
            background: rgba(95, 23, 235, 0.05);
            border-radius: var(--radius-md);
            padding: 15px;
            border-left: 4px solid var(--color-primary);
            margin-top: 20px;
        }

        .comparison-title {
            color: var(--color-primary);
            font-weight: 700;
            margin-bottom: 12px;
            font-size: 0.9rem;
        }

        .comparison-chart {
            display: flex;
            align-items: flex-end;
            gap: 10px;
            height: 120px;
            padding: 15px 0;
        }

        .chart-bar {
            flex: 1;
            background: rgba(95, 23, 235, 0.2);
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: height 1s ease;
            min-width: 50px;
        }

        .chart-bar.active {
            background: var(--color-primary);
        }

        .chart-label {
            position: absolute;
            bottom: -20px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--color-text);
        }

        .chart-value {
            position: absolute;
            top: -20px;
            left: 0;
            right: 0;
            text-align: center;
            font-weight: 700;
            font-size: 0.7rem;
            color: var(--color-primary);
        }

        /* Vision Challenge */
        .vision-challenge {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .vision-scene {
            width: 100%;
            height: 250px;
            background: linear-gradient(135deg, #1a1a1a 0%, #333333 100%);
            border-radius: var(--radius-md);
            position: relative;
            overflow: hidden;
            border: 3px solid #444;
        }

        .vision-object {
            position: absolute;
            background: var(--color-warning);
            border-radius: 50%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .vision-object:hover {
            transform: scale(1.1);
        }

        .vision-object.found {
            background: var(--color-success);
            animation: pulse 0.5s;
        }

        .vision-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%;
        }

        .vision-results {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            width: 100%;
            margin-top: 10px;
        }

        /* Cognitive Test */
        .cognitive-test {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .cognitive-instructions {
            background: rgba(95, 23, 235, 0.05);
            border-radius: var(--radius-md);
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid var(--color-primary);
            width: 100%;
        }

        .instructions-title {
            color: var(--color-primary);
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .cognitive-instructions p {
            font-size: 0.8rem;
            color: var(--color-muted);
        }

        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .memory-card {
            width: 70px;
            height: 70px;
            background: var(--color-primary);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: 700;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        @media (max-width: 600px) {
            .memory-card {
                width: 60px;
                height: 60px;
                font-size: 1rem;
            }
        }

        .memory-card:hover {
            transform: scale(1.05);
        }

        .memory-card.hidden {
            background: rgba(95, 23, 235, 0.2);
            color: transparent;
        }

        .memory-card.matched {
            background: var(--color-success);
            cursor: default;
            transform: scale(1);
        }

        .memory-card.active {
            background: var(--color-warning);
            transform: scale(1.1);
        }

        .cognitive-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            width: 100%;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border-radius: var(--radius-md);
            border: none;
            font-size: 0.8rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
            border: 2px solid var(--color-primary);
        }

        .btn-primary:hover {
            background: #4c0fcf;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(95, 23, 235, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--color-primary);
            border: 2px solid var(--color-primary);
        }

        .btn-secondary:hover {
            background: rgba(95, 23, 235, 0.1);
            transform: translateY(-2px);
        }

        .btn-icon {
            font-size: 1em;
            font-weight: bold;
        }

        /* Results Summary */
        .results-summary {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            color: white;
            border-radius: var(--radius-md);
            padding: 25px;
            margin-top: 25px;
            display: none;
            border: 2px solid var(--color-primary);
        }

        .results-summary.show {
            display: block;
            animation: fadeInUp 0.6s ease;
        }

        .summary-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .summary-header h3 {
            color: white;
            font-size: 1.3rem;
            margin-bottom: 10px;
        }

        .summary-score {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--color-primary);
            text-shadow: 0 0 15px rgba(95, 23, 235, 0.7);
            animation: pulse 2s infinite;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .summary-stat {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
            padding: 15px;
            text-align: center;
        }

        .summary-value {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--color-primary);
            margin-bottom: 5px;
        }

        .summary-label {
            font-size: 0.75rem;
            color: #e5e7eb;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .summary-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <main class="page">
        <!-- Header -->
        <header class="brand-row">
            <div class="brand">
                <img
                    src="https://lwfiles.mycourse.app/vadrivingclinic-public/9f5c6b8121721c8ef241f929fd983b3e.png"
                    alt="VA Driving Clinic logo"
                    class="brand-logo"
                />
                <div class="course-meta">
                    <span class="course-name">VA Driving Clinic ‚Ä¢ Quick Simulation</span>
                    <div class="week-label">
                        <span class="week-label-dot"></span>
                        <span>Age & Driving</span>
                    </div>
                </div>
            </div>
            <span class="badge-mode">5-Min Challenge</span>
        </header>

        <h1>Experience Age-Related Changes</h1>
        <p class="module-subtitle">
            Complete these 3 quick simulations to experience how aging affects driving abilities.
            Each simulation takes about 1-2 minutes.
        </p>

        <!-- Time Banner -->
        <div class="time-banner">
            <div class="time-icon">
                ‚è±Ô∏è
            </div>
            <div class="time-content">
                <h3>5-Minute Simulation Challenge</h3>
                <p>Complete all 3 simulations in <span class="time-highlight">5 minutes</span> to understand age-related driving changes.</p>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-header">
                <span class="progress-label">Simulation Progress</span>
                <span class="progress-percentage" id="progress-percentage">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>

        <!-- Simulation Cards -->
        <div class="simulation-cards">
            <!-- Simulation 1: Reaction Time -->
            <div class="simulation-card active" id="simulation-1">
                <div class="card-header">
                    <div class="simulation-icon">‚ö°</div>
                    <div class="simulation-info">
                        <h3>Reaction Time Challenge</h3>
                        <p>Test your response speed compared to different age groups</p>
                    </div>
                    <span class="simulation-status" id="status-1">Active</span>
                </div>
                
                <div class="simulation-content">
                    <div class="reaction-test">
                        <div class="reaction-visual">
                            <div class="reaction-circle" id="reactionCircle">
                                Click when GREEN
                            </div>
                        </div>
                        
                        <div class="action-buttons" style="justify-content: center;">
                            <button class="btn btn-primary" id="startReactionTest">
                                <span class="btn-icon">‚ñ∂</span>
                                Start Test
                            </button>
                            <button class="btn btn-secondary" id="resetReactionTest">
                                <span class="btn-icon">‚Üª</span>
                                Reset
                            </button>
                        </div>
                        
                        <div class="reaction-stats" id="reactionStats" style="display: none;">
                            <div class="stat-box">
                                <div class="stat-value" id="yourTime">0 ms</div>
                                <div class="stat-label">Your Time</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="ageGroupTime">220 ms</div>
                                <div class="stat-label">Avg (20s-30s)</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="difference">0%</div>
                                <div class="stat-label">Difference</div>
                            </div>
                        </div>
                        
                        <div class="age-comparison">
                            <div class="comparison-title">Age vs Reaction Time</div>
                            <div class="comparison-chart" id="reactionChart"></div>
                        </div>
                        
                        <div class="action-buttons" style="margin-top: 15px;">
                            <button class="btn btn-secondary" id="next-1">
                                <span class="btn-icon">‚Üí</span>
                                Next Simulation
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Simulation 2: Vision Challenge -->
            <div class="simulation-card" id="simulation-2">
                <div class="card-header">
                    <div class="simulation-icon">üëÅÔ∏è</div>
                    <div class="simulation-info">
                        <h3>Night Vision Challenge</h3>
                        <p>Experience age-related vision changes and glare sensitivity</p>
                    </div>
                    <span class="simulation-status" id="status-2">Locked</span>
                </div>
                
                <div class="simulation-content">
                    <div class="vision-challenge">
                        <div class="vision-scene" id="visionScene"></div>
                        
                        <div class="vision-controls">
                            <button class="btn btn-primary" id="startVisionTest">Start Challenge</button>
                            <button class="btn btn-secondary" id="addGlare">Add Glare Effect</button>
                            <button class="btn btn-secondary" id="resetVisionTest">Reset</button>
                        </div>
                        
                        <div class="vision-results" id="visionResults" style="display: none;">
                            <div class="stat-box">
                                <div class="stat-value" id="objectsFound">0</div>
                                <div class="stat-label">Found</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="timeTaken">0s</div>
                                <div class="stat-label">Time</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="visionScore">0%</div>
                                <div class="stat-label">Score</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="ageImpact">-20%</div>
                                <div class="stat-label">Age Impact</div>
                            </div>
                        </div>
                        
                        <div class="action-buttons" style="margin-top: 15px;">
                            <button class="btn btn-secondary" id="next-2">
                                <span class="btn-icon">‚Üí</span>
                                Next Simulation
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Simulation 3: Cognitive Test -->
            <div class="simulation-card" id="simulation-3">
                <div class="card-header">
                    <div class="simulation-icon">üß†</div>
                    <div class="simulation-info">
                        <h3>Cognitive Load Test</h3>
                        <p>Test memory and multitasking abilities affected by aging</p>
                    </div>
                    <span class="simulation-status" id="status-3">Locked</span>
                </div>
                
                <div class="simulation-content">
                    <div class="cognitive-test">
                        <div class="cognitive-instructions">
                            <div class="instructions-title">Instructions</div>
                            <p>Memorize the pattern, then recreate it. This simulates the cognitive load of driving.</p>
                        </div>
                        
                        <div class="memory-grid" id="memoryGrid"></div>
                        
                        <div class="action-buttons">
                            <button class="btn btn-primary" id="showPattern">
                                <span class="btn-icon">üëÅÔ∏è</span>
                                Show Pattern
                            </button>
                            <button class="btn btn-secondary" id="checkPattern">
                                <span class="btn-icon">‚úì</span>
                                Check Match
                            </button>
                            <button class="btn btn-secondary" id="resetMemory">
                                <span class="btn-icon">‚Üª</span>
                                New Pattern
                            </button>
                        </div>
                        
                        <div class="cognitive-stats" id="cognitiveStats" style="display: none;">
                            <div class="stat-box">
                                <div class="stat-value" id="attempts">0</div>
                                <div class="stat-label">Attempts</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="accuracy">0%</div>
                                <div class="stat-label">Accuracy</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="cognitiveAge">-</div>
                                <div class="stat-label">Cognitive Age</div>
                            </div>
                        </div>
                        
                        <div class="action-buttons" style="margin-top: 15px;">
                            <button class="btn btn-primary" id="showResults">
                                <span class="btn-icon">üìä</span>
                                View Results
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Summary -->
        <div class="results-summary" id="resultsSummary">
            <div class="summary-header">
                <h3>Simulation Results</h3>
                <div class="summary-score" id="finalScore">0%</div>
                <p style="color: #e5e7eb; font-size: 0.9rem;">Based on your performance across all simulations</p>
            </div>
            
            <div class="summary-stats">
                <div class="summary-stat">
                    <div class="summary-value" id="resultReaction">0%</div>
                    <div class="summary-label">Reaction Time</div>
                </div>
                <div class="summary-stat">
                    <div class="summary-value" id="resultVision">0%</div>
                    <div class="summary-label">Vision</div>
                </div>
                <div class="summary-stat">
                    <div class="summary-value" id="resultCognitive">0%</div>
                    <div class="summary-label">Cognitive</div>
                </div>
                <div class="summary-stat">
                    <div class="summary-value" id="overallAge">-</div>
                    <div class="summary-label">Simulated Age</div>
                </div>
            </div>
            
            <div class="summary-actions">
                <button class="btn btn-primary" id="retakeAll">
                    <span class="btn-icon">üîÑ</span>
                    Retake All
                </button>
                <button class="btn btn-secondary" onclick="window.print()">
                    <span class="btn-icon">üñ®Ô∏è</span>
                    Print Results
                </button>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // State Management
            const state = {
                currentSimulation: 1,
                completedSimulations: {
                    1: false,
                    2: false,
                    3: false
                },
                scores: {
                    reaction: 0,
                    vision: 0,
                    cognitive: 0
                },
                startTime: new Date()
            };

            // DOM Elements
            const simulationCards = document.querySelectorAll('.simulation-card');
            const progressFill = document.getElementById('progress-fill');
            const progressPercentage = document.getElementById('progress-percentage');
            const resultsSummary = document.getElementById('resultsSummary');

            // Navigation between simulations
            document.getElementById('next-1').addEventListener('click', () => activateSimulation(2));
            document.getElementById('next-2').addEventListener('click', () => activateSimulation(3));
            document.getElementById('showResults').addEventListener('click', showResults);
            document.getElementById('retakeAll').addEventListener('click', resetAll);

            // Update progress
            function updateProgress() {
                const completedCount = Object.values(state.completedSimulations).filter(Boolean).length;
                const percentage = Math.round((completedCount / 3) * 100);
                
                progressFill.style.width = `${percentage}%`;
                progressPercentage.textContent = `${percentage}%`;
                
                if (completedCount === 3) {
                    progressFill.style.background = 'linear-gradient(90deg, #10b981, #34d399)';
                }
            }

            // Activate simulation
            function activateSimulation(number) {
                // Mark current as completed if not already
                if (!state.completedSimulations[state.currentSimulation]) {
                    state.completedSimulations[state.currentSimulation] = true;
                    const currentCard = document.getElementById(`simulation-${state.currentSimulation}`);
                    currentCard.classList.remove('active');
                    currentCard.classList.add('completed');
                    document.getElementById(`status-${state.currentSimulation}`).textContent = 'Completed';
                }
                
                // Update current simulation
                state.currentSimulation = number;
                
                // Update all cards
                simulationCards.forEach(card => {
                    card.classList.remove('active');
                });
                
                const targetCard = document.getElementById(`simulation-${number}`);
                targetCard.classList.add('active');
                
                // Update status if not completed
                if (!state.completedSimulations[number]) {
                    document.getElementById(`status-${number}`).textContent = 'Active';
                }
                
                updateProgress();
            }

            // Show results
            function showResults() {
                if (!state.completedSimulations[3]) {
                    state.completedSimulations[3] = true;
                    const card = document.getElementById('simulation-3');
                    card.classList.remove('active');
                    card.classList.add('completed');
                    document.getElementById('status-3').textContent = 'Completed';
                }
                
                // Calculate final scores
                const avgScore = Math.round((state.scores.reaction + state.scores.vision + state.scores.cognitive) / 3);
                
                // Determine simulated age based on scores
                let simulatedAge;
                if (avgScore >= 85) simulatedAge = "20-30s";
                else if (avgScore >= 70) simulatedAge = "40-50s";
                else if (avgScore >= 55) simulatedAge = "60-70s";
                else simulatedAge = "70+";
                
                // Update results display
                document.getElementById('finalScore').textContent = `${avgScore}%`;
                document.getElementById('resultReaction').textContent = `${state.scores.reaction}%`;
                document.getElementById('resultVision').textContent = `${state.scores.vision}%`;
                document.getElementById('resultCognitive').textContent = `${state.scores.cognitive}%`;
                document.getElementById('overallAge').textContent = simulatedAge;
                
                // Show results
                resultsSummary.classList.add('show');
                resultsSummary.scrollIntoView({ behavior: 'smooth' });
                
                updateProgress();
            }

            // Reset all simulations
            function resetAll() {
                // Reset state
                state.currentSimulation = 1;
                state.completedSimulations = { 1: false, 2: false, 3: false };
                state.scores = { reaction: 0, vision: 0, cognitive: 0 };
                state.startTime = new Date();
                
                // Reset UI
                simulationCards.forEach((card, index) => {
                    card.classList.remove('active', 'completed');
                    document.getElementById(`status-${index + 1}`).textContent = 'Locked';
                });
                
                // Activate first simulation
                document.getElementById('simulation-1').classList.add('active');
                document.getElementById('status-1').textContent = 'Active';
                
                // Hide results
                resultsSummary.classList.remove('show');
                
                // Reset individual simulations
                resetReactionTest();
                resetVisionTest();
                resetMemoryGame();
                
                updateProgress();
            }

            // ------------------------------------------------------------------
            // SIMULATION 1: REACTION TIME TEST
            // ------------------------------------------------------------------
            const reactionCircle = document.getElementById('reactionCircle');
            const startReactionBtn = document.getElementById('startReactionTest');
            const resetReactionBtn = document.getElementById('resetReactionTest');
            const reactionStats = document.getElementById('reactionStats');
            
            let reactionStartTime = 0;
            let reactionTimes = [];
            let testActive = false;
            let waitTimeout;

            // Age reaction time data (in milliseconds)
            const ageReactionData = [
                { age: '20-30', time: 220 },
                { age: '30-40', time: 240 },
                { age: '40-50', time: 260 },
                { age: '50-60', time: 290 },
                { age: '60-70', time: 320 },
                { age: '70-80', time: 380 }
            ];

            // Create comparison chart
            function createReactionChart() {
                const chart = document.getElementById('reactionChart');
                chart.innerHTML = '';
                
                ageReactionData.forEach(data => {
                    const bar = document.createElement('div');
                    bar.className = 'chart-bar';
                    bar.style.height = `${(data.time / 500) * 100}%`;
                    
                    const label = document.createElement('div');
                    label.className = 'chart-label';
                    label.textContent = data.age;
                    
                    const value = document.createElement('div');
                    value.className = 'chart-value';
                    value.textContent = `${data.time}ms`;
                    
                    bar.appendChild(value);
                    bar.appendChild(label);
                    chart.appendChild(bar);
                });
            }

            createReactionChart();

            startReactionBtn.addEventListener('click', () => {
                if (testActive) return;
                
                testActive = true;
                reactionCircle.textContent = "Wait for GREEN...";
                reactionCircle.classList.add('waiting');
                
                // Random wait between 2-5 seconds
                const waitTime = Math.random() * 3000 + 2000;
                
                waitTimeout = setTimeout(() => {
                    reactionCircle.textContent = "CLICK NOW!";
                    reactionCircle.classList.remove('waiting');
                    reactionCircle.classList.add('ready');
                    reactionStartTime = Date.now();
                }, waitTime);
            });

            reactionCircle.addEventListener('click', () => {
                if (!testActive || !reactionStartTime) return;
                
                const reactionTime = Date.now() - reactionStartTime;
                reactionTimes.push(reactionTime);
                
                // Calculate score (lower time = higher score)
                const maxTime = 500; // 500ms is very slow
                const score = Math.max(0, 100 - ((reactionTime - 220) / (maxTime - 220) * 100));
                state.scores.reaction = Math.round(score);
                
                // Update display
                document.getElementById('yourTime').textContent = `${reactionTime}ms`;
                
                // Calculate average for age group 20-30
                const ageGroupTime = 220;
                document.getElementById('ageGroupTime').textContent = `${ageGroupTime}ms`;
                
                // Calculate difference
                const difference = Math.round(((reactionTime - ageGroupTime) / ageGroupTime) * 100);
                document.getElementById('difference').textContent = `${difference > 0 ? '+' : ''}${difference}%`;
                
                // Show stats
                reactionStats.style.display = 'grid';
                
                // Reset for next test
                testActive = false;
                reactionStartTime = 0;
                reactionCircle.classList.remove('ready');
                reactionCircle.textContent = "Click when GREEN";
                
                // Visual feedback
                if (reactionTime > 400) {
                    reactionCircle.classList.add('slow');
                    setTimeout(() => reactionCircle.classList.remove('slow'), 1000);
                }
                
                // Mark as completed
                state.completedSimulations[1] = true;
                updateProgress();
            });

            resetReactionBtn.addEventListener('click', resetReactionTest);

            function resetReactionTest() {
                clearTimeout(waitTimeout);
                testActive = false;
                reactionStartTime = 0;
                reactionTimes = [];
                reactionCircle.classList.remove('waiting', 'ready', 'slow');
                reactionCircle.textContent = "Click when GREEN";
                reactionStats.style.display = 'none';
                createReactionChart();
            }

            // ------------------------------------------------------------------
            // SIMULATION 2: VISION CHALLENGE
            // ------------------------------------------------------------------
            const visionScene = document.getElementById('visionScene');
            const startVisionBtn = document.getElementById('startVisionTest');
            const addGlareBtn = document.getElementById('addGlare');
            const resetVisionBtn = document.getElementById('resetVisionTest');
            const visionResults = document.getElementById('visionResults');
            
            let visionTestActive = false;
            let objectsToFind = [];
            let objectsFound = 0;
            let visionStartTime = 0;
            let glareActive = false;

            function createVisionObjects() {
                visionScene.innerHTML = '';
                objectsToFind = [];
                objectsFound = 0;
                
                // Create 8 random objects
                for (let i = 0; i < 8; i++) {
                    const object = document.createElement('div');
                    object.className = 'vision-object';
                    object.textContent = i + 1;
                    
                    // Random position (avoid edges)
                    const size = 30 + Math.random() * 25;
                    const x = 15 + Math.random() * (visionScene.offsetWidth - size - 30);
                    const y = 15 + Math.random() * (visionScene.offsetHeight - size - 30);
                    
                    object.style.width = `${size}px`;
                    object.style.height = `${size}px`;
                    object.style.left = `${x}px`;
                    object.style.top = `${y}px`;
                    
                    // Random color variation
                    const brightness = 150 + Math.random() * 100;
                    object.style.backgroundColor = `rgb(${brightness}, ${brightness - 50}, 0)`;
                    
                    object.addEventListener('click', () => {
                        if (!visionTestActive || object.classList.contains('found')) return;
                        
                        object.classList.add('found');
                        objectsFound++;
                        document.getElementById('objectsFound').textContent = objectsFound;
                        
                        if (objectsFound === 8) {
                            finishVisionTest();
                        }
                    });
                    
                    visionScene.appendChild(object);
                    objectsToFind.push(object);
                }
            }

            startVisionBtn.addEventListener('click', () => {
                createVisionObjects();
                visionTestActive = true;
                visionStartTime = Date.now();
                objectsFound = 0;
                visionResults.style.display = 'none';
                
                // Hide objects after 3 seconds (simulating brief glimpse)
                setTimeout(() => {
                    objectsToFind.forEach(obj => {
                        obj.style.backgroundColor = '#333';
                        obj.style.color = '#333';
                    });
                }, 3000);
            });

            addGlareBtn.addEventListener('click', () => {
                if (!visionTestActive) return;
                
                glareActive = !glareActive;
                
                if (glareActive) {
                    // Add glare effect
                    visionScene.style.background = 'radial-gradient(circle at 30% 30%, #fff 0%, #333 70%)';
                    visionScene.style.filter = 'brightness(1.5)';
                    addGlareBtn.textContent = 'Remove Glare';
                } else {
                    // Remove glare
                    visionScene.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #333333 100%)';
                    visionScene.style.filter = 'none';
                    addGlareBtn.textContent = 'Add Glare';
                }
            });

            function finishVisionTest() {
                visionTestActive = false;
                const timeTaken = (Date.now() - visionStartTime) / 1000;
                
                // Update results
                document.getElementById('timeTaken').textContent = `${timeTaken.toFixed(1)}s`;
                
                // Calculate score
                const maxTime = 60;
                const timeScore = Math.max(0, 100 - (timeTaken / maxTime * 100));
                const foundScore = (objectsFound / 8) * 100;
                const totalScore = Math.round((timeScore + foundScore) / 2);
                state.scores.vision = totalScore;
                
                document.getElementById('visionScore').textContent = `${totalScore}%`;
                
                // Age impact
                const ageImpact = glareActive ? -40 : -20;
                document.getElementById('ageImpact').textContent = `${ageImpact}%`;
                
                // Show results
                visionResults.style.display = 'grid';
                
                // Show all objects
                objectsToFind.forEach(obj => {
                    obj.style.backgroundColor = '#10b981';
                    obj.style.color = 'white';
                });
                
                // Mark as completed
                state.completedSimulations[2] = true;
                updateProgress();
            }

            resetVisionBtn.addEventListener('click', resetVisionTest);

            function resetVisionTest() {
                visionTestActive = false;
                glareActive = false;
                visionScene.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #333333 100%)';
                visionScene.style.filter = 'none';
                addGlareBtn.textContent = 'Add Glare';
                visionResults.style.display = 'none';
                createVisionObjects();
            }

            // Initialize vision objects
            createVisionObjects();

            // ------------------------------------------------------------------
            // SIMULATION 3: COGNITIVE TEST
            // ------------------------------------------------------------------
            const memoryGrid = document.getElementById('memoryGrid');
            const showPatternBtn = document.getElementById('showPattern');
            const checkPatternBtn = document.getElementById('checkPattern');
            const resetMemoryBtn = document.getElementById('resetMemory');
            const cognitiveStats = document.getElementById('cognitiveStats');
            
            let pattern = [];
            let userPattern = [];
            let gameActive = false;
            let attempts = 0;
            let correctMatches = 0;

            // Create memory game
            function createMemoryGame() {
                memoryGrid.innerHTML = '';
                pattern = [];
                userPattern = [];
                
                // Generate random pattern (4-6 cards)
                const patternLength = 4 + Math.floor(Math.random() * 3);
                const allCards = Array.from({length: 16}, (_, i) => i);
                
                // Shuffle and select pattern
                for (let i = 0; i < patternLength; i++) {
                    const randomIndex = Math.floor(Math.random() * allCards.length);
                    pattern.push(allCards[randomIndex]);
                    allCards.splice(randomIndex, 1);
                }
                
                // Create 16 cards
                for (let i = 0; i < 16; i++) {
                    const card = document.createElement('div');
                    card.className = 'memory-card hidden';
                    card.dataset.index = i;
                    card.textContent = '?';
                    
                    card.addEventListener('click', () => {
                        if (!gameActive || pattern.includes(i)) return;
                        
                        if (userPattern.includes(i)) {
                            // Remove from user pattern
                            const index = userPattern.indexOf(i);
                            userPattern.splice(index, 1);
                            card.classList.remove('active');
                            card.classList.add('hidden');
                            card.textContent = '?';
                        } else {
                            // Add to user pattern
                            userPattern.push(i);
                            card.classList.remove('hidden');
                            card.classList.add('active');
                            card.textContent = '‚úì';
                        }
                    });
                    
                    memoryGrid.appendChild(card);
                }
                
                // Reset stats display
                cognitiveStats.style.display = 'none';
            }

            showPatternBtn.addEventListener('click', () => {
                if (gameActive) return;
                
                gameActive = true;
                attempts++;
                
                // Show pattern
                pattern.forEach(index => {
                    const card = document.querySelector(`.memory-card[data-index="${index}"]`);
                    card.classList.remove('hidden');
                    card.textContent = '‚òÖ';
                    card.style.backgroundColor = '#f59e0b';
                });
                
                // Hide pattern after 3 seconds
                setTimeout(() => {
                    pattern.forEach(index => {
                        const card = document.querySelector(`.memory-card[data-index="${index}"]`);
                        card.classList.add('hidden');
                        card.textContent = '?';
                        card.style.backgroundColor = '';
                    });
                }, 3000);
            });

            checkPatternBtn.addEventListener('click', () => {
                if (!gameActive) return;
                
                // Check pattern match
                const correctCards = userPattern.filter(index => pattern.includes(index)).length;
                const incorrectCards = userPattern.filter(index => !pattern.includes(index)).length;
                const missedCards = pattern.filter(index => !userPattern.includes(index)).length;
                
                // Calculate accuracy
                const accuracy = Math.round((correctCards / pattern.length) * 100);
                correctMatches += correctCards === pattern.length && incorrectCards === 0 ? 1 : 0;
                state.scores.cognitive = accuracy;
                
                // Update stats
                document.getElementById('attempts').textContent = attempts;
                document.getElementById('accuracy').textContent = `${accuracy}%`;
                
                // Determine cognitive age based on accuracy
                let cognitiveAge;
                if (accuracy >= 90) cognitiveAge = "20-30s";
                else if (accuracy >= 70) cognitiveAge = "40-50s";
                else if (accuracy >= 50) cognitiveAge = "60-70s";
                else cognitiveAge = "70+";
                
                document.getElementById('cognitiveAge').textContent = cognitiveAge;
                
                // Show stats
                cognitiveStats.style.display = 'grid';
                
                // Visual feedback
                pattern.forEach(index => {
                    const card = document.querySelector(`.memory-card[data-index="${index}"]`);
                    if (userPattern.includes(index)) {
                        card.style.backgroundColor = '#10b981';
                        card.textContent = '‚úì';
                    } else {
                        card.style.backgroundColor = '#ef4444';
                        card.textContent = '‚úó';
                    }
                    card.classList.remove('hidden');
                });
                
                // Mark matched cards
                userPattern.forEach(index => {
                    if (pattern.includes(index)) {
                        const card = document.querySelector(`.memory-card[data-index="${index}"]`);
                        card.classList.add('matched');
                    }
                });
                
                gameActive = false;
                state.completedSimulations[3] = true;
                updateProgress();
            });

            resetMemoryBtn.addEventListener('click', resetMemoryGame);

            function resetMemoryGame() {
                gameActive = false;
                attempts = 0;
                correctMatches = 0;
                createMemoryGame();
            }

            // Initialize memory game
            createMemoryGame();
        });
    </script>
</body>
</html>
