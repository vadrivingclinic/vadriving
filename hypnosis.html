<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VA Driving Clinic - Module 5: Highway Hypnosis</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root {
            --color-primary: #5f17eb; /* Your exact brand purple */
            --color-primary-soft: #8a5feb;
            --color-secondary: #000000; /* Black */
            --color-accent: #7c3aed;
            --color-success: #10b981;
            --color-error: #ef4444;
            --color-warning: #f59e0b;
            --color-bg: #ffffff; /* White */
            --color-text: #000000; /* Black */
            --color-muted: #6b7280;
            --color-dark: #000000; /* Black */
            --color-light: #f9fafb;
            --radius-lg: 20px;
            --radius-md: 12px;
            --radius-sm: 8px;
            --shadow-soft: 0 10px 30px rgba(95, 23, 235, 0.1);
            --shadow-hover: 0 15px 35px rgba(95, 23, 235, 0.15);
            --shadow-card: 0 8px 25px rgba(0, 0, 0, 0.08);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            padding: 24px;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            color: var(--color-text);
            line-height: 1.6;
        }

        @media (max-width: 600px) {
            body { padding: 12px; }
        }

        /* Animations */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(95, 23, 235, 0.5); }
            50% { box-shadow: 0 0 20px rgba(95, 23, 235, 0.8); }
        }

        @keyframes roadMove {
            from { transform: translateY(-50%) translateX(0); }
            to { transform: translateY(-50%) translateX(-200px); }
        }

        @keyframes blinkWarning {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        @keyframes drowsyPulse {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(0.7); }
        }

        @keyframes alertFlash {
            0%, 100% { background: rgba(239, 68, 68, 0.1); }
            50% { background: rgba(239, 68, 68, 0.3); }
        }

        /* Main Container */
        .page {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--color-bg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            padding: 30px;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease-out;
            border: 1px solid rgba(95, 23, 235, 0.1);
        }

        @media (max-width: 900px) {
            .page { padding: 20px; }
        }

        @media (max-width: 480px) {
            body { padding: 0; }
            .page {
                border-radius: 0;
                box-shadow: none;
                padding: 16px 12px 20px;
            }
        }

        /* Header */
        .brand-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
            width: 100%;
            animation: fadeIn 0.6s ease-out 0.2s both;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .brand-logo {
            height: 50px;
            width: auto;
            max-width: 100%;
            transition: transform 0.3s ease;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .brand-logo:hover { 
            transform: scale(1.05); 
            animation: glow 2s infinite;
        }

        .course-meta {
            display: flex;
            flex-direction: column;
            gap: 4px;
            max-width: 100%;
        }

        .course-name {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--color-primary);
            font-weight: 700;
        }

        .week-label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 999px;
            background: rgba(95, 23, 235, 0.1);
            font-size: 0.8rem;
            color: var(--color-primary);
            font-weight: 600;
            border: 1px solid rgba(95, 23, 235, 0.2);
        }

        .week-label-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: var(--color-primary);
            flex-shrink: 0;
            animation: pulse 2s infinite;
        }

        .badge-mode {
            padding: 6px 12px;
            border-radius: 999px;
            background: rgba(95, 23, 235, 0.08);
            border: 1px solid rgba(95, 23, 235, 0.15);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--color-primary);
            white-space: nowrap;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .badge-mode:hover {
            background: rgba(95, 23, 235, 0.15);
            border-color: var(--color-primary);
            transform: translateY(-2px);
        }

        h1 {
            font-size: clamp(1.8rem, 3vw, 2.4rem);
            line-height: 1.1;
            color: var(--color-text);
            margin-bottom: 10px;
            animation: fadeInUp 0.6s ease-out 0.3s both;
        }

        .module-subtitle {
            font-size: 1rem;
            color: var(--color-muted);
            max-width: 800px;
            margin-bottom: 28px;
            animation: fadeInUp 0.6s ease-out 0.4s both;
            line-height: 1.7;
        }

        /* Time Estimate Banner */
        .time-estimate-banner {
            background: linear-gradient(135deg, rgba(95, 23, 235, 0.1) 0%, rgba(124, 58, 237, 0.1) 100%);
            border: 2px solid rgba(95, 23, 235, 0.2);
            border-radius: var(--radius-md);
            padding: 15px 20px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: fadeIn 0.5s ease;
        }

        .time-estimate-icon {
            font-size: 1.5rem;
            color: var(--color-primary);
            background: rgba(95, 23, 235, 0.1);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .time-estimate-content h3 {
            color: var(--color-primary);
            font-size: 1rem;
            margin-bottom: 5px;
            font-weight: 700;
        }

        .time-estimate-content p {
            color: var(--color-text);
            font-size: 0.9rem;
            margin: 0;
        }

        .time-highlight {
            color: var(--color-primary);
            font-weight: 800;
            font-size: 1.1em;
        }

        /* Progress Tracker */
        .progress-tracker {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
            padding: 0 20px;
        }

        .progress-tracker::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 50px;
            right: 50px;
            height: 3px;
            background: rgba(95, 23, 235, 0.1);
            z-index: 1;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            flex: 1;
        }

        .step-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: white;
            border: 2px solid rgba(95, 23, 235, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .progress-step.active .step-circle {
            background: var(--color-primary);
            border-color: var(--color-primary);
            color: white;
            transform: scale(1.1);
            animation: pulse 2s infinite;
        }

        .progress-step.completed .step-circle {
            background: var(--color-success);
            border-color: var(--color-success);
            color: white;
        }

        .step-label {
            font-size: 0.75rem;
            color: var(--color-muted);
            text-align: center;
            font-weight: 600;
        }

        .progress-step.active .step-label {
            color: var(--color-primary);
            font-weight: 700;
        }

        /* Stats Display */
        .stats-display {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 600px) {
            .stats-display { grid-template-columns: 1fr; }
        }

        .stat-card {
            background: rgba(95, 23, 235, 0.05);
            border-radius: var(--radius-md);
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(95, 23, 235, 0.1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--color-primary);
            box-shadow: 0 10px 25px rgba(95, 23, 235, 0.1);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--color-primary);
            display: block;
            line-height: 1;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--color-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: 600;
        }

        /* Activity Grid */
        .activity-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
            margin-bottom: 30px;
        }

        .activity-card {
            background: var(--color-bg);
            border-radius: var(--radius-md);
            border: 1px solid rgba(95, 23, 235, 0.15);
            padding: 24px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .activity-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--color-primary);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .activity-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
            border-color: var(--color-primary);
        }

        .activity-card:hover::before { 
            opacity: 1;
            animation: glow 2s infinite;
        }

        .activity-card.completed {
            border-color: var(--color-success);
        }

        .activity-card.completed::before {
            background: var(--color-success);
            opacity: 1;
        }

        .activity-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .activity-number {
            font-size: 0.85rem;
            font-weight: 800;
            color: var(--color-primary);
            background: rgba(95, 23, 235, 0.1);
            padding: 4px 12px;
            border-radius: 20px;
            border: 1px solid rgba(95, 23, 235, 0.2);
        }

        .activity-status {
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: 12px;
            background: rgba(95, 23, 235, 0.08);
            color: var(--color-primary);
            font-weight: 600;
            border: 1px solid rgba(95, 23, 235, 0.15);
        }

        .activity-card.completed .activity-status {
            background: rgba(16, 185, 129, 0.1);
            color: var(--color-success);
            border-color: rgba(16, 185, 129, 0.2);
        }

        .activity-title {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--color-text);
            margin-bottom: 12px;
        }

        .activity-description {
            font-size: 0.95rem;
            color: var(--color-muted);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        /* Activity Time Estimate */
        .activity-time-estimate {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
            padding: 8px 12px;
            background: rgba(95, 23, 235, 0.05);
            border-radius: var(--radius-sm);
            border-left: 3px solid var(--color-primary);
        }

        .activity-time-icon {
            color: var(--color-primary);
            font-weight: bold;
        }

        .activity-time-text {
            font-size: 0.85rem;
            color: var(--color-text);
            font-weight: 600;
        }

        /* Highway Driving Simulator */
        .highway-simulator {
            position: relative;
            height: 250px;
            background: linear-gradient(to bottom, #1e293b 0%, #0f172a 100%);
            border-radius: var(--radius-md);
            overflow: hidden;
            margin: 20px 0;
            border: 3px solid #334155;
        }

        .road-surface {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 120px;
            background: #475569;
            transform: translateY(-50%);
        }

        .lane-markers {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 6px;
            transform: translateY(-50%);
            background: repeating-linear-gradient(
                to right,
                transparent,
                transparent 40px,
                #f1f5f9 40px,
                #f1f5f9 80px
            );
            animation: roadMove 3s linear infinite;
        }

        .driver-car {
            position: absolute;
            bottom: 60px;
            left: 100px;
            width: 70px;
            height: 35px;
            background: var(--color-primary);
            border-radius: 6px;
            border: 2px solid white;
            z-index: 10;
        }

        .other-car {
            position: absolute;
            bottom: 60px;
            width: 60px;
            height: 30px;
            background: #6b7280;
            border-radius: 6px;
            border: 2px solid #9ca3af;
        }

        .road-sign {
            position: absolute;
            width: 40px;
            height: 50px;
            background: #fbbf24;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1f2937;
            font-weight: bold;
            font-size: 0.8rem;
        }

        /* Alertness Dashboard */
        .alertness-dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 25px 0;
        }

        @media (max-width: 768px) {
            .alertness-dashboard { grid-template-columns: 1fr; }
        }

        .alertness-meter {
            background: rgba(95, 23, 235, 0.05);
            border-radius: var(--radius-md);
            padding: 20px;
            border: 2px solid rgba(95, 23, 235, 0.1);
        }

        .meter-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .meter-icon {
            font-size: 1.2rem;
        }

        .meter-visual {
            position: relative;
            height: 80px;
            background: linear-gradient(to right, #ef4444, #f59e0b, #10b981);
            border-radius: var(--radius-sm);
            overflow: hidden;
            margin: 15px 0;
        }

        .meter-needle {
            position: absolute;
            top: 0;
            left: 50%;
            width: 4px;
            height: 100%;
            background: var(--color-text);
            transform: translateX(-50%);
            transition: left 1s ease;
        }

        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: var(--color-muted);
            font-weight: 600;
        }

        .current-value {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--color-primary);
            margin-top: 10px;
        }

        /* Warning Panel */
        .warning-panel {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(249, 115, 22, 0.1) 100%);
            border-radius: var(--radius-md);
            padding: 20px;
            margin: 20px 0;
            border: 2px solid rgba(239, 68, 68, 0.2);
            display: none;
        }

        .warning-panel.show {
            display: block;
            animation: alertFlash 1s infinite;
        }

        .warning-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .warning-icon {
            font-size: 2rem;
            color: #dc2626;
            animation: blinkWarning 1s infinite;
        }

        .warning-title {
            font-size: 1.1rem;
            font-weight: 800;
            color: #dc2626;
        }

        .warning-content {
            font-size: 0.9rem;
            color: var(--color-text);
            line-height: 1.6;
        }

        /* Countermeasure Cards */
        .countermeasure-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 900px) {
            .countermeasure-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 600px) {
            .countermeasure-grid { grid-template-columns: 1fr; }
        }

        .countermeasure-card {
            background: white;
            border-radius: var(--radius-sm);
            padding: 20px;
            border: 2px solid rgba(95, 23, 235, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            text-align: center;
        }

        .countermeasure-card:hover {
            transform: translateY(-5px);
            border-color: var(--color-primary);
            box-shadow: 0 8px 20px rgba(95, 23, 235, 0.1);
        }

        .countermeasure-card.selected {
            border-color: var(--color-success);
            background: rgba(16, 185, 129, 0.05);
        }

        .countermeasure-card.incorrect {
            border-color: var(--color-error);
            background: rgba(239, 68, 68, 0.05);
        }

        .countermeasure-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .countermeasure-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 8px;
        }

        .countermeasure-description {
            font-size: 0.8rem;
            color: var(--color-muted);
            line-height: 1.5;
        }

        /* Quiz Container */
        .quiz-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
        }

        .quiz-question {
            font-size: 1rem;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(95, 23, 235, 0.1);
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            padding: 14px 16px;
            border-radius: var(--radius-sm);
            border: 2px solid rgba(95, 23, 235, 0.2);
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .quiz-option:hover {
            border-color: var(--color-primary);
            background: rgba(95, 23, 235, 0.05);
            transform: translateX(5px);
        }

        .quiz-option.selected {
            border-color: var(--color-primary);
            background: rgba(95, 23, 235, 0.1);
            font-weight: 600;
        }

        .quiz-option.correct {
            border-color: var(--color-success);
            background: rgba(16, 185, 129, 0.1);
        }

        .quiz-option.incorrect {
            border-color: var(--color-error);
            background: rgba(239, 68, 68, 0.1);
        }

        .option-label {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(95, 23, 235, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
            color: var(--color-primary);
            border: 1px solid rgba(95, 23, 235, 0.2);
        }

        .quiz-option.selected .option-label {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        .quiz-option.correct .option-label {
            background: var(--color-success);
            color: white;
            border-color: var(--color-success);
        }

        /* Trip Planning Tool */
        .trip-planner {
            background: linear-gradient(135deg, rgba(95, 23, 235, 0.05) 0%, rgba(124, 58, 237, 0.05) 100%);
            border-radius: var(--radius-md);
            padding: 25px;
            margin: 20px 0;
            border: 2px solid rgba(95, 23, 235, 0.1);
        }

        .planner-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .planner-fields {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        @media (max-width: 600px) {
            .planner-fields { grid-template-columns: 1fr; }
        }

        .field-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .field-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--color-text);
        }

        .field-input {
            padding: 10px 15px;
            border-radius: var(--radius-sm);
            border: 2px solid rgba(95, 23, 235, 0.2);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .field-input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(95, 23, 235, 0.1);
        }

        .planner-results {
            background: white;
            border-radius: var(--radius-sm);
            padding: 20px;
            margin-top: 20px;
            border: 2px solid rgba(95, 23, 235, 0.2);
            display: none;
        }

        .planner-results.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(95, 23, 235, 0.1);
        }

        .result-item:last-child {
            border-bottom: none;
            font-weight: 700;
            color: var(--color-primary);
            font-size: 1.1rem;
        }

        /* Feedback */
        .feedback-container {
            background: rgba(95, 23, 235, 0.03);
            border-radius: var(--radius-sm);
            padding: 20px;
            border: 1px solid rgba(95, 23, 235, 0.15);
            margin-top: 20px;
            display: none;
            border-left: 4px solid var(--color-primary);
        }

        .feedback-container.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .feedback-title {
            font-size: 0.95rem;
            font-weight: 800;
            color: var(--color-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .feedback-icon {
            font-size: 1.3rem;
            font-weight: bold;
        }

        .feedback-icon.correct { 
            color: var(--color-success); 
        }
        
        .feedback-icon.incorrect { 
            color: var(--color-error); 
        }

        .feedback-content {
            font-size: 0.9rem;
            color: var(--color-text);
            line-height: 1.7;
        }

        .feedback-content strong { 
            color: var(--color-primary); 
            font-weight: 700;
        }

        .safety-tips {
            background: rgba(16, 185, 129, 0.05);
            border-left: 3px solid var(--color-success);
            padding: 14px 18px;
            margin: 14px 0;
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 14px 28px;
            border-radius: var(--radius-md);
            border: none;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
            border: 2px solid var(--color-primary);
        }

        .btn-primary:hover {
            background: #4c0fcf;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(95, 23, 235, 0.4);
            animation: glow 1.5s infinite;
        }

        .btn-secondary {
            background: white;
            color: var(--color-primary);
            border: 2px solid var(--color-primary);
        }

        .btn-secondary:hover {
            background: rgba(95, 23, 235, 0.1);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(95, 23, 235, 0.2);
        }

        .btn-icon { 
            font-size: 1.2em; 
            font-weight: bold;
        }

        /* Results Panel */
        .results-panel {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            color: white;
            border-radius: var(--radius-md);
            padding: 40px;
            margin-top: 40px;
            display: none;
            animation: fadeInUp 0.6s ease;
            border: 2px solid var(--color-primary);
        }

        .results-panel.show { 
            display: block; 
            animation: glow 2s infinite;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .results-title {
            font-size: 1.6rem;
            font-weight: 800;
            color: white;
        }

        .score-display {
            font-size: 3.5rem;
            font-weight: 900;
            color: var(--color-primary);
            text-align: center;
            margin: 30px 0;
            text-shadow: 0 0 20px rgba(95, 23, 235, 0.7);
            animation: pulse 2s infinite;
        }

        .safety-insights {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
            padding: 25px;
            margin-top: 25px;
            border-left: 4px solid var(--color-primary);
        }

        .insights-title {
            font-size: 1.1rem;
            font-weight: 800;
            color: var(--color-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .insights-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .insights-list li {
            display: flex;
            gap: 12px;
            align-items: flex-start;
            font-size: 0.95rem;
            color: #e5e7eb;
            line-height: 1.6;
        }

        .insight-dot {
            width: 8px;
            height: 8px;
            margin-top: 10px;
            border-radius: 999px;
            background: var(--color-primary);
            flex-shrink: 0;
            animation: pulse 2s infinite;
        }

        /* Blur Effect for Hypnosis */
        .hypnosis-blur {
            filter: blur(2px);
            opacity: 0.7;
            animation: drowsyPulse 3s infinite;
        }
    </style>
</head>
<body>
    <main class="page" aria-labelledby="module-heading">
        <!-- Header -->
        <header class="brand-row">
            <div class="brand">
                <img
                    src="https://lwfiles.mycourse.app/vadrivingclinic-public/9f5c6b8121721c8ef241f929fd983b3e.png"
                    alt="VA Driving Clinic logo"
                    class="brand-logo"
                />
                <div class="course-meta">
                    <span class="course-name">VA Driving Clinic ‚Ä¢ Module 5</span>
                    <div class="week-label">
                        <span class="week-label-dot"></span>
                        <span>Highway Hypnosis Prevention</span>
                    </div>
                </div>
            </div>
            <span class="badge-mode">Interactive Simulation</span>
        </header>

        <h1 id="module-heading">Highway Hypnosis Prevention</h1>
        <p class="module-subtitle">
            Highway hypnosis, or "white line fever," affects 60% of long-distance drivers. This simulation teaches you to recognize 
            and prevent this dangerous state of altered consciousness through interactive scenarios, alertness monitoring, and 
            proven countermeasures. Stay awake, stay alert, stay alive.
        </p>

        <!-- Time Estimate Banner -->
        <div class="time-estimate-banner">
            <div class="time-estimate-icon">
                ‚è±Ô∏è
            </div>
            <div class="time-estimate-content">
                <h3>Simulation Time Estimate</h3>
                <p>Complete this interactive simulation in approximately <span class="time-highlight">5 minutes</span>. Experience highway hypnosis in a safe virtual environment and learn effective prevention strategies.</p>
            </div>
        </div>

        <!-- Key Stats -->
        <div class="stats-display">
            <div class="stat-card">
                <span class="stat-number" id="affected-drivers">60%</span>
                <span class="stat-label">Drivers Affected</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="accident-risk">3x</span>
                <span class="stat-label">Accident Risk</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="reaction-delay">+50%</span>
                <span class="stat-label">Reaction Time</span>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-step active" data-step="1">
                <div class="step-circle">1</div>
                <div class="step-label">Recognition</div>
            </div>
            <div class="progress-step" data-step="2">
                <div class="step-circle">2</div>
                <div class="step-label">Prevention</div>
            </div>
            <div class="progress-step" data-step="3">
                <div class="step-circle">3</div>
                <div class="step-label">Planning</div>
            </div>
        </div>

        <!-- Activity Grid -->
        <div class="activity-grid">
            <!-- Activity 1: Recognition Simulation -->
            <section class="activity-card" id="activity-1" data-activity="1">
                <div class="activity-header">
                    <span class="activity-number">Scenario 1</span>
                    <span class="activity-status">Not Started</span>
                </div>
                <h3 class="activity-title">Recognize Highway Hypnosis</h3>
                <p class="activity-description">
                    Experience a simulated highway drive and learn to recognize the early warning signs of highway hypnosis. 
                    Monitor your virtual alertness levels and respond to road events as drowsiness sets in.
                </p>

                <div class="activity-time-estimate">
                    <span class="activity-time-icon">‚è±Ô∏è</span>
                    <span class="activity-time-text">Estimated time: <strong>1-2 minutes</strong></span>
                </div>

                <!-- Highway Simulator -->
                <div class="highway-simulator" id="highway-simulator">
                    <div class="road-surface">
                        <div class="lane-markers"></div>
                    </div>
                    <div class="driver-car" id="driver-car"></div>
                    <div class="other-car" id="other-car-1" style="left: 400px; background: #3b82f6;"></div>
                    <div class="other-car" id="other-car-2" style="left: 600px; background: #ef4444;"></div>
                    <div class="road-sign" id="exit-sign" style="right: 150px; top: 80px;">EXIT 2 MILES</div>
                    <div class="road-sign" id="speed-sign" style="right: 300px; top: 140px;">SPEED LIMIT 65</div>
                </div>

                <!-- Alertness Dashboard -->
                <div class="alertness-dashboard">
                    <div class="alertness-meter">
                        <div class="meter-title">
                            <span class="meter-icon">üß†</span>
                            Mental Alertness
                        </div>
                        <div class="meter-visual">
                            <div class="meter-needle" id="alertness-needle" style="left: 70%;"></div>
                        </div>
                        <div class="meter-labels">
                            <span>Drowsy</span>
                            <span>Moderate</span>
                            <span>Alert</span>
                        </div>
                        <div class="current-value" id="alertness-value">72%</div>
                    </div>
                    <div class="alertness-meter">
                        <div class="meter-title">
                            <span class="meter-icon">‚ö°</span>
                            Reaction Time
                        </div>
                        <div class="meter-visual">
                            <div class="meter-needle" id="reaction-needle" style="left: 60%;"></div>
                        </div>
                        <div class="meter-labels">
                            <span>Slow</span>
                            <span>Average</span>
                            <span>Fast</span>
                        </div>
                        <div class="current-value" id="reaction-value">0.85s</div>
                    </div>
                </div>

                <!-- Warning Panel -->
                <div class="warning-panel" id="warning-panel">
                    <div class="warning-header">
                        <div class="warning-icon">‚ö†Ô∏è</div>
                        <div class="warning-title">Highway Hypnosis Detected</div>
                    </div>
                    <div class="warning-content">
                        <strong>Symptoms Present:</strong> Wandering thoughts, heavy eyelids, difficulty focusing on road signs. 
                        Your reaction time has increased by 40%. Take immediate action to restore alertness.
                    </div>
                </div>

                <!-- Interactive Events -->
                <div class="quiz-container" style="margin-top: 20px;">
                    <div class="quiz-question">As you drive, you notice these symptoms. Which are early signs of highway hypnosis?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-question="1" data-option="A">
                            <span class="option-label">A</span>
                            <span>Can't remember last 10 miles driven</span>
                        </div>
                        <div class="quiz-option" data-question="1" data-option="B">
                            <span class="option-label">B</span>
                            <span>Daydreaming about weekend plans</span>
                        </div>
                        <div class="quiz-option" data-question="1" data-option="C">
                            <span class="option-label">C</span>
                            <span>Feeling unusually sleepy or heavy-eyed</span>
                        </div>
                        <div class="quiz-option" data-question="1" data-option="D">
                            <span class="option-label">D</span>
                            <span>All of the above</span>
                        </div>
                    </div>
                </div>

                <!-- Feedback -->
                <div class="feedback-container" id="feedback-1">
                    <div class="feedback-title">
                        <span class="feedback-icon correct">‚úì</span>
                        Recognition Complete
                    </div>
                    <div class="feedback-content">
                        <strong>‚úÖ Correct Answer: D - All of the above</strong><br><br>
                        
                        <strong>üéØ Early Warning Signs of Highway Hypnosis:</strong><br>
                        1. <strong>Memory gaps:</strong> Can't recall last 5-10 miles<br>
                        2. <strong>Wandering thoughts:</strong> Daydreaming or mind wandering<br>
                        3. <strong>Physical symptoms:</strong> Heavy eyelids, yawning, blurred vision<br>
                        4. <strong>Automatic driving:</strong> Steering without conscious thought<br>
                        5. <strong>Missed details:</strong> Overlooking road signs or exit ramps<br><br>
                        
                        <div class="safety-tips">
                            <strong>üö® Critical Alert:</strong><br>
                            ‚Ä¢ Highway hypnosis increases accident risk by 300%<br>
                            ‚Ä¢ Reaction time slows by 50% in hypnosis state<br>
                            ‚Ä¢ The average driver experiences hypnosis symptoms every 100 miles<br>
                            ‚Ä¢ Most dangerous during 2-4 PM and 2-4 AM (natural circadian dips)
                        </div>
                        
                        <strong>üìä Research Findings:</strong><br>
                        ‚Ä¢ 60% of drivers report experiencing highway hypnosis<br>
                        ‚Ä¢ 25% have momentarily fallen asleep at the wheel<br>
                        ‚Ä¢ Hypnosis-related crashes peak on interstates during afternoon hours
                    </div>
                </div>
            </section>

            <!-- Activity 2: Prevention Strategies -->
            <section class="activity-card" id="activity-2" data-activity="2">
                <div class="activity-header">
                    <span class="activity-number">Scenario 2</span>
                    <span class="activity-status">Not Started</span>
                </div>
                <h3 class="activity-title">Effective Prevention Strategies</h3>
                <p class="activity-description">
                    Learn and practice proven countermeasures against highway hypnosis. Select the most effective strategies 
                    to maintain alertness during long drives and understand why they work.
                </p>

                <div class="activity-time-estimate">
                    <span class="activity-time-icon">‚è±Ô∏è</span>
                    <span class="activity-time-text">Estimated time: <strong>1-2 minutes</strong></span>
                </div>

                <!-- Countermeasure Selection -->
                <div class="countermeasure-grid" id="countermeasure-grid">
                    <div class="countermeasure-card" data-measure="breaks">
                        <div class="countermeasure-icon">üõë</div>
                        <div class="countermeasure-title">Take Regular Breaks</div>
                        <div class="countermeasure-description">Stop every 100 miles or 2 hours</div>
                    </div>
                    <div class="countermeasure-card" data-measure="conversation">
                        <div class="countermeasure-icon">üí¨</div>
                        <div class="countermeasure-title">Engage in Conversation</div>
                        <div class="countermeasure-description">Talk with passengers actively</div>
                    </div>
                    <div class="countermeasure-card" data-measure="caffeine">
                        <div class="countermeasure-icon">‚òï</div>
                        <div class="countermeasure-title">Drink Caffeine</div>
                        <div class="countermeasure-description">Coffee or energy drinks</div>
                    </div>
                    <div class="countermeasure-card" data-measure="music">
                        <div class="countermeasure-icon">üéµ</div>
                        <div class="countermeasure-title">Listen to Upbeat Music</div>
                        <div class="countermeasure-description">Fast tempo, familiar songs</div>
                    </div>
                    <div class="countermeasure-card" data-measure="temperature">
                        <div class="countermeasure-icon">‚ùÑÔ∏è</div>
                        <div class="countermeasure-title">Keep Cabin Cool</div>
                        <div class="countermeasure-description">65-68¬∞F optimal temperature</div>
                    </div>
                    <div class="countermeasure-card" data-measure="posture">
                        <div class="countermeasure-icon">üí∫</div>
                        <div class="countermeasure-title">Adjust Sitting Position</div>
                        <div class="countermeasure-description">Change posture frequently</div>
                    </div>
                    <div class="countermeasure-card" data-measure="chewing">
                        <div class="countermeasure-icon">üç¨</div>
                        <div class="countermeasure-title">Chew Gum or Snack</div>
                        <div class="countermeasure-description">Sugar-free gum works best</div>
                    </div>
                    <div class="countermeasure-card" data-measure="podcast">
                        <div class="countermeasure-icon">üéôÔ∏è</div>
                        <div class="countermeasure-title">Listen to Podcasts</div>
                        <div class="countermeasure-description">Engaging, story-based content</div>
                    </div>
                    <div class="countermeasure-card" data-measure="hydration">
                        <div class="countermeasure-icon">üíß</div>
                        <div class="countermeasure-title">Stay Hydrated</div>
                        <div class="countermeasure-description">Water, not sugary drinks</div>
                    </div>
                </div>

                <!-- Effectiveness Quiz -->
                <div class="quiz-container" style="margin-top: 25px;">
                    <div class="quiz-question">1. Why do regular breaks every 2 hours work so effectively?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-question="1" data-option="A">
                            <span class="option-label">A</span>
                            <span>They give you time to sleep</span>
                        </div>
                        <div class="quiz-option" data-question="1" data-option="B">
                            <span class="option-label">B</span>
                            <span>They reset your mental focus and provide physical movement</span>
                        </div>
                        <div class="quiz-option" data-question="1" data-option="C">
                            <span class="option-label">C</span>
                            <span>They allow you to check social media</span>
                        </div>
                        <div class="quiz-option" data-question="1" data-option="D">
                            <span class="option-label">D</span>
                            <span>They're required by law</span>
                        </div>
                    </div>

                    <div class="quiz-question">2. Which of these is LEAST effective for preventing highway hypnosis?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-question="2" data-option="A">
                            <span class="option-label">A</span>
                            <span>Opening windows for fresh air (short-term only)</span>
                        </div>
                        <div class="quiz-option" data-question="2" data-option="B">
                            <span class="option-label">B</span>
                            <span>Turning up radio volume very loud</span>
                        </div>
                        <div class="quiz-option" data-question="2" data-option="C">
                            <span class="option-label">C</span>
                            <span>Slapping yourself to stay awake</span>
                        </div>
                        <div class="quiz-option" data-question="2" data-option="D">
                            <span class="option-label">D</span>
                            <span>All of the above are ineffective</span>
                        </div>
                    </div>
                </div>

                <!-- Effectiveness Comparison -->
                <div class="alertness-dashboard" style="margin-top: 25px;">
                    <div class="alertness-meter">
                        <div class="meter-title">
                            <span class="meter-icon">üìà</span>
                            Most Effective Strategies
                        </div>
                        <div style="margin-top: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-size: 0.85rem;">Regular Breaks</span>
                                <span style="font-weight: 700; color: var(--color-success);">95%</span>
                            </div>
                            <div style="height: 10px; background: #e5e7eb; border-radius: 5px; overflow: hidden;">
                                <div style="width: 95%; height: 100%; background: var(--color-success);"></div>
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-size: 0.85rem;">Conversation</span>
                                <span style="font-weight: 700; color: var(--color-success);">85%</span>
                            </div>
                            <div style="height: 10px; background: #e5e7eb; border-radius: 5px; overflow: hidden;">
                                <div style="width: 85%; height: 100%; background: var(--color-success);"></div>
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-size: 0.85rem;">Cool Temperature</span>
                                <span style="font-weight: 700; color: #f59e0b;">70%</span>
                            </div>
                            <div style="height: 10px; background: #e5e7eb; border-radius: 5px; overflow: hidden;">
                                <div style="width: 70%; height: 100%; background: #f59e0b;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="alertness-meter">
                        <div class="meter-title">
                            <span class="meter-icon">üìâ</span>
                            Least Effective Strategies
                        </div>
                        <div style="margin-top: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-size: 0.85rem;">Loud Radio</span>
                                <span style="font-weight: 700; color: #ef4444;">15%</span>
                            </div>
                            <div style="height: 10px; background: #e5e7eb; border-radius: 5px; overflow: hidden;">
                                <div style="width: 15%; height: 100%; background: #ef4444;"></div>
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-size: 0.85rem;">Open Windows</span>
                                <span style="font-weight: 700; color: #ef4444;">25%</span>
                            </div>
                            <div style="height: 10px; background: #e5e7eb; border-radius: 5px; overflow: hidden;">
                                <div style="width: 25%; height: 100%; background: #ef4444;"></div>
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-size: 0.85rem;">Self Slapping</span>
                                <span style="font-weight: 700; color: #ef4444;">5%</span>
                            </div>
                            <div style="height: 10px; background: #e5e7eb; border-radius: 5px; overflow: hidden;">
                                <div style="width: 5%; height: 100%; background: #ef4444;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Feedback -->
                <div class="feedback-container" id="feedback-2">
                    <div class="feedback-title">
                        <span class="feedback-icon correct">‚úì</span>
                        Prevention Strategies Mastered
                    </div>
                    <div class="feedback-content">
                        <strong>‚úÖ Correct Answers:</strong><br>
                        1. <strong>B - They reset your mental focus and provide physical movement</strong><br>
                        2. <strong>D - All of the above are ineffective</strong><br><br>
                        
                        <strong>üéØ Proven Countermeasures (Scientific Basis):</strong><br>
                        1. <strong>Regular Breaks (Every 2 hours):</strong> Resets circadian rhythm, increases blood flow<br>
                        2. <strong>Active Conversation:</strong> Engages prefrontal cortex, prevents mental wandering<br>
                        3. <strong>Cool Cabin Temperature (65-68¬∞F):</strong> Prevents thermal comfort that induces sleep<br>
                        4. <strong>Chewing Gum:</strong> Increases cerebral blood flow by 25-40%<br>
                        5. <strong>Engaging Audio:</strong> Story-based content maintains cognitive engagement<br><br>
                        
                        <div class="safety-tips">
                            <strong>üí° Advanced Techniques:</strong><br>
                            ‚Ä¢ <strong>20-20-20 Rule:</strong> Every 20 minutes, look at something 20 feet away for 20 seconds<br>
                            ‚Ä¢ <strong>Mental Games:</strong> Count vehicles by color, practice multiplication tables<br>
                            ‚Ä¢ <strong>Physical Movement:</strong> Shoulder rolls, neck stretches, foot exercises<br>
                            ‚Ä¢ <strong>Hydration Strategy:</strong> Small sips regularly, not large gulps infrequently
                        </div>
                        
                        <strong>‚ö†Ô∏è Common Myths Debunked:</strong><br>
                        ‚Ä¢ <strong>Loud music:</strong> Only works for 10-15 minutes, then brain adapts<br>
                        ‚Ä¢ <strong>Open windows:</strong> Temporary at best, noisy and distracting<br>
                        ‚Ä¢ <strong>Caffeine dependency:</strong> Can lead to crashes when it wears off<br>
                        ‚Ä¢ <strong>"Power naps" while driving:</strong> NEVER safe - always pull over
                    </div>
                </div>
            </section>

            <!-- Activity 3: Trip Planning -->
            <section class="activity-card" id="activity-3" data-activity="3">
                <div class="activity-header">
                    <span class="activity-number">Scenario 3</span>
                    <span class="activity-status">Not Started</span>
                </div>
                <h3 class="activity-title">Safe Trip Planning Tool</h3>
                <p class="activity-description">
                    Plan a safe long-distance trip with built-in hypnosis prevention. Calculate optimal break schedules, 
                    identify high-risk periods, and create a personalized alertness maintenance plan.
                </p>

                <div class="activity-time-estimate">
                    <span class="activity-time-icon">‚è±Ô∏è</span>
                    <span class="activity-time-text">Estimated time: <strong>1-2 minutes</strong></span>
                </div>

                <!-- Trip Planner -->
                <div class="trip-planner">
                    <div class="planner-title">
                        <span class="planner-icon">üó∫Ô∏è</span>
                        Long-Distance Trip Planner
                    </div>
                    
                    <div class="planner-fields">
                        <div class="field-group">
                            <label class="field-label">Trip Distance (miles)</label>
                            <input type="number" id="trip-distance" class="field-input" value="300" min="50" max="1000" step="10">
                        </div>
                        <div class="field-group">
                            <label class="field-label">Average Speed (mph)</label>
                            <input type="number" id="average-speed" class="field-input" value="65" min="30" max="80" step="5">
                        </div>
                        <div class="field-group">
                            <label class="field-label">Start Time</label>
                            <select id="start-time" class="field-input">
                                <option value="morning">Morning (6 AM - 10 AM)</option>
                                <option value="midday" selected>Midday (10 AM - 2 PM)</option>
                                <option value="afternoon">Afternoon (2 PM - 6 PM)</option>
                                <option value="evening">Evening (6 PM - 10 PM)</option>
                                <option value="night">Night (10 PM - 6 AM)</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label class="field-label">Traveling With</label>
                            <select id="travel-companions" class="field-input">
                                <option value="alone">Alone</option>
                                <option value="one">One passenger</option>
                                <option value="multiple" selected>Multiple passengers</option>
                                <option value="family">Family (children)</option>
                            </select>
                        </div>
                    </div>

                    <button class="btn btn-primary" id="calculate-plan" style="width: 100%; margin-top: 15px;">
                        <span class="btn-icon">üßÆ</span>
                        Generate Safety Plan
                    </button>

                    <div class="planner-results" id="planner-results">
                        <div class="result-item">
                            <span>Trip Duration:</span>
                            <span id="trip-duration">4h 36m</span>
                        </div>
                        <div class="result-item">
                            <span>Recommended Breaks:</span>
                            <span id="recommended-breaks">2 stops</span>
                        </div>
                        <div class="result-item">
                            <span>Break Schedule:</span>
                            <span id="break-schedule">Every 2 hours</span>
                        </div>
                        <div class="result-item">
                            <span>High-Risk Period:</span>
                            <span id="high-risk-period">2-4 PM</span>
                        </div>
                        <div class="result-item">
                            <span>Alertness Strategy:</span>
                            <span id="alertness-strategy">Conversation + Breaks</span>
                        </div>
                    </div>
                </div>

                <!-- Risk Assessment -->
                <div class="alertness-dashboard" style="margin-top: 25px;">
                    <div class="alertness-meter">
                        <div class="meter-title">
                            <span class="meter-icon">‚ö†Ô∏è</span>
                            Hypnosis Risk Factors
                        </div>
                        <div style="margin-top: 15px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                                <div style="width: 20px; height: 20px; border-radius: 50%; background: #ef4444;"></div>
                                <span style="font-size: 0.85rem;">Driving Alone (High Risk)</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                                <div style="width: 20px; height: 20px; border-radius: 50%; background: #f59e0b;"></div>
                                <span style="font-size: 0.85rem;">Monotonous Route (Medium Risk)</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                                <div style="width: 20px; height: 20px; border-radius: 50%; background: #10b981;"></div>
                                <span style="font-size: 0.85rem;">Daytime Travel (Lower Risk)</span>
                            </div>
                        </div>
                    </div>
                    <div class="alertness-meter">
                        <div class="meter-title">
                            <span class="meter-icon">üõ°Ô∏è</span>
                            Risk Reduction Plan
                        </div>
                        <div style="margin-top: 15px;">
                            <div style="background: rgba(16, 185, 129, 0.1); padding: 10px; border-radius: var(--radius-sm); margin-bottom: 10px;">
                                <div style="font-size: 0.85rem; font-weight: 700; color: var(--color-success);">Schedule Breaks</div>
                                <div style="font-size: 0.75rem;">Plan stops in advance</div>
                            </div>
                            <div style="background: rgba(16, 185, 129, 0.1); padding: 10px; border-radius: var(--radius-sm); margin-bottom: 10px;">
                                <div style="font-size: 0.85rem; font-weight: 700; color: var(--color-success);">Engage Passengers</div>
                                <div style="font-size: 0.75rem;">Assign conversation topics</div>
                            </div>
                            <div style="background: rgba(16, 185, 129, 0.1); padding: 10px; border-radius: var(--radius-sm);">
                                <div style="font-size: 0.85rem; font-weight: 700; color: var(--color-success);">Audio Planning</div>
                                <div style="font-size: 0.75rem;">Prepare podcasts/playlists</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Emergency Protocol -->
                <div class="warning-panel" style="margin-top: 25px;">
                    <div class="warning-header">
                        <div class="warning-icon">üö®</div>
                        <div class="warning-title">Emergency Protocol - Immediate Action Required</div>
                    </div>
                    <div class="warning-content">
                        <strong>If you experience these symptoms while driving:</strong><br>
                        1. <strong>Immediately:</strong> Signal and move to right lane<br>
                        2. <strong>Exit at next opportunity:</strong> Rest area, gas station, or safe parking<br>
                        3. <strong>Take a 20-minute nap:</strong> Set alarm, lock doors<br>
                        4. <strong>Walk for 5 minutes:</strong> Get blood flowing<br>
                        5. <strong>Hydrate and snack:</strong> Water and protein-rich food<br>
                        6. <strong>Consider staying overnight:</strong> If severely fatigued<br><br>
                        <strong>NEVER:</strong> Continue driving, rely on caffeine alone, open windows as solution
                    </div>
                </div>

                <!-- Feedback -->
                <div class="feedback-container" id="feedback-3">
                    <div class="feedback-title">
                        <span class="feedback-icon correct">‚úì</span>
                        Trip Safety Plan Complete
                    </div>
                    <div class="feedback-content">
                        <strong>‚úÖ Your Personalized Highway Safety Plan:</strong><br><br>
                        
                        <strong>üìÖ Pre-Trip Preparation:</strong><br>
                        1. <strong>Sleep:</strong> 7-8 hours for 2 nights before trip<br>
                        2. <strong>Route Planning:</strong> Identify rest areas every 50 miles<br>
                        3. <strong>Audio Preparation:</strong> Download 10+ hours of engaging content<br>
                        4. <strong>Snack Pack:</strong> Protein bars, nuts, fruits, water<br>
                        5. <strong>Companion Briefing:</strong> Explain alertness monitoring role<br><br>
                        
                        <strong>üöó During Trip Execution:</strong><br>
                        1. <strong>Break Schedule:</strong> Strict 2-hour intervals<br>
                        2. <strong>Active Monitoring:</strong> Self-check for symptoms hourly<br>
                        3. <strong>Engagement Rotation:</strong> Switch activities every 30 minutes<br>
                        4. <strong>Temperature Control:</strong> Maintain 65-68¬∞F cabin temperature<br>
                        5. <strong>Posture Changes:</strong> Adjust seat position each break<br><br>
                        
                        <div class="safety-tips">
                            <strong>üí° Pro Tips for Long Hauls:</strong><br>
                            ‚Ä¢ <strong>Share Driving:</strong> Rotate every 2-3 hours if possible<br>
                            ‚Ä¢ <strong>Schedule Wisely:</strong> Avoid natural circadian dips (2-4 PM, 2-4 AM)<br>
                            ‚Ä¢ <strong>Use Technology:</strong> Modern cars have drowsiness detection - enable it!<br>
                            ‚Ä¢ <strong>Know Your Limits:</strong> Most people max at 8-10 hours of safe driving per day
                        </div>
                        
                        <strong>üìä Safety Statistics:</strong><br>
                        ‚Ä¢ Proper planning reduces hypnosis risk by 75%<br>
                        ‚Ä¢ Scheduled breaks prevent 60% of fatigue-related accidents<br>
                        ‚Ä¢ Traveling with alert passengers cuts risk by 50%
                    </div>
                </div>
            </section>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-secondary" id="reset-all-btn">
                <span class="btn-icon">‚Üª</span>
                Reset Simulation
            </button>
            <button class="btn btn-secondary" id="print-safety-plan">
                <span class="btn-icon">üñ®Ô∏è</span>
                Print Safety Plan
            </button>
            <button class="btn btn-primary" id="view-results-btn">
                <span class="btn-icon">üìä</span>
                View Mastery Results
            </button>
        </div>

        <!-- Results Panel -->
        <div class="results-panel" id="results-panel">
            <div class="results-header">
                <h2 class="results-title">Hypnosis Prevention Mastery</h2>
                <div class="score-display" id="final-score">0%</div>
            </div>
            
            <div class="safety-insights">
                <h3 class="insights-title">
                    <span>üß†</span> The Science of Highway Hypnosis
                </h3>
                <ul class="insights-list">
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Neuroscience Basis:</strong> Highway hypnosis occurs when the brain's default mode network activates during monotonous tasks. This is the same network active during daydreaming, causing reduced awareness of external stimuli while maintaining automatic motor functions like steering and braking.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Circadian Rhythms:</strong> Your body has natural alertness dips at 2-4 PM and 2-4 AM. These periods coincide with peak highway hypnosis incidents. Understanding your personal circadian rhythm is crucial for planning long trips during optimal alertness windows.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Sensory Adaptation:</strong> The brain filters out repetitive stimuli (like dashed lane lines) after 15-20 minutes. This adaptation is evolutionarily beneficial but dangerous for driving. Effective countermeasures introduce novel stimuli to prevent this adaptation.</span>
                    </li>
                </ul>
            </div>
            
            <div class="safety-insights" style="margin-top: 20px;">
                <h3 class="insights-title">
                    <span>üöó</span> Advanced Prevention Technologies
                </h3>
                <ul class="insights-list">
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Modern Vehicle Systems:</strong> Many new vehicles include drowsiness detection that monitors steering patterns, lane positioning, and driving time. These systems provide visual, audible, and haptic warnings when hypnosis symptoms are detected.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Mobile Apps:</strong> Applications like "Driving Fatigue Monitor" use phone sensors to detect head nodding, lane drifting, and driving time. Some even connect to smartwatches to monitor heart rate variability - an indicator of fatigue.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Route Planning Technology:</strong> Advanced GPS systems can now plan routes with built-in rest stops, calculate optimal break times based on traffic patterns, and even suggest engaging points of interest to maintain mental stimulation.</span>
                    </li>
                </ul>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // State Management
            const state = {
                activities: {
                    1: { completed: false, correct: 0, total: 1, score: 0, alertness: 72, reaction: 0.85 },
                    2: { completed: false, correct: 0, total: 2, score: 0, measures: [] },
                    3: { completed: false, correct: 0, total: 1, score: 0 }
                },
                startedAt: new Date(),
                timeSpent: 0
            };

            // Correct answers
            const correctAnswers = {
                1: 'D',
                2: { 1: 'B', 2: 'D' },
                effectiveMeasures: ['breaks', 'conversation', 'temperature', 'chewing', 'podcast', 'hydration']
            };

            // DOM Elements
            const progressSteps = document.querySelectorAll('.progress-step');
            const activityCards = document.querySelectorAll('.activity-card');
            const resetBtn = document.getElementById('reset-all-btn');
            const printBtn = document.getElementById('print-safety-plan');
            const resultsBtn = document.getElementById('view-results-btn');
            const resultsPanel = document.getElementById('results-panel');
            const finalScore = document.getElementById('final-score');

            // Timer
            function updateTimer() {
                const now = new Date();
                const diff = Math.floor((now - state.startedAt) / 1000);
                state.timeSpent = diff;
            }

            setInterval(updateTimer, 1000);

            // Update Progress
            function updateProgress() {
                let completed = 0;
                
                Object.values(state.activities).forEach(activity => {
                    if (activity.completed) completed++;
                });

                progressSteps.forEach((step, index) => {
                    if (index < completed) {
                        step.classList.add('completed');
                        step.classList.remove('active');
                    } else if (index === completed) {
                        step.classList.add('active');
                        step.classList.remove('completed');
                    } else {
                        step.classList.remove('active', 'completed');
                    }
                });
            }

            // Activity 1: Recognition Simulation
            function initActivity1() {
                const quizOptions = document.querySelectorAll('#activity-1 .quiz-option');
                const feedback = document.getElementById('feedback-1');
                const status = document.querySelector('#activity-1 .activity-status');
                const warningPanel = document.getElementById('warning-panel');
                const alertnessNeedle = document.getElementById('alertness-needle');
                const reactionNeedle = document.getElementById('reaction-needle');
                const alertnessValue = document.getElementById('alertness-value');
                const reactionValue = document.getElementById('reaction-value');
                const highwaySimulator = document.getElementById('highway-simulator');
                
                let timeDriven = 0;
                let simulationInterval;
                let alertness = 72;
                let reaction = 0.85;

                // Start simulation
                function startSimulation() {
                    simulationInterval = setInterval(() => {
                        timeDriven++;
                        
                        // Gradually decrease alertness
                        if (timeDriven % 10 === 0) {
                            alertness -= Math.random() * 3;
                            reaction += 0.05;
                            
                            // Ensure values stay in range
                            alertness = Math.max(30, Math.min(100, alertness));
                            reaction = Math.max(0.6, Math.min(2.0, reaction));
                            
                            // Update displays
                            updateDisplays();
                            
                            // Show warning if alertness low
                            if (alertness < 50 && !warningPanel.classList.contains('show')) {
                                warningPanel.classList.add('show');
                                highwaySimulator.classList.add('hypnosis-blur');
                            }
                            
                            // Store in state
                            state.activities[1].alertness = alertness;
                            state.activities[1].reaction = reaction;
                        }
                    }, 500);
                }

                // Update displays
                function updateDisplays() {
                    // Update needle positions (0-100% scale)
                    const alertnessPercentage = alertness;
                    const reactionPercentage = 100 - ((reaction - 0.6) / 1.4 * 100);
                    
                    alertnessNeedle.style.left = `${alertnessPercentage}%`;
                    reactionNeedle.style.left = `${reactionPercentage}%`;
                    
                    // Update values
                    alertnessValue.textContent = `${Math.round(alertness)}%`;
                    reactionValue.textContent = `${reaction.toFixed(2)}s`;
                }

                // Quiz option clicks
                quizOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        const question = this.dataset.question;
                        const answer = this.dataset.option;
                        
                        // Stop simulation
                        clearInterval(simulationInterval);
                        
                        // Remove selection from all options
                        quizOptions.forEach(opt => {
                            opt.classList.remove('selected', 'correct', 'incorrect');
                        });
                        
                        // Mark selected
                        this.classList.add('selected');
                        
                        // Check answer
                        const isCorrect = answer === correctAnswers[1];
                        
                        if (isCorrect) {
                            this.classList.add('correct');
                            state.activities[1].correct = 1;
                            
                            // Restore alertness
                            alertness = 85;
                            reaction = 0.75;
                            updateDisplays();
                            warningPanel.classList.remove('show');
                            highwaySimulator.classList.remove('hypnosis-blur');
                        } else {
                            this.classList.add('incorrect');
                            state.activities[1].correct = 0;
                            
                            // Highlight correct answer
                            document.querySelector(`[data-option="${correctAnswers[1]}"]`).classList.add('correct');
                            
                            // Show severe warning
                            alertness = 35;
                            reaction = 1.5;
                            updateDisplays();
                        }
                        
                        state.activities[1].completed = true;
                        state.activities[1].score = isCorrect ? 100 : 0;
                        
                        status.textContent = 'Completed';
                        document.querySelector('#activity-1').classList.add('completed');
                        feedback.classList.add('show');
                        
                        updateProgress();
                    });
                });

                // Initialize and start simulation
                updateDisplays();
                setTimeout(startSimulation, 1000);
            }

            // Activity 2: Prevention Strategies
            function initActivity2() {
                const countermeasureCards = document.querySelectorAll('#countermeasure-grid .countermeasure-card');
                const quizOptions = document.querySelectorAll('#activity-2 .quiz-option');
                const feedback = document.getElementById('feedback-2');
                const status = document.querySelector('#activity-2 .activity-status');
                
                let selectedMeasures = [];
                let answeredQuestions = 0;

                // Countermeasure card clicks
                countermeasureCards.forEach(card => {
                    card.addEventListener('click', function() {
                        const measure = this.dataset.measure;
                        
                        // Toggle selection
                        if (this.classList.contains('selected')) {
                            this.classList.remove('selected');
                            selectedMeasures = selectedMeasures.filter(m => m !== measure);
                        } else {
                            this.classList.add('selected');
                            selectedMeasures.push(measure);
                        }
                        
                        state.activities[2].measures = selectedMeasures;
                        
                        // Check if completed
                        if (selectedMeasures.length >= 3 && answeredQuestions >= 2) {
                            checkActivity2();
                        }
                    });
                });

                // Quiz option clicks
                quizOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        const question = this.dataset.question;
                        const answer = this.dataset.option;
                        
                        // Remove selection from all options for this question
                        const allOptionsForQuestion = document.querySelectorAll(`[data-question="${question}"]`);
                        allOptionsForQuestion.forEach(opt => {
                            opt.classList.remove('selected', 'correct', 'incorrect');
                        });
                        
                        // Mark selected
                        this.classList.add('selected');
                        
                        // Check answer
                        const isCorrect = answer === correctAnswers[2][question];
                        
                        if (isCorrect) {
                            this.classList.add('correct');
                            state.activities[2].correct++;
                        } else {
                            this.classList.add('incorrect');
                            document.querySelector(`[data-question="${question}"][data-option="${correctAnswers[2][question]}"]`).classList.add('correct');
                        }
                        
                        answeredQuestions++;
                        
                        // Check if completed
                        if (selectedMeasures.length >= 3 && answeredQuestions >= 2) {
                            checkActivity2();
                        }
                    });
                });

                function checkActivity2() {
                    // Check countermeasure selections
                    const effectiveCount = selectedMeasures.filter(measure => 
                        correctAnswers.effectiveMeasures.includes(measure)).length;
                    
                    // Update card displays
                    countermeasureCards.forEach(card => {
                        const measure = card.dataset.measure;
                        if (correctAnswers.effectiveMeasures.includes(measure)) {
                            card.classList.add('correct');
                        } else if (selectedMeasures.includes(measure)) {
                            card.classList.add('incorrect');
                        }
                    });
                    
                    // Calculate score (measures worth 50%, quiz worth 50%)
                    const measureScore = (effectiveCount / 6) * 50;
                    const quizScore = (state.activities[2].correct / 2) * 50;
                    state.activities[2].score = Math.round(measureScore + quizScore);
                    
                    state.activities[2].completed = true;
                    
                    status.textContent = 'Completed';
                    document.querySelector('#activity-2').classList.add('completed');
                    feedback.classList.add('show');
                    
                    updateProgress();
                }
            }

            // Activity 3: Trip Planning
            function initActivity3() {
                const calculateBtn = document.getElementById('calculate-plan');
                const resultsDiv = document.getElementById('planner-results');
                const feedback = document.getElementById('feedback-3');
                const status = document.querySelector('#activity-3 .activity-status');
                
                // Input elements
                const tripDistanceInput = document.getElementById('trip-distance');
                const averageSpeedInput = document.getElementById('average-speed');
                const startTimeSelect = document.getElementById('start-time');
                const travelCompanionsSelect = document.getElementById('travel-companions');
                
                // Result elements
                const tripDurationEl = document.getElementById('trip-duration');
                const recommendedBreaksEl = document.getElementById('recommended-breaks');
                const breakScheduleEl = document.getElementById('break-schedule');
                const highRiskPeriodEl = document.getElementById('high-risk-period');
                const alertnessStrategyEl = document.getElementById('alertness-strategy');

                function calculatePlan() {
                    // Get input values
                    const distance = parseFloat(tripDistanceInput.value);
                    const speed = parseFloat(averageSpeedInput.value);
                    const startTime = startTimeSelect.value;
                    const companions = travelCompanionsSelect.value;
                    
                    // Calculate trip duration
                    const durationHours = distance / speed;
                    const hours = Math.floor(durationHours);
                    const minutes = Math.round((durationHours - hours) * 60);
                    
                    // Calculate breaks (every 2 hours or 100 miles)
                    const recommendedBreaks = Math.max(1, Math.floor(durationHours / 2));
                    
                    // Determine high-risk period
                    let highRiskPeriod;
                    if (startTime === 'morning') highRiskPeriod = '10 AM - 12 PM';
                    else if (startTime === 'midday') highRiskPeriod = '2 PM - 4 PM';
                    else if (startTime === 'afternoon') highRiskPeriod = '4 PM - 6 PM';
                    else if (startTime === 'evening') highRiskPeriod = '10 PM - 12 AM';
                    else highRiskPeriod = '2 AM - 4 AM';
                    
                    // Determine strategy
                    let strategy;
                    if (companions === 'alone') strategy = 'Audio + Breaks';
                    else if (companions === 'one') strategy = 'Conversation + Breaks';
                    else if (companions === 'multiple') strategy = 'Group Engagement';
                    else strategy = 'Family Activities';
                    
                    // Update results
                    tripDurationEl.textContent = `${hours}h ${minutes}m`;
                    recommendedBreaksEl.textContent = `${recommendedBreaks} stops`;
                    breakScheduleEl.textContent = `Every ${Math.round(durationHours / recommendedBreaks * 10)/10}h`;
                    highRiskPeriodEl.textContent = highRiskPeriod;
                    alertnessStrategyEl.textContent = strategy;
                    
                    // Show results
                    resultsDiv.classList.add('show');
                    
                    // Mark activity as completed
                    if (!state.activities[3].completed) {
                        state.activities[3].completed = true;
                        state.activities[3].correct = 1;
                        state.activities[3].score = 100;
                        
                        status.textContent = 'Completed';
                        document.querySelector('#activity-3').classList.add('completed');
                        feedback.classList.add('show');
                        
                        updateProgress();
                    }
                }

                // Event listener for calculate button
                calculateBtn.addEventListener('click', calculatePlan);
                
                // Also calculate when inputs change
                [tripDistanceInput, averageSpeedInput, startTimeSelect, travelCompanionsSelect].forEach(input => {
                    input.addEventListener('change', function() {
                        if (state.activities[3].completed) {
                            calculatePlan();
                        }
                    });
                });
                
                // Initial calculation
                calculatePlan();
            }

            // Reset Simulation
            function resetSimulation() {
                // Reset state
                state.activities = {
                    1: { completed: false, correct: 0, total: 1, score: 0, alertness: 72, reaction: 0.85 },
                    2: { completed: false, correct: 0, total: 2, score: 0, measures: [] },
                    3: { completed: false, correct: 0, total: 1, score: 0 }
                };
                
                // Reset UI
                activityCards.forEach(card => {
                    card.classList.remove('completed');
                    const status = card.querySelector('.activity-status');
                    status.textContent = 'Not Started';
                    status.style.color = '';
                    const feedback = card.querySelector('.feedback-container');
                    feedback.classList.remove('show');
                });
                
                // Reset Activity 1
                const quizOptions1 = document.querySelectorAll('#activity-1 .quiz-option');
                quizOptions1.forEach(opt => {
                    opt.classList.remove('selected', 'correct', 'incorrect');
                });
                
                const warningPanel = document.getElementById('warning-panel');
                const highwaySimulator = document.getElementById('highway-simulator');
                if (warningPanel) warningPanel.classList.remove('show');
                if (highwaySimulator) highwaySimulator.classList.remove('hypnosis-blur');
                
                // Reset Activity 2
                const countermeasureCards = document.querySelectorAll('#countermeasure-grid .countermeasure-card');
                countermeasureCards.forEach(card => {
                    card.classList.remove('selected', 'correct', 'incorrect');
                });
                
                const quizOptions2 = document.querySelectorAll('#activity-2 .quiz-option');
                quizOptions2.forEach(opt => {
                    opt.classList.remove('selected', 'correct', 'incorrect');
                });
                
                // Reset Activity 3
                document.getElementById('planner-results').classList.remove('show');
                
                // Reset results
                resultsPanel.classList.remove('show');
                
                // Reset timer
                state.startedAt = new Date();
                state.timeSpent = 0;
                
                // Re-initialize Activity 1 displays
                initActivity1();
                
                // Update progress
                updateProgress();
            }

            // Print Safety Plan
            function printSafetyPlan() {
                const plan = `
                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
                    ‚ïë     HIGHWAY HYPNOSIS SAFETY PLAN          ‚ïë
                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
                    
                    üó∫Ô∏è TRIP DETAILS:
                    Distance: ${document.getElementById('trip-distance').value} miles
                    Duration: ${document.getElementById('trip-duration').textContent}
                    Breaks: ${document.getElementById('recommended-breaks').textContent}
                    
                    ‚è∞ BREAK SCHEDULE:
                    ‚Ä¢ ${document.getElementById('break-schedule').textContent}
                    ‚Ä¢ 15-20 minutes per break minimum
                    ‚Ä¢ Include walking, stretching, hydration
                    
                    ‚ö†Ô∏è HIGH-RISK PERIOD:
                    ‚Ä¢ ${document.getElementById('high-risk-period').textContent}
                    ‚Ä¢ Extra vigilance required
                    ‚Ä¢ Consider strategic break during this time
                    
                    üõ°Ô∏è PREVENTION STRATEGY:
                    ‚Ä¢ ${document.getElementById('alertness-strategy').textContent}
                    ‚Ä¢ Temperature: 65-68¬∞F cabin temperature
                    ‚Ä¢ Audio: Prepared playlist/podcasts
                    ‚Ä¢ Snacks: Protein-rich, healthy options
                    
                    üö® EMERGENCY PROTOCOL:
                    1. IMMEDIATELY move to right lane
                    2. Exit at next safe opportunity
                    3. Take 20-minute nap if needed
                    4. Walk 5 minutes to restore alertness
                    5. Hydrate with water
                    6. Consider overnight stop if severely tired
                    
                    üì± TECHNOLOGY USE:
                    ‚Ä¢ Enable vehicle drowsiness detection
                    ‚Ä¢ Use navigation with rest stop alerts
                    ‚Ä¢ Consider fatigue monitoring apps
                    
                    REMEMBER: Your safety and others' safety comes first!
                    No deadline is worth risking lives.
                `;
                
                alert("Highway Hypnosis Safety Plan\n\nCopy this plan for your trip:\n\n" + plan);
            }

            // View Results
            function viewResults() {
                let totalScore = 0;
                let maxScore = 0;
                
                Object.values(state.activities).forEach(activity => {
                    if (activity.completed) {
                        totalScore += activity.score;
                        maxScore += 100;
                    }
                });
                
                const averageScore = maxScore > 0 ? Math.round(totalScore / (maxScore / 100)) : 0;
                finalScore.textContent = `${averageScore}%`;
                
                resultsPanel.classList.add('show');
                resultsPanel.scrollIntoView({ behavior: 'smooth' });
            }

            // Initialize all activities
            initActivity1();
            initActivity2();
            initActivity3();

            // Event listeners
            resetBtn.addEventListener('click', resetSimulation);
            printBtn.addEventListener('click', printSafetyPlan);
            resultsBtn.addEventListener('click', viewResults);

            // Initial update
            updateTimer();
            updateProgress();
        });
    </script>
</body>
</html>
