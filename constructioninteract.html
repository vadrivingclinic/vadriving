<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VA Driving Clinic - Module 2: Construction Zone Safety</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root {
            --color-primary: #5f17eb; /* Your exact brand purple */
            --color-primary-soft: #8a5feb;
            --color-secondary: #000000; /* Black */
            --color-accent: #7c3aed;
            --color-success: #10b981;
            --color-error: #ef4444;
            --color-warning: #f59e0b;
            --color-bg: #ffffff; /* White */
            --color-text: #000000; /* Black */
            --color-muted: #6b7280;
            --color-dark: #000000; /* Black */
            --color-light: #f9fafb;
            --radius-lg: 20px;
            --radius-md: 12px;
            --radius-sm: 8px;
            --shadow-soft: 0 10px 30px rgba(95, 23, 235, 0.1);
            --shadow-hover: 0 15px 35px rgba(95, 23, 235, 0.15);
            --shadow-card: 0 8px 25px rgba(0, 0, 0, 0.08);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            padding: 24px;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            color: var(--color-text);
            line-height: 1.6;
        }

        @media (max-width: 600px) {
            body { padding: 12px; }
        }

        /* Animations */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(95, 23, 235, 0.5); }
            50% { box-shadow: 0 0 20px rgba(95, 23, 235, 0.8); }
        }

        @keyframes warningPulse {
            0%, 100% { box-shadow: 0 0 10px rgba(245, 158, 11, 0.3); }
            50% { box-shadow: 0 0 20px rgba(245, 158, 11, 0.6); }
        }

        /* Main Container */
        .page {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--color-bg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            padding: 30px;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease-out;
            border: 1px solid rgba(95, 23, 235, 0.1);
        }

        @media (max-width: 900px) {
            .page { padding: 20px; }
        }

        @media (max-width: 480px) {
            body { padding: 0; }
            .page {
                border-radius: 0;
                box-shadow: none;
                padding: 16px 12px 20px;
            }
        }

        /* Header */
        .brand-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
            width: 100%;
            animation: fadeIn 0.6s ease-out 0.2s both;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .brand-logo {
            height: 50px;
            width: auto;
            max-width: 100%;
            transition: transform 0.3s ease;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .brand-logo:hover { 
            transform: scale(1.05); 
            animation: glow 2s infinite;
        }

        .course-meta {
            display: flex;
            flex-direction: column;
            gap: 4px;
            max-width: 100%;
        }

        .course-name {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--color-primary);
            font-weight: 700;
        }

        .week-label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 999px;
            background: rgba(95, 23, 235, 0.1);
            font-size: 0.8rem;
            color: var(--color-primary);
            font-weight: 600;
            border: 1px solid rgba(95, 23, 235, 0.2);
        }

        .week-label-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: var(--color-primary);
            flex-shrink: 0;
            animation: pulse 2s infinite;
        }

        .badge-mode {
            padding: 6px 12px;
            border-radius: 999px;
            background: rgba(95, 23, 235, 0.08);
            border: 1px solid rgba(95, 23, 235, 0.15);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--color-primary);
            white-space: nowrap;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .badge-mode:hover {
            background: rgba(95, 23, 235, 0.15);
            border-color: var(--color-primary);
            transform: translateY(-2px);
        }

        h1 {
            font-size: clamp(1.8rem, 3vw, 2.4rem);
            line-height: 1.1;
            color: var(--color-text);
            margin-bottom: 10px;
            animation: fadeInUp 0.6s ease-out 0.3s both;
        }

        .module-subtitle {
            font-size: 1rem;
            color: var(--color-muted);
            max-width: 800px;
            margin-bottom: 28px;
            animation: fadeInUp 0.6s ease-out 0.4s both;
            line-height: 1.7;
        }

        /* Time Estimate Banner */
        .time-estimate-banner {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(245, 158, 11, 0.05) 100%);
            border: 2px solid rgba(245, 158, 11, 0.2);
            border-radius: var(--radius-md);
            padding: 15px 20px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: fadeIn 0.5s ease;
        }

        .time-estimate-icon {
            font-size: 1.5rem;
            color: var(--color-warning);
            background: rgba(245, 158, 11, 0.1);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .time-estimate-content h3 {
            color: var(--color-warning);
            font-size: 1rem;
            margin-bottom: 5px;
            font-weight: 700;
        }

        .time-estimate-content p {
            color: var(--color-text);
            font-size: 0.9rem;
            margin: 0;
        }

        .time-highlight {
            color: var(--color-warning);
            font-weight: 800;
            font-size: 1.1em;
        }

        /* Stats Display */
        .stats-display {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 600px) {
            .stats-display { grid-template-columns: 1fr; }
        }

        .stat-card {
            background: rgba(245, 158, 11, 0.05);
            border-radius: var(--radius-md);
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(245, 158, 11, 0.1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--color-warning);
            box-shadow: 0 10px 25px rgba(245, 158, 11, 0.1);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--color-warning);
            display: block;
            line-height: 1;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--color-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: 600;
        }

        /* Progress Tracker */
        .progress-tracker {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
            padding: 0 20px;
        }

        .progress-tracker::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 50px;
            right: 50px;
            height: 3px;
            background: rgba(245, 158, 11, 0.1);
            z-index: 1;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            flex: 1;
        }

        .step-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: white;
            border: 2px solid rgba(245, 158, 11, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--color-warning);
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .progress-step.active .step-circle {
            background: var(--color-warning);
            border-color: var(--color-warning);
            color: white;
            transform: scale(1.1);
            animation: pulse 2s infinite;
        }

        .progress-step.completed .step-circle {
            background: var(--color-success);
            border-color: var(--color-success);
            color: white;
        }

        .step-label {
            font-size: 0.75rem;
            color: var(--color-muted);
            text-align: center;
            font-weight: 600;
        }

        .progress-step.active .step-label {
            color: var(--color-warning);
            font-weight: 700;
        }

        /* Construction Simulation Container */
        .construction-simulation {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 900px) {
            .construction-simulation {
                grid-template-columns: 1fr;
            }
        }

        /* Road Simulation */
        .road-simulation-container {
            background: #1a1a1a;
            border-radius: var(--radius-md);
            padding: 20px;
            position: relative;
            overflow: hidden;
            min-height: 400px;
            border: 3px solid #333;
        }

        .road {
            position: relative;
            height: 300px;
            background: #2d2d2d;
            border-top: 4px dashed #f59e0b;
            border-bottom: 4px dashed #f59e0b;
            margin: 20px 0;
            overflow: hidden;
        }

        .lane {
            position: absolute;
            width: 100%;
            height: 80px;
            border-top: 2px dashed rgba(255, 255, 255, 0.2);
            border-bottom: 2px dashed rgba(255, 255, 255, 0.2);
        }

        .lane-1 { top: 60px; }
        .lane-2 { top: 150px; }

        .player-car {
            position: absolute;
            top: 85px;
            left: 50px;
            width: 60px;
            height: 30px;
            background: #5f17eb;
            border-radius: 5px;
            transition: left 0.3s ease, top 0.3s ease;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.8rem;
            box-shadow: 0 0 10px rgba(95, 23, 235, 0.5);
        }

        .construction-zone {
            position: absolute;
            top: 0;
            right: 100px;
            width: 200px;
            height: 100%;
            background: rgba(245, 158, 11, 0.2);
            border-left: 4px solid #f59e0b;
            border-right: 4px solid #f59e0b;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            animation: warningPulse 2s infinite;
        }

        .cone {
            position: absolute;
            width: 20px;
            height: 30px;
            background: linear-gradient(to bottom, #ff6b00, #ffa500);
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
        }

        .worker {
            position: absolute;
            width: 30px;
            height: 40px;
            background: #ff6b6b;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .speed-limit-sign {
            position: absolute;
            top: 20px;
            right: 120px;
            width: 60px;
            height: 60px;
            background: white;
            border: 4px solid #f59e0b;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.5rem;
            color: #f59e0b;
            z-index: 20;
        }

        /* Controls Panel */
        .controls-panel {
            background: rgba(245, 158, 11, 0.05);
            border-radius: var(--radius-md);
            padding: 20px;
            border: 2px solid rgba(245, 158, 11, 0.2);
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-label {
            display: block;
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--color-warning);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .control-btn {
            width: 100%;
            padding: 12px;
            margin: 5px 0;
            background: white;
            border: 2px solid rgba(245, 158, 11, 0.3);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 600;
            color: var(--color-text);
            transition: all 0.3s ease;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-btn:hover {
            background: rgba(245, 158, 11, 0.1);
            border-color: var(--color-warning);
            transform: translateX(5px);
        }

        .control-btn.active {
            background: rgba(245, 158, 11, 0.2);
            border-color: var(--color-warning);
            color: var(--color-warning);
        }

        .control-icon {
            font-size: 1.2rem;
        }

        /* Hazard Identification */
        .hazard-identification {
            background: rgba(95, 23, 235, 0.05);
            border-radius: var(--radius-md);
            padding: 25px;
            margin-bottom: 20px;
            border: 2px solid rgba(95, 23, 235, 0.2);
        }

        .hazard-title {
            font-size: 1.1rem;
            font-weight: 800;
            color: var(--color-primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hazard-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        @media (max-width: 768px) {
            .hazard-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .hazard-grid {
                grid-template-columns: 1fr;
            }
        }

        .hazard-item {
            background: white;
            border-radius: var(--radius-sm);
            padding: 15px;
            border: 2px solid rgba(245, 158, 11, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 10px;
        }

        .hazard-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(245, 158, 11, 0.1);
            border-color: var(--color-warning);
        }

        .hazard-item.selected {
            border-color: var(--color-primary);
            background: rgba(95, 23, 235, 0.1);
        }

        .hazard-item.correct {
            border-color: var(--color-success);
            background: rgba(16, 185, 129, 0.1);
        }

        .hazard-item.incorrect {
            border-color: var(--color-error);
            background: rgba(239, 68, 68, 0.1);
        }

        .hazard-icon {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .hazard-name {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--color-text);
        }

        /* Scenario Cards */
        .scenario-container {
            margin-bottom: 30px;
        }

        .scenario-card {
            background: white;
            border-radius: var(--radius-md);
            padding: 25px;
            margin-bottom: 20px;
            border: 2px solid rgba(245, 158, 11, 0.2);
            transition: all 0.3s ease;
        }

        .scenario-card.active {
            border-color: var(--color-warning);
            box-shadow: 0 10px 30px rgba(245, 158, 11, 0.1);
        }

        .scenario-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .scenario-number {
            font-size: 1.2rem;
            font-weight: 900;
            color: var(--color-warning);
            background: rgba(245, 158, 11, 0.1);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .scenario-title {
            font-size: 1.1rem;
            font-weight: 800;
            color: var(--color-text);
        }

        .scenario-description {
            color: var(--color-muted);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .scenario-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        @media (max-width: 600px) {
            .scenario-options {
                grid-template-columns: 1fr;
            }
        }

        .scenario-option {
            padding: 15px;
            background: rgba(245, 158, 11, 0.05);
            border-radius: var(--radius-sm);
            border: 2px solid rgba(245, 158, 11, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .scenario-option:hover {
            background: rgba(245, 158, 11, 0.1);
            border-color: var(--color-warning);
        }

        .scenario-option.selected {
            background: rgba(95, 23, 235, 0.1);
            border-color: var(--color-primary);
        }

        .scenario-option.correct {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--color-success);
        }

        .scenario-option.incorrect {
            background: rgba(239, 68, 68, 0.1);
            border-color: var(--color-error);
        }

        .option-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(245, 158, 11, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }

        /* Feedback */
        .feedback-container {
            background: rgba(245, 158, 11, 0.03);
            border-radius: var(--radius-sm);
            padding: 20px;
            border: 1px solid rgba(245, 158, 11, 0.15);
            margin-top: 20px;
            display: none;
            border-left: 4px solid var(--color-warning);
        }

        .feedback-container.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .feedback-title {
            font-size: 0.95rem;
            font-weight: 800;
            color: var(--color-warning);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .feedback-icon {
            font-size: 1.3rem;
            font-weight: bold;
        }

        .feedback-icon.correct { 
            color: var(--color-success); 
        }
        
        .feedback-icon.incorrect { 
            color: var(--color-error); 
        }

        .feedback-content {
            font-size: 0.9rem;
            color: var(--color-text);
            line-height: 1.7;
        }

        .feedback-content strong { 
            color: var(--color-warning); 
            font-weight: 700;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 14px 28px;
            border-radius: var(--radius-md);
            border: none;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .btn-primary {
            background: var(--color-warning);
            color: white;
            border: 2px solid var(--color-warning);
        }

        .btn-primary:hover {
            background: #d97706;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(245, 158, 11, 0.4);
        }

        .btn-secondary {
            background: white;
            color: var(--color-warning);
            border: 2px solid var(--color-warning);
        }

        .btn-secondary:hover {
            background: rgba(245, 158, 11, 0.1);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(245, 158, 11, 0.2);
        }

        .btn-icon { 
            font-size: 1.2em; 
            font-weight: bold;
        }

        /* Results Panel */
        .results-panel {
            background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%);
            color: white;
            border-radius: var(--radius-md);
            padding: 40px;
            margin-top: 40px;
            display: none;
            animation: fadeInUp 0.6s ease;
            border: 2px solid var(--color-warning);
        }

        .results-panel.show { 
            display: block; 
            animation: warningPulse 2s infinite;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .results-title {
            font-size: 1.6rem;
            font-weight: 800;
            color: white;
        }

        .score-display {
            font-size: 3.5rem;
            font-weight: 900;
            color: var(--color-warning);
            text-align: center;
            margin: 30px 0;
            text-shadow: 0 0 20px rgba(245, 158, 11, 0.7);
            animation: pulse 2s infinite;
        }

        .safety-insights {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
            padding: 25px;
            margin-top: 25px;
            border-left: 4px solid var(--color-warning);
        }

        .insights-title {
            font-size: 1.1rem;
            font-weight: 800;
            color: var(--color-warning);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .insights-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .insights-list li {
            display: flex;
            gap: 12px;
            align-items: flex-start;
            font-size: 0.95rem;
            color: #e5e7eb;
            line-height: 1.6;
        }

        .insight-dot {
            width: 8px;
            height: 8px;
            margin-top: 10px;
            border-radius: 999px;
            background: var(--color-warning);
            flex-shrink: 0;
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <main class="page" aria-labelledby="module-heading">
        <!-- Header -->
        <header class="brand-row">
            <div class="brand">
                <img
                    src="https://lwfiles.mycourse.app/vadrivingclinic-public/9f5c6b8121721c8ef241f929fd983b3e.png"
                    alt="VA Driving Clinic logo"
                    class="brand-logo"
                />
                <div class="course-meta">
                    <span class="course-name">VA Driving Clinic ‚Ä¢ Module 2</span>
                    <div class="week-label">
                        <span class="week-label-dot"></span>
                        <span>Construction Zone Safety</span>
                    </div>
                </div>
            </div>
            <span class="badge-mode">Interactive Simulation</span>
        </header>

        <h1 id="module-heading">Master Construction Zone Safety</h1>
        <p class="module-subtitle">
            Navigate through this 5-minute interactive simulation to learn critical safety practices for construction zones.
            Understand common hazards, proper driving techniques, and legal requirements to protect workers and yourself.
            Each year, over 700 fatalities occur in work zones‚Äîyour knowledge can help prevent accidents.
        </p>

        <!-- Time Estimate Banner -->
        <div class="time-estimate-banner">
            <div class="time-estimate-icon">
                ‚ö†Ô∏è
            </div>
            <div class="time-estimate-content">
                <h3>Simulation Time Estimate</h3>
                <p>Complete all 3 activities in approximately <span class="time-highlight">5 minutes</span>. This simulation covers hazard identification, safe navigation, and decision-making in construction zones.</p>
            </div>
        </div>

        <!-- Stats Display -->
        <div class="stats-display">
            <div class="stat-card">
                <span class="stat-number" id="completed-count">0</span>
                <span class="stat-label">Activities Completed</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="accuracy-rate">0%</span>
                <span class="stat-label">Safety Score</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="time-spent">0:00</span>
                <span class="stat-label">Time in Simulation</span>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-step active" data-step="1">
                <div class="step-circle">1</div>
                <div class="step-label">Hazard ID</div>
            </div>
            <div class="progress-step" data-step="2">
                <div class="step-circle">2</div>
                <div class="step-label">Road Simulation</div>
            </div>
            <div class="progress-step" data-step="3">
                <div class="step-circle">3</div>
                <div class="step-label">Scenario Test</div>
            </div>
        </div>

        <!-- Activity 1: Hazard Identification -->
        <section class="hazard-identification" id="activity-1" data-activity="1">
            <div class="hazard-title">
                <span>üîç</span>
                <span>Identify Construction Zone Hazards</span>
                <span class="activity-status" style="margin-left: auto; font-size: 0.8rem; padding: 4px 10px; border-radius: 12px; background: rgba(245, 158, 11, 0.1); color: var(--color-warning); font-weight: 600;">Not Started</span>
            </div>
            <p style="color: var(--color-muted); margin-bottom: 20px; font-size: 0.9rem;">
                Click on the 4 most common hazards in construction zones. Understanding these hazards is crucial for safe navigation.
            </p>

            <div class="hazard-grid" id="hazard-grid">
                <div class="hazard-item" data-hazard="narrow-lanes">
                    <div class="hazard-icon">üöß</div>
                    <div class="hazard-name">Narrow Lanes</div>
                </div>
                <div class="hazard-item" data-hazard="lane-shifts">
                    <div class="hazard-icon">‚ÜîÔ∏è</div>
                    <div class="hazard-name">Lane Shifts</div>
                </div>
                <div class="hazard-item" data-hazard="uneven-surfaces">
                    <div class="hazard-icon">üï≥Ô∏è</div>
                    <div class="hazard-name">Uneven Surfaces</div>
                </div>
                <div class="hazard-item" data-hazard="road-debris">
                    <div class="hazard-icon">üß±</div>
                    <div class="hazard-name">Road Debris</div>
                </div>
                <div class="hazard-item" data-hazard="construction-workers">
                    <div class="hazard-icon">üë∑</div>
                    <div class="hazard-name">Workers Nearby</div>
                </div>
                <div class="hazard-item" data-hazard="heavy-equipment">
                    <div class="hazard-icon">üöú</div>
                    <div class="hazard-name">Heavy Equipment</div>
                </div>
                <div class="hazard-item" data-hazard="reduced-visibility">
                    <div class="hazard-icon">üå´Ô∏è</div>
                    <div class="hazard-name">Reduced Visibility</div>
                </div>
                <div class="hazard-item" data-hazard="temporary-signs">
                    <div class="hazard-icon">üõë</div>
                    <div class="hazard-name">Temporary Signs</div>
                </div>
                <div class="hazard-item" data-hazard="speed-changes">
                    <div class="hazard-icon">üìâ</div>
                    <div class="hazard-name">Speed Limit Changes</div>
                </div>
            </div>

            <!-- Feedback -->
            <div class="feedback-container" id="feedback-1">
                <div class="feedback-title">
                    <span class="feedback-icon correct">‚úì</span>
                    Hazard Identification Complete
                </div>
                <div class="feedback-content">
                    <strong>Key Construction Zone Hazards:</strong><br><br>
                    ‚Ä¢ <strong>Narrow Lanes:</strong> Reduced space increases collision risk. Maintain center position.<br>
                    ‚Ä¢ <strong>Lane Shifts:</strong> Unexpected changes require quick but controlled responses.<br>
                    ‚Ä¢ <strong>Uneven Surfaces:</strong> Potholes and rough pavement affect vehicle control.<br>
                    ‚Ä¢ <strong>Road Debris:</strong> Construction materials can damage tires and cause accidents.<br>
                    ‚Ä¢ <strong>Workers Nearby:</strong> Always be prepared to stop for workers near traffic lanes.<br><br>
                    
                    <strong>Safety Statistic:</strong> In 2024, approximately 35% of work zone fatalities involved drivers hitting construction workers.
                </div>
            </div>
        </section>

        <!-- Construction Simulation -->
        <div class="construction-simulation">
            <!-- Road Simulation -->
            <div class="road-simulation-container" id="activity-2" data-activity="2">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: white; font-size: 1.1rem; font-weight: 700;">Construction Zone Navigation Simulation</h3>
                    <span class="activity-status" style="font-size: 0.8rem; padding: 4px 10px; border-radius: 12px; background: rgba(245, 158, 11, 0.2); color: var(--color-warning); font-weight: 600;">Not Started</span>
                </div>
                
                <div class="road">
                    <!-- Lanes -->
                    <div class="lane lane-1"></div>
                    <div class="lane lane-2"></div>
                    
                    <!-- Player Car -->
                    <div class="player-car" id="player-car">YOU</div>
                    
                    <!-- Construction Zone -->
                    <div class="construction-zone" id="construction-zone">
                        <div class="speed-limit-sign" id="speed-limit">35</div>
                        <div class="cone" style="top: 50px; left: 10px;"></div>
                        <div class="cone" style="top: 100px; right: 10px;"></div>
                        <div class="worker" style="top: 180px; left: 50px;">üë∑</div>
                        <div class="cone" style="bottom: 50px; left: 30px;"></div>
                        <div class="cone" style="bottom: 100px; right: 30px;"></div>
                    </div>
                    
                    <!-- Other Vehicles -->
                    <div class="player-car" style="background: #6b7280; top: 155px; left: 150px;">CAR</div>
                    <div class="player-car" style="background: #ef4444; top: 85px; left: 300px;">TRUCK</div>
                </div>
                
                <div style="color: #ccc; font-size: 0.85rem; margin-top: 15px; text-align: center;">
                    <p>Use the controls to navigate safely through the construction zone. Watch for workers and obey the reduced speed limit.</p>
                </div>
            </div>

            <!-- Controls Panel -->
            <div class="controls-panel">
                <h3 style="color: var(--color-warning); margin-bottom: 20px; font-size: 1.1rem; font-weight: 800;">Simulation Controls</h3>
                
                <div class="control-group">
                    <div class="control-label">Speed Control</div>
                    <button class="control-btn" data-action="speed-25">
                        <span class="control-icon">üê¢</span>
                        25 mph (Safe)
                    </button>
                    <button class="control-btn" data-action="speed-35">
                        <span class="control-icon">üö∂</span>
                        35 mph (Posted Limit)
                    </button>
                    <button class="control-btn" data-action="speed-45">
                        <span class="control-icon">üöó</span>
                        45 mph (Unsafe)
                    </button>
                    <button class="control-btn" data-action="speed-55">
                        <span class="control-icon">üí®</span>
                        55 mph (Dangerous)
                    </button>
                </div>
                
                <div class="control-group">
                    <div class="control-label">Navigation Actions</div>
                    <button class="control-btn" data-action="change-lane">
                        <span class="control-icon">‚ÜîÔ∏è</span>
                        Change Lane Safely
                    </button>
                    <button class="control-btn" data-action="increase-following">
                        <span class="control-icon">üìè</span>
                        Increase Following Distance
                    </button>
                    <button class="control-btn" data-action="maintain-position">
                        <span class="control-icon">üéØ</span>
                        Maintain Lane Position
                    </button>
                    <button class="control-btn" data-action="stop-for-workers">
                        <span class="control-icon">‚úã</span>
                        Stop for Workers
                    </button>
                </div>
                
                <div class="control-group">
                    <div class="control-label">Awareness Actions</div>
                    <button class="control-btn" data-action="check-mirrors">
                        <span class="control-icon">üëÄ</span>
                        Check Mirrors & Blind Spots
                    </button>
                    <button class="control-btn" data-action="watch-for-signs">
                        <span class="control-icon">üëÅÔ∏è</span>
                        Watch for Temporary Signs
                    </button>
                    <button class="control-btn" data-action="anticipate-changes">
                        <span class="control-icon">üéØ</span>
                        Anticipate Lane Changes
                    </button>
                    <button class="control-btn" data-action="avoid-distractions">
                        <span class="control-icon">üìµ</span>
                        Avoid Distractions
                    </button>
                </div>
                
                <!-- Feedback -->
                <div class="feedback-container" id="feedback-2">
                    <div class="feedback-title">
                        <span class="feedback-icon correct">‚úì</span>
                        Navigation Simulation Complete
                    </div>
                    <div class="feedback-content">
                        <strong>Safe Navigation Practices Verified:</strong><br><br>
                        ‚Ä¢ <strong>Reduced Speed:</strong> Posted limits protect workers and provide reaction time.<br>
                        ‚Ä¢ <strong>Increased Following Distance:</strong> 4+ seconds in construction zones.<br>
                        ‚Ä¢ <strong>Lane Discipline:</strong> Maintain position, avoid last-minute changes.<br>
                        ‚Ä¢ <strong>Worker Protection:</strong> Always yield to workers near traffic lanes.<br><br>
                        
                        <strong>Legal Requirement:</strong> Virginia doubles fines for speeding in active work zones.
                    </div>
                </div>
            </div>
        </div>

        <!-- Activity 3: Scenario Test -->
        <section class="scenario-container" id="activity-3" data-activity="3">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="color: var(--color-text); font-size: 1.2rem; font-weight: 800;">Construction Zone Scenario Test</h3>
                <span class="activity-status" style="font-size: 0.8rem; padding: 4px 10px; border-radius: 12px; background: rgba(95, 23, 235, 0.1); color: var(--color-primary); font-weight: 600;">Not Started</span>
            </div>
            
            <p style="color: var(--color-muted); margin-bottom: 25px; font-size: 0.9rem;">
                Test your decision-making skills in these realistic construction zone scenarios. Select the safest course of action for each situation.
            </p>

            <!-- Scenario 1 -->
            <div class="scenario-card" id="scenario-1">
                <div class="scenario-header">
                    <div class="scenario-number">1</div>
                    <div class="scenario-title">Approaching a Work Zone with Lane Closure</div>
                </div>
                <p class="scenario-description">
                    You're driving on a highway and see "RIGHT LANE CLOSED 1000 FT" signs. Traffic is heavy, and some vehicles are trying to merge at the last minute. What should you do?
                </p>
                <div class="scenario-options">
                    <div class="scenario-option" data-scenario="1" data-option="A">
                        <span class="option-icon">A</span>
                        <span>Merge early when you first see the warning signs</span>
                    </div>
                    <div class="scenario-option" data-scenario="1" data-option="B">
                        <span class="option-icon">B</span>
                        <span>Stay in your lane until the last moment to save time</span>
                    </div>
                    <div class="scenario-option" data-scenario="1" data-option="C">
                        <span class="option-icon">C</span>
                        <span>Speed up to get ahead of other merging vehicles</span>
                    </div>
                    <div class="scenario-option" data-scenario="1" data-option="D">
                        <span class="option-icon">D</span>
                        <span>Use the shoulder to bypass the merging traffic</span>
                    </div>
                </div>
            </div>

            <!-- Scenario 2 -->
            <div class="scenario-card" id="scenario-2">
                <div class="scenario-header">
                    <div class="scenario-number">2</div>
                    <div class="scenario-title">Worker Suddenly Enters Traffic Lane</div>
                </div>
                <p class="scenario-description">
                    You're driving through a construction zone at the posted 35 mph speed limit. A construction worker suddenly steps into your lane to retrieve equipment. What is your safest response?
                </p>
                <div class="scenario-options">
                    <div class="scenario-option" data-scenario="2" data-option="A">
                        <span class="option-icon">A</span>
                        <span>Swerve into the adjacent lane immediately</span>
                    </div>
                    <div class="scenario-option" data-scenario="2" data-option="B">
                        <span class="option-icon">B</span>
                        <span>Honk loudly and continue at your speed</span>
                    </div>
                    <div class="scenario-option" data-scenario="2" data-option="C">
                        <span class="option-icon">C</span>
                        <span>Brake firmly while checking mirrors for following traffic</span>
                    </div>
                    <div class="scenario-option" data-scenario="2" data-option="D">
                        <span class="option-icon">D</span>
                        <span>Accelerate to get past the worker quickly</span>
                    </div>
                </div>
            </div>

            <!-- Scenario 3 -->
            <div class="scenario-card" id="scenario-3">
                <div class="scenario-header">
                    <div class="scenario-number">3</div>
                    <div class="scenario-title">Nighttime Construction Zone Navigation</div>
                </div>
                <p class="scenario-description">
                    You're driving at night through a construction zone with reduced visibility. Temporary lights create glare, and the lane markings are faded. How should you adjust your driving?
                </p>
                <div class="scenario-options">
                    <div class="scenario-option" data-scenario="3" data-option="A">
                        <span class="option-icon">A</span>
                        <span>Increase speed to spend less time in the zone</span>
                    </div>
                    <div class="scenario-option" data-scenario="3" data-option="B">
                        <span class="option-icon">B</span>
                        <span>Use high beams to see better despite the glare</span>
                    </div>
                    <div class="scenario-option" data-scenario="3" data-option="C">
                        <span class="option-icon">C</span>
                        <span>Reduce speed below the posted limit and increase following distance</span>
                    </div>
                    <div class="scenario-option" data-scenario="3" data-option="D">
                        <span class="option-icon">D</span>
                        <span>Follow the taillights of the vehicle ahead closely</span>
                    </div>
                </div>
            </div>

            <!-- Feedback -->
            <div class="feedback-container" id="feedback-3">
                <div class="feedback-title">
                    <span class="feedback-icon correct">‚úì</span>
                    Scenario Test Results
                </div>
                <div class="feedback-content">
                    <strong>Correct Answers:</strong><br>
                    1. <strong>A - Merge early when you first see the warning signs</strong><br>
                    2. <strong>C - Brake firmly while checking mirrors for following traffic</strong><br>
                    3. <strong>C - Reduce speed below the posted limit and increase following distance</strong><br><br>
                    
                    <strong>Key Safety Principles:</strong><br>
                    ‚Ä¢ <strong>Early Merging:</strong> Prevents last-minute conflicts and reduces crash risk by 40%.<br>
                    ‚Ä¢ <strong>Worker Protection:</strong> Always prioritize worker safety over convenience.<br>
                    ‚Ä¢ <strong>Adjusted Driving:</strong> Adapt to conditions, especially at night or in poor visibility.<br><br>
                    
                    <strong>Legal Note:</strong> In Virginia, causing injury to a construction worker can result in felony charges.
                </div>
            </div>
        </section>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-secondary" id="reset-all-btn">
                <span class="btn-icon">‚Üª</span>
                Reset Simulation
            </button>
            <button class="btn btn-secondary" id="check-answers-btn">
                <span class="btn-icon">‚úì</span>
                Check All Responses
            </button>
            <button class="btn btn-primary" id="view-results-btn">
                <span class="btn-icon">üìä</span>
                View Safety Report
            </button>
        </div>

        <!-- Results Panel -->
        <div class="results-panel" id="results-panel">
            <div class="results-header">
                <h2 class="results-title">Construction Zone Safety Proficiency</h2>
                <div class="score-display" id="final-score">0%</div>
            </div>
            
            <div class="safety-insights">
                <h3 class="insights-title">
                    <span>‚ö†Ô∏è</span> Construction Zone Safety Insights
                </h3>
                <ul class="insights-list">
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Worker Protection:</strong> Construction workers are 5 times more likely to be killed in work zones than in other construction settings. Always slow down and be prepared to stop when workers are present.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Speed Management:</strong> Reducing speed from 55 mph to 45 mph in work zones decreases stopping distance by 30%. Virginia law doubles fines for speeding in active construction zones.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Lane Discipline:</strong> Sudden lane changes cause 23% of work zone crashes. Merge early when you see warning signs and maintain your lane position through the zone.</span>
                    </li>
                </ul>
            </div>
            
            <div class="safety-insights" style="margin-top: 20px;">
                <h3 class="insights-title">
                    <span>üöß</span> Advanced Construction Zone Practices
                </h3>
                <ul class="insights-list">
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Night Navigation:</strong> Work zones are particularly dangerous at night. Reduce speed, increase following distance to 5+ seconds, and watch carefully for workers and equipment.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Weather Adaptation:</strong> Rain, fog, or snow combined with construction hazards requires extreme caution. Slow down an additional 10-15 mph below posted limits in adverse conditions.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Legal Awareness:</strong> Causing injury to a construction worker can result in criminal charges beyond traffic violations. Your attention saves lives and prevents legal consequences.</span>
                    </li>
                </ul>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // State Management
            const state = {
                activities: {
                    1: { completed: false, correct: 0, total: 4, score: 0, selectedHazards: [] },
                    2: { completed: false, correct: 0, total: 5, score: 0, actions: [] },
                    3: { completed: false, correct: 0, total: 3, score: 0, answers: {} }
                },
                startedAt: new Date(),
                timeSpent: 0,
                carPosition: { x: 50, y: 85 },
                currentSpeed: 35
            };

            // Correct answers
            const correctHazards = ['narrow-lanes', 'lane-shifts', 'uneven-surfaces', 'construction-workers'];
            const correctActions = ['speed-35', 'increase-following', 'maintain-position', 'check-mirrors', 'watch-for-signs'];
            const scenarioAnswers = {
                1: 'A',
                2: 'C',
                3: 'C'
            };

            // DOM Elements
            const progressSteps = document.querySelectorAll('.progress-step');
            const completedCount = document.getElementById('completed-count');
            const accuracyRate = document.getElementById('accuracy-rate');
            const timeSpentEl = document.getElementById('time-spent');
            const resetBtn = document.getElementById('reset-all-btn');
            const checkBtn = document.getElementById('check-answers-btn');
            const resultsBtn = document.getElementById('view-results-btn');
            const resultsPanel = document.getElementById('results-panel');
            const finalScore = document.getElementById('final-score');
            const playerCar = document.getElementById('player-car');
            const speedLimitSign = document.getElementById('speed-limit');

            // Timer for time spent
            function updateTimer() {
                const now = new Date();
                const diff = Math.floor((now - state.startedAt) / 1000);
                state.timeSpent = diff;
                const minutes = Math.floor(diff / 60);
                const seconds = diff % 60;
                timeSpentEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                // Update stats display
                let completed = 0;
                let totalCorrect = 0;
                let totalItems = 0;
                
                Object.values(state.activities).forEach(activity => {
                    if (activity.completed) completed++;
                    totalCorrect += activity.correct;
                    totalItems += activity.total;
                });
                
                completedCount.textContent = completed;
                const accuracy = totalItems > 0 ? Math.round((totalCorrect / totalItems) * 100) : 0;
                accuracyRate.textContent = `${accuracy}%`;
            }

            setInterval(updateTimer, 1000);

            // Update Progress Summary
            function updateProgressSummary() {
                let completed = 0;
                let totalCorrect = 0;
                let totalItems = 0;
                
                Object.values(state.activities).forEach(activity => {
                    if (activity.completed) completed++;
                    totalCorrect += activity.correct;
                    totalItems += activity.total;
                });

                // Update progress steps
                progressSteps.forEach((step, index) => {
                    if (index < completed) {
                        step.classList.add('completed');
                        step.classList.remove('active');
                    } else if (index === completed) {
                        step.classList.add('active');
                        step.classList.remove('completed');
                    } else {
                        step.classList.remove('active', 'completed');
                    }
                });

                // Update activity status indicators
                Object.keys(state.activities).forEach(activityId => {
                    const activity = state.activities[activityId];
                    const statusElement = document.querySelector(`#activity-${activityId} .activity-status`);
                    
                    if (activity.completed) {
                        statusElement.textContent = 'Completed';
                        statusElement.style.color = '#10b981';
                        statusElement.style.backgroundColor = 'rgba(16, 185, 129, 0.1)';
                    } else if (activity.selectedHazards?.length > 0 || activity.actions?.length > 0 || Object.keys(activity.answers || {}).length > 0) {
                        statusElement.textContent = 'In Progress';
                        statusElement.style.color = '#f59e0b';
                        statusElement.style.backgroundColor = 'rgba(245, 158, 11, 0.1)';
                    }
                });
            }

            // Activity 1: Hazard Identification
            function initActivity1() {
                const hazardItems = document.querySelectorAll('#hazard-grid .hazard-item');
                const feedback = document.getElementById('feedback-1');
                
                hazardItems.forEach(item => {
                    item.addEventListener('click', function() {
                        const hazardId = this.dataset.hazard;
                        
                        if (this.classList.contains('selected')) {
                            // Deselect
                            this.classList.remove('selected');
                            const index = state.activities[1].selectedHazards.indexOf(hazardId);
                            if (index > -1) {
                                state.activities[1].selectedHazards.splice(index, 1);
                            }
                        } else {
                            // Select if less than 4
                            if (state.activities[1].selectedHazards.length < 4) {
                                this.classList.add('selected');
                                state.activities[1].selectedHazards.push(hazardId);
                            } else {
                                // Show warning
                                this.style.animation = 'shake 0.5s ease';
                                setTimeout(() => {
                                    this.style.animation = '';
                                }, 500);
                            }
                        }
                        
                        // Check if 4 hazards are selected
                        if (state.activities[1].selectedHazards.length === 4 && !state.activities[1].completed) {
                            checkActivity1();
                        }
                    });
                });
                
                function checkActivity1() {
                    let correctCount = 0;
                    
                    // Check each selected hazard
                    state.activities[1].selectedHazards.forEach(hazardId => {
                        if (correctHazards.includes(hazardId)) {
                            correctCount++;
                            // Mark correct
                            document.querySelector(`[data-hazard="${hazardId}"]`).classList.add('correct');
                        } else {
                            // Mark incorrect
                            document.querySelector(`[data-hazard="${hazardId}"]`).classList.add('incorrect');
                        }
                    });
                    
                    // Mark unselected correct hazards
                    correctHazards.forEach(hazardId => {
                        if (!state.activities[1].selectedHazards.includes(hazardId)) {
                            document.querySelector(`[data-hazard="${hazardId}"]`).classList.add('correct');
                        }
                    });
                    
                    state.activities[1].completed = true;
                    state.activities[1].correct = correctCount;
                    state.activities[1].score = Math.round((correctCount / 4) * 100);
                    
                    feedback.classList.add('show');
                    updateProgressSummary();
                }
            }

            // Activity 2: Road Simulation
            function initActivity2() {
                const controlBtns = document.querySelectorAll('.controls-panel .control-btn');
                const feedback = document.getElementById('feedback-2');
                
                let actionsTaken = 0;
                
                controlBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        const action = this.dataset.action;
                        
                        if (this.classList.contains('active')) {
                            // Already active
                            return;
                        }
                        
                        // Remove active class from all buttons in same group
                        const parent = this.parentElement;
                        const siblings = parent.querySelectorAll('.control-btn');
                        siblings.forEach(sibling => {
                            sibling.classList.remove('active');
                        });
                        
                        // Add active class to clicked button
                        this.classList.add('active');
                        
                        // Record action
                        if (!state.activities[2].actions.includes(action)) {
                            state.activities[2].actions.push(action);
                            actionsTaken++;
                            
                            // Visual feedback
                            if (action.startsWith('speed-')) {
                                const speed = action.replace('speed-', '');
                                state.currentSpeed = parseInt(speed);
                                speedLimitSign.textContent = speed;
                                
                                // Color code based on safety
                                if (speed === '25' || speed === '35') {
                                    speedLimitSign.style.color = '#10b981';
                                    speedLimitSign.style.borderColor = '#10b981';
                                } else {
                                    speedLimitSign.style.color = '#ef4444';
                                    speedLimitSign.style.borderColor = '#ef4444';
                                }
                            }
                            
                            // Move car for certain actions
                            if (action === 'change-lane') {
                                state.carPosition.y = 155; // Move to lower lane
                                playerCar.style.top = state.carPosition.y + 'px';
                            } else if (action === 'maintain-position') {
                                state.carPosition.y = 85; // Return to upper lane
                                playerCar.style.top = state.carPosition.y + 'px';
                            }
                            
                            // Animate car movement
                            playerCar.style.transform = 'scale(1.1)';
                            setTimeout(() => {
                                playerCar.style.transform = 'scale(1)';
                            }, 300);
                            
                            // Check if enough actions taken
                            if (actionsTaken >= 5 && !state.activities[2].completed) {
                                setTimeout(checkActivity2, 500);
                            }
                        }
                    });
                });
                
                function checkActivity2() {
                    let correctCount = 0;
                    
                    // Check each action
                    state.activities[2].actions.forEach(action => {
                        if (correctActions.includes(action)) {
                            correctCount++;
                            // Mark correct
                            document.querySelector(`[data-action="${action}"]`).classList.add('correct');
                        } else {
                            // Mark incorrect
                            document.querySelector(`[data-action="${action}"]`).classList.add('incorrect');
                        }
                    });
                    
                    // Mark unselected correct actions
                    correctActions.forEach(action => {
                        if (!state.activities[2].actions.includes(action)) {
                            document.querySelector(`[data-action="${action}"]`).classList.add('correct');
                        }
                    });
                    
                    state.activities[2].completed = true;
                    state.activities[2].correct = correctCount;
                    state.activities[2].score = Math.round((correctCount / 5) * 100);
                    
                    feedback.classList.add('show');
                    updateProgressSummary();
                }
            }

            // Activity 3: Scenario Test
            function initActivity3() {
                const scenarioOptions = document.querySelectorAll('.scenario-option');
                const feedback = document.getElementById('feedback-3');
                
                let answeredScenarios = 0;
                
                scenarioOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        const scenario = this.dataset.scenario;
                        const selectedOption = this.dataset.option;
                        
                        // Remove selected class from all options for this scenario
                        const allOptionsForScenario = document.querySelectorAll(`[data-scenario="${scenario}"]`);
                        allOptionsForScenario.forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        
                        // Add selected class to clicked option
                        this.classList.add('selected');
                        
                        // Store the answer
                        state.activities[3].answers[scenario] = selectedOption;
                        
                        // Highlight the scenario card
                        const scenarioCard = document.getElementById(`scenario-${scenario}`);
                        scenarioCard.classList.add('active');
                        
                        // Check if all scenarios are answered
                        answeredScenarios = Object.keys(state.activities[3].answers).length;
                        if (answeredScenarios === 3 && !state.activities[3].completed) {
                            checkActivity3();
                        }
                    });
                });
                
                function checkActivity3() {
                    let correctCount = 0;
                    
                    // Check each answer
                    Object.keys(scenarioAnswers).forEach(scenario => {
                        const userAnswer = state.activities[3].answers[scenario];
                        const correctAnswer = scenarioAnswers[scenario];
                        
                        if (userAnswer === correctAnswer) {
                            correctCount++;
                            
                            // Mark correct option
                            const correctOption = document.querySelector(`[data-scenario="${scenario}"][data-option="${correctAnswer}"]`);
                            correctOption.classList.add('correct');
                        } else {
                            // Mark incorrect user selection
                            const userOption = document.querySelector(`[data-scenario="${scenario}"][data-option="${userAnswer}"]`);
                            if (userOption) userOption.classList.add('incorrect');
                            
                            // Mark correct answer
                            const correctOption = document.querySelector(`[data-scenario="${scenario}"][data-option="${correctAnswer}"]`);
                            correctOption.classList.add('correct');
                        }
                    });
                    
                    state.activities[3].completed = true;
                    state.activities[3].correct = correctCount;
                    state.activities[3].score = Math.round((correctCount / 3) * 100);
                    
                    feedback.classList.add('show');
                    updateProgressSummary();
                }
            }

            // Reset All Activities
            function resetAllActivities() {
                // Reset state
                Object.keys(state.activities).forEach(key => {
                    state.activities[key] = {
                        completed: false,
                        correct: 0,
                        total: parseInt(key) === 1 ? 4 : parseInt(key) === 2 ? 5 : 3,
                        score: 0,
                        selectedHazards: [],
                        actions: [],
                        answers: {}
                    };
                });
                
                // Reset Activity 1
                document.querySelectorAll('#hazard-grid .hazard-item').forEach(item => {
                    item.classList.remove('selected', 'correct', 'incorrect');
                });
                document.getElementById('feedback-1').classList.remove('show');
                
                // Reset Activity 2
                document.querySelectorAll('.controls-panel .control-btn').forEach(btn => {
                    btn.classList.remove('active', 'correct', 'incorrect');
                });
                state.carPosition = { x: 50, y: 85 };
                state.currentSpeed = 35;
                playerCar.style.top = '85px';
                playerCar.style.left = '50px';
                speedLimitSign.textContent = '35';
                speedLimitSign.style.color = '#f59e0b';
                speedLimitSign.style.borderColor = '#f59e0b';
                document.getElementById('feedback-2').classList.remove('show');
                
                // Reset Activity 3
                document.querySelectorAll('.scenario-option').forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                });
                document.querySelectorAll('.scenario-card').forEach(card => {
                    card.classList.remove('active');
                });
                document.getElementById('feedback-3').classList.remove('show');
                
                // Reset results
                resultsPanel.classList.remove('show');
                
                // Reset timer
                state.startedAt = new Date();
                state.timeSpent = 0;
                updateTimer();
                
                // Reset status indicators
                document.querySelectorAll('.activity-status').forEach(status => {
                    status.textContent = 'Not Started';
                    status.style.color = '';
                    status.style.backgroundColor = '';
                });
                
                // Update progress
                updateProgressSummary();
            }

            // Check All Answers
            function checkAllAnswers() {
                // Force check all activities
                if (!state.activities[1].completed) {
                    // Auto-select correct hazards
                    correctHazards.forEach(hazardId => {
                        const hazardItem = document.querySelector(`[data-hazard="${hazardId}"]`);
                        if (hazardItem) {
                            hazardItem.classList.add('selected', 'correct');
                            if (!state.activities[1].selectedHazards.includes(hazardId)) {
                                state.activities[1].selectedHazards.push(hazardId);
                            }
                        }
                    });
                    
                    state.activities[1].completed = true;
                    state.activities[1].correct = 4;
                    state.activities[1].score = 100;
                    document.getElementById('feedback-1').classList.add('show');
                }
                
                if (!state.activities[2].completed) {
                    // Auto-select correct actions
                    correctActions.forEach(action => {
                        const actionBtn = document.querySelector(`[data-action="${action}"]`);
                        if (actionBtn) {
                            actionBtn.classList.add('active', 'correct');
                            if (!state.activities[2].actions.includes(action)) {
                                state.activities[2].actions.push(action);
                            }
                        }
                    });
                    
                    // Update visual elements
                    speedLimitSign.textContent = '35';
                    speedLimitSign.style.color = '#10b981';
                    speedLimitSign.style.borderColor = '#10b981';
                    
                    state.activities[2].completed = true;
                    state.activities[2].correct = 5;
                    state.activities[2].score = 100;
                    document.getElementById('feedback-2').classList.add('show');
                }
                
                if (!state.activities[3].completed) {
                    // Auto-select correct answers
                    Object.keys(scenarioAnswers).forEach(scenario => {
                        const correctAnswer = scenarioAnswers[scenario];
                        const correctOption = document.querySelector(`[data-scenario="${scenario}"][data-option="${correctAnswer}"]`);
                        if (correctOption) {
                            correctOption.classList.add('selected', 'correct');
                            state.activities[3].answers[scenario] = correctAnswer;
                            
                            // Highlight scenario card
                            document.getElementById(`scenario-${scenario}`).classList.add('active');
                        }
                    });
                    
                    state.activities[3].completed = true;
                    state.activities[3].correct = 3;
                    state.activities[3].score = 100;
                    document.getElementById('feedback-3').classList.add('show');
                }
                
                updateProgressSummary();
            }

            // View Final Results
            function viewFinalResults() {
                let totalScore = 0;
                let activityCount = 0;
                
                Object.values(state.activities).forEach(activity => {
                    if (activity.completed) {
                        totalScore += activity.score;
                        activityCount++;
                    }
                });
                
                const averageScore = activityCount > 0 ? Math.round(totalScore / activityCount) : 0;
                finalScore.textContent = `${averageScore}%`;
                
                resultsPanel.classList.add('show');
                resultsPanel.scrollIntoView({ behavior: 'smooth' });
            }

            // Initialize all activities
            initActivity1();
            initActivity2();
            initActivity3();

            // Event listeners
            resetBtn.addEventListener('click', resetAllActivities);
            checkBtn.addEventListener('click', checkAllAnswers);
            resultsBtn.addEventListener('click', viewFinalResults);

            // Initial progress update
            updateTimer();
            updateProgressSummary();
        });
    </script>
</body>
</html>
