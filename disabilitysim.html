<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disability Income Insurance & Benefit Programs - Interactive Simulation</title>
    <style>
        :root {
            --color-primary: #1a3d7c;
            --color-primary-light: #2d5ba3;
            --color-primary-dark: #0d2b5a;
            --color-secondary: #af4bef;
            --color-secondary-light: #d492ff;
            --color-secondary-dark: #8a00cc;
            --color-success: #00b894;
            --color-success-light: #00e5b4;
            --color-warning: #f59e0b;
            --color-warning-light: #ffc048;
            --color-error: #e17055;
            --color-error-light: #ff8c69;
            --color-info: #8380f0;
            --color-info-light: #a8a5ff;
            --color-bg: #f7f5fb;
            --color-bg-light: #ffffff;
            --color-bg-dark: #f1ecff;
            --color-text: #1a202c;
            --color-text-light: #4a5568;
            --color-text-muted: #718096;
            --radius-xl: 24px;
            --radius-lg: 16px;
            --radius-md: 12px;
            --radius-sm: 8px;
            --shadow-sm: 0 2px 8px rgba(26, 61, 124, 0.08);
            --shadow-md: 0 4px 16px rgba(26, 61, 124, 0.12);
            --shadow-lg: 0 8px 32px rgba(26, 61, 124, 0.16);
            --shadow-xl: 0 12px 48px rgba(26, 61, 124, 0.2);
            --transition-fast: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f7f5fb 0%, #f1ecff 100%);
            color: var(--color-text);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 500px;
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-info) 100%);
            clip-path: polygon(0 0, 100% 0, 100% 85%, 0 100%);
            z-index: -1;
            opacity: 0.9;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInRight {
            from { transform: translateX(50px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideInLeft {
            from { transform: translateX(-50px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            33% { transform: translateY(-10px) rotate(3deg); }
            66% { transform: translateY(5px) rotate(-3deg); }
        }

        @keyframes highlight {
            0%, 100% { box-shadow: 0 0 0 0 rgba(175, 75, 239, 0); }
            50% { box-shadow: 0 0 0 12px rgba(175, 75, 239, 0.1); }
        }

        .simulation-container {
            max-width: 1400px;
            margin: 0 auto;
            animation: fadeIn 0.8s var(--transition-base);
        }

        /* Enhanced Header */
        .brand-header {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.98) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-xl);
            padding: 35px 45px;
            margin-bottom: 40px;
            box-shadow: var(--shadow-xl);
            position: relative;
            overflow: hidden;
            animation: slideInRight 0.6s var(--transition-base);
        }

        .brand-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, 
                var(--color-primary) 0%, 
                var(--color-secondary) 25%, 
                var(--color-info) 50%, 
                var(--color-success) 75%, 
                var(--color-warning) 100%);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        }

        .brand-content {
            display: flex;
            align-items: center;
            gap: 30px;
            position: relative;
            z-index: 1;
        }

        .brand-logo-container {
            position: relative;
        }

        .brand-logo {
            height: 80px;
            width: 80px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
            border-radius: var(--radius-lg);
            padding: 18px;
            filter: drop-shadow(0 6px 20px rgba(26, 61, 124, 0.3));
            animation: float 6s ease-in-out infinite;
        }

        .logo-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 32px;
            height: 32px;
            background: var(--color-warning);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 900;
            border: 3px solid white;
            animation: pulse 3s infinite;
        }

        .brand-text {
            flex: 1;
        }

        .module-tag {
            display: inline-block;
            background: linear-gradient(135deg, var(--color-info), var(--color-secondary));
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 800;
            margin-bottom: 15px;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            box-shadow: var(--shadow-sm);
        }

        .brand-title {
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--color-primary), var(--color-info));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 12px;
            line-height: 1.2;
        }

        .brand-subtitle {
            font-size: 1.1rem;
            color: var(--color-text-light);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .subtitle-icon {
            color: var(--color-info);
            animation: pulse 2s infinite;
        }

        /* Enhanced Dashboard */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 25px;
            margin-bottom: 45px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.92) 0%, rgba(255, 255, 255, 0.96) 100%);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: var(--radius-lg);
            padding: 30px;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
            transition: all var(--transition-base);
            cursor: pointer;
            border-left: 5px solid var(--color-primary);
        }

        .stat-card:nth-child(2) { border-left-color: var(--color-info); }
        .stat-card:nth-child(3) { border-left-color: var(--color-success); }
        .stat-card:nth-child(4) { border-left-color: var(--color-secondary); }

        .stat-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: var(--shadow-xl);
        }

        .stat-icon {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-info));
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 25px;
            color: white;
            font-size: 1.8rem;
        }

        .stat-content {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 900;
            color: var(--color-primary);
            line-height: 1;
            font-family: 'Courier New', monospace;
        }

        .stat-label {
            font-size: 0.95rem;
            color: var(--color-text-muted);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            margin-top: 12px;
        }

        .stat-trend {
            font-size: 0.9rem;
            color: var(--color-success);
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* Enhanced Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.98) 100%);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-lg);
            padding: 35px;
            margin-bottom: 45px;
            box-shadow: var(--shadow-lg);
            animation: slideInLeft 0.6s var(--transition-base);
        }

        .tracker-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
        }

        .tracker-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--color-primary);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .tracker-title::before {
            content: '';
            width: 16px;
            height: 16px;
            background: var(--color-info);
            border-radius: 4px;
            display: block;
            transform: rotate(45deg);
        }

        .tracker-percent {
            font-size: 2rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--color-primary), var(--color-info));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-family: 'Courier New', monospace;
        }

        .tracker-visual {
            position: relative;
            margin-bottom: 40px;
        }

        .tracker-bar {
            height: 20px;
            background: linear-gradient(135deg, var(--color-bg-dark) 0%, var(--color-bg) 100%);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .tracker-fill {
            height: 100%;
            background: linear-gradient(90deg, 
                var(--color-primary) 0%, 
                var(--color-info) 25%, 
                var(--color-secondary) 50%, 
                var(--color-success) 75%, 
                var(--color-warning) 100%);
            background-size: 200% 100%;
            border-radius: 10px;
            width: 0%;
            transition: width 1s cubic-bezier(0.34, 1.56, 0.64, 1);
            animation: shimmer 3s infinite linear;
        }

        .tracker-milestones {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            padding: 0 15px;
        }

        .milestone {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .milestone-dot {
            width: 24px;
            height: 24px;
            background: var(--color-bg-light);
            border: 4px solid var(--color-primary-light);
            border-radius: 50%;
            margin-bottom: 12px;
            position: relative;
            transition: all var(--transition-base);
        }

        .milestone.completed .milestone-dot {
            background: var(--color-success);
            border-color: var(--color-success);
            box-shadow: 0 0 0 8px rgba(0, 184, 148, 0.2);
            animation: highlight 2s infinite;
        }

        .milestone.active .milestone-dot {
            background: var(--color-info);
            border-color: var(--color-info);
            animation: pulse 1.5s infinite;
        }

        .milestone-label {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--color-text-muted);
            text-align: center;
            max-width: 100px;
        }

        .milestone.completed .milestone-label {
            color: var(--color-success);
        }

        .milestone.active .milestone-label {
            color: var(--color-info);
            font-weight: 800;
        }

        /* Simulation Area */
        .simulation-area {
            display: grid;
            grid-template-columns: 360px 1fr;
            gap: 35px;
            margin-bottom: 60px;
        }

        @media (max-width: 1200px) {
            .simulation-area {
                grid-template-columns: 1fr;
            }
        }

        /* Enhanced Patient Profile */
        .patient-profile {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.98) 100%);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-lg);
            padding: 35px;
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 20px;
            animation: slideInLeft 0.6s var(--transition-base);
        }

        .profile-header {
            text-align: center;
            margin-bottom: 35px;
            padding-bottom: 30px;
            border-bottom: 3px solid var(--color-bg-dark);
            position: relative;
        }

        .profile-header::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 25%;
            width: 50%;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--color-info), transparent);
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-info));
            border-radius: 50%;
            margin: 0 auto 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: white;
            font-weight: 900;
            position: relative;
            box-shadow: 0 12px 40px rgba(26, 61, 124, 0.4);
        }

        .profile-avatar::after {
            content: '';
            position: absolute;
            top: -6px;
            left: -6px;
            right: -6px;
            bottom: -6px;
            border: 3px solid var(--color-info-light);
            border-radius: 50%;
            animation: pulse 3s infinite;
        }

        .profile-name {
            font-size: 1.7rem;
            font-weight: 900;
            color: var(--color-primary);
            margin-bottom: 8px;
        }

        .profile-occupation {
            font-size: 1.1rem;
            color: var(--color-info);
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .profile-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--color-secondary), var(--color-info-light));
            color: white;
            padding: 10px 25px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 800;
            letter-spacing: 0.06em;
            box-shadow: var(--shadow-md);
        }

        .profile-details {
            margin-top: 35px;
        }

        .detail-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1rem;
            font-weight: 800;
            color: var(--color-info);
            margin-bottom: 18px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--color-bg-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 18px;
            padding-bottom: 18px;
            border-bottom: 1px solid var(--color-bg-dark);
            position: relative;
        }

        .detail-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .detail-label {
            font-weight: 600;
            color: var(--color-text-light);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .detail-label::before {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--color-info);
            border-radius: 50%;
            display: block;
        }

        .detail-value {
            font-weight: 700;
            color: var(--color-primary);
            text-align: right;
            font-size: 1rem;
        }

        .coverage-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
        }

        .coverage-active {
            background: rgba(0, 184, 148, 0.1);
            color: var(--color-success);
            border: 2px solid rgba(0, 184, 148, 0.3);
        }

        .coverage-pending {
            background: rgba(245, 158, 11, 0.1);
            color: var(--color-warning);
            border: 2px solid rgba(245, 158, 11, 0.3);
        }

        .coverage-none {
            background: rgba(131, 128, 240, 0.1);
            color: var(--color-info);
            border: 2px solid rgba(131, 128, 240, 0.3);
        }

        /* Enhanced Simulation Content */
        .simulation-content {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.98) 100%);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-lg);
            padding: 45px;
            box-shadow: var(--shadow-lg);
            animation: slideInRight 0.6s var(--transition-base);
        }

        .scenario-header {
            display: flex;
            align-items: center;
            gap: 25px;
            margin-bottom: 35px;
            padding-bottom: 30px;
            border-bottom: 3px solid var(--color-bg-dark);
            position: relative;
        }

        .scenario-header::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 150px;
            height: 3px;
            background: linear-gradient(90deg, var(--color-info), transparent);
        }

        .scenario-number {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-info));
            color: white;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.8rem;
            flex-shrink: 0;
            box-shadow: var(--shadow-lg);
        }

        .scenario-title {
            font-size: 2rem;
            font-weight: 900;
            color: var(--color-primary);
            line-height: 1.3;
        }

        .scenario-tag {
            display: inline-block;
            background: linear-gradient(135deg, var(--color-warning), #ffb74d);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 800;
            margin-left: 20px;
            vertical-align: middle;
        }

        .scenario-description {
            margin-bottom: 45px;
            padding: 30px;
            background: linear-gradient(135deg, var(--color-bg-dark) 0%, var(--color-bg) 100%);
            border-radius: var(--radius-lg);
            border-left: 6px solid var(--color-info);
            position: relative;
            overflow: hidden;
        }

        .scenario-description::before {
            content: 'üè•';
            position: absolute;
            top: 25px;
            right: 25px;
            font-size: 3rem;
            opacity: 0.1;
        }

        .learning-objective {
            background: linear-gradient(135deg, rgba(131, 128, 240, 0.05) 0%, rgba(175, 75, 239, 0.05) 100%);
            border-left: 4px solid var(--color-secondary);
            padding: 20px;
            margin-top: 20px;
            border-radius: 0 var(--radius-md) var(--radius-md) 0;
        }

        /* Enhanced Interactive Sections */
        .interactive-section {
            margin-bottom: 45px;
        }

        .section-header {
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--color-primary);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            padding-left: 25px;
            position: relative;
        }

        .section-header::before {
            content: '';
            position: absolute;
            left: 0;
            width: 8px;
            height: 100%;
            background: linear-gradient(180deg, var(--color-info), var(--color-secondary));
            border-radius: 4px;
        }

        /* Enhanced Program Comparison */
        .program-comparison {
            background: linear-gradient(135deg, rgba(0, 184, 148, 0.05) 0%, rgba(131, 128, 240, 0.05) 100%);
            border: 2px solid rgba(0, 184, 148, 0.1);
            border-radius: var(--radius-lg);
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .comparison-question {
            font-weight: 800;
            margin-bottom: 25px;
            color: var(--color-success);
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .comparison-question::before {
            content: 'ü§î';
            font-size: 1.5rem;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }

        .program-card {
            background: white;
            border: 2px solid rgba(0, 184, 148, 0.2);
            border-radius: var(--radius-lg);
            padding: 30px;
            cursor: pointer;
            transition: all var(--transition-fast);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .program-card:hover {
            transform: translateY(-8px);
            border-color: var(--color-success);
            box-shadow: var(--shadow-lg);
        }

        .program-card.selected {
            background: linear-gradient(135deg, var(--color-success), #26a69a);
            color: white;
            border-color: transparent;
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0, 184, 148, 0.3);
        }

        .program-card.selected .program-name {
            color: white;
        }

        .program-card.selected .program-desc {
            color: rgba(255, 255, 255, 0.9);
        }

        .program-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-info));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .program-card.selected .program-icon {
            background: white;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .program-name {
            font-weight: 900;
            color: var(--color-primary);
            margin-bottom: 15px;
            font-size: 1.4rem;
        }

        .program-desc {
            font-size: 0.95rem;
            color: var(--color-text-muted);
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .program-features {
            text-align: left;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid rgba(0, 0, 0, 0.05);
        }

        .program-card.selected .program-features {
            border-top: 2px solid rgba(255, 255, 255, 0.2);
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .feature-item i {
            color: var(--color-success);
        }

        .program-card.selected .feature-item i {
            color: white;
        }

        /* Enhanced SSDI vs SSI Comparison */
        .ssdi-ssi-comparison {
            margin: 40px 0;
        }

        .comparison-table {
            background: white;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            margin-top: 25px;
        }

        .comparison-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            border-bottom: 1px solid var(--color-bg-dark);
        }

        .comparison-row.header {
            background: linear-gradient(135deg, var(--color-primary), var(--color-info));
            color: white;
            font-weight: 800;
            font-size: 1.1rem;
        }

        .comparison-cell {
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .comparison-cell.dim {
            background: var(--color-bg);
            color: var(--color-text-light);
            font-weight: 600;
        }

        .comparison-cell.highlight {
            background: rgba(0, 184, 148, 0.05);
            border-left: 4px solid var(--color-success);
        }

        .cell-icon {
            font-size: 1.2rem;
            color: var(--color-info);
        }

        .comparison-row.header .cell-icon {
            color: white;
        }

        /* Enhanced Benefit Analysis */
        .benefit-analysis {
            background: linear-gradient(135deg, rgba(241, 236, 255, 0.5) 0%, rgba(247, 245, 251, 0.8) 100%);
            border: 2px solid rgba(175, 75, 239, 0.1);
            border-radius: var(--radius-lg);
            padding: 35px;
            margin: 40px 0;
            position: relative;
        }

        .analysis-steps {
            display: flex;
            justify-content: space-between;
            margin: 30px 0 45px;
            position: relative;
            padding: 0 25px;
        }

        .analysis-steps::before {
            content: '';
            position: absolute;
            top: 30px;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, 
                var(--color-primary) 0%, 
                var(--color-info) 33%, 
                var(--color-secondary) 66%, 
                var(--color-success) 100%);
            background-size: 300% 100%;
            animation: shimmer 3s infinite linear;
            z-index: 1;
        }

        .analysis-step {
            position: relative;
            z-index: 2;
            text-align: center;
            flex: 1;
        }

        .step-indicator {
            width: 60px;
            height: 60px;
            background: white;
            border: 4px solid var(--color-bg-dark);
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            color: var(--color-text-muted);
            font-size: 1.3rem;
            transition: all var(--transition-base);
            box-shadow: var(--shadow-sm);
        }

        .analysis-step.active .step-indicator {
            background: linear-gradient(135deg, var(--color-primary), var(--color-info));
            color: white;
            border-color: transparent;
            transform: scale(1.2);
            box-shadow: 0 10px 25px rgba(26, 61, 124, 0.4);
        }

        .analysis-step.completed .step-indicator {
            background: var(--color-success);
            color: white;
            border-color: transparent;
        }

        .step-description {
            font-size: 0.95rem;
            font-weight: 700;
            color: var(--color-text-muted);
            transition: color var(--transition-base);
        }

        .analysis-step.active .step-description {
            color: var(--color-primary);
        }

        .analysis-step.completed .step-description {
            color: var(--color-success);
        }

        .analysis-form {
            background: white;
            border-radius: var(--radius-lg);
            padding: 30px;
            margin-top: 30px;
            box-shadow: var(--shadow-md);
        }

        .form-group {
            margin-bottom: 30px;
        }

        .form-label {
            display: block;
            margin-bottom: 15px;
            font-weight: 800;
            color: var(--color-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .form-label::before {
            content: '';
            width: 10px;
            height: 10px;
            background: var(--color-info);
            border-radius: 50%;
            display: block;
        }

        .form-input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .form-input {
            width: 100%;
            padding: 18px 25px;
            border: 2px solid var(--color-bg-dark);
            border-radius: var(--radius-md);
            font-size: 1.1rem;
            transition: all var(--transition-fast);
            background: var(--color-bg-light);
            font-family: inherit;
            font-weight: 500;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--color-info);
            box-shadow: 0 0 0 5px rgba(131, 128, 240, 0.1);
        }

        /* Enhanced State Plan Visualization */
        .state-plan-map {
            background: white;
            border-radius: var(--radius-lg);
            padding: 30px;
            margin: 40px 0;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
        }

        .map-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
        }

        .map-title {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--color-primary);
        }

        .map-legend {
            display: flex;
            gap: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        .map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .state-box {
            padding: 15px;
            border-radius: var(--radius-md);
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-fast);
            border: 2px solid transparent;
        }

        .state-box:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-sm);
        }

        .state-box.selected {
            border-color: var(--color-info);
            background: rgba(131, 128, 240, 0.05);
        }

        .state-name {
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 5px;
        }

        .state-status {
            font-size: 0.8rem;
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 10px;
        }

        .status-has-plan {
            background: rgba(0, 184, 148, 0.1);
            color: var(--color-success);
        }

        .status-no-plan {
            background: rgba(225, 112, 85, 0.1);
            color: var(--color-error);
        }

        /* Enhanced Action Buttons */
        .action-buttons {
            display: flex;
            gap: 25px;
            margin-top: 50px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 18px 36px;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 800;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all var(--transition-base);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            position: relative;
            overflow: hidden;
            min-width: 200px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--color-primary), var(--color-info));
            color: white;
            box-shadow: 0 10px 30px rgba(26, 61, 124, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-6px);
            box-shadow: 0 15px 40px rgba(26, 61, 124, 0.5);
        }

        .btn-secondary {
            background: white;
            color: var(--color-primary);
            border: 3px solid var(--color-primary-light);
        }

        .btn-secondary:hover {
            background: var(--color-primary);
            color: white;
            transform: translateY(-6px);
            box-shadow: var(--shadow-lg);
        }

        .btn-outline {
            background: transparent;
            color: var(--color-info);
            border: 3px solid var(--color-info);
        }

        .btn-outline:hover {
            background: var(--color-info);
            color: white;
            transform: translateY(-6px);
        }

        /* Enhanced Feedback Panel */
        .feedback-panel {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.98) 100%);
            backdrop-filter: blur(15px);
            border: 3px solid var(--color-success);
            border-radius: var(--radius-lg);
            padding: 35px;
            margin-top: 45px;
            display: none;
            animation: slideInRight 0.5s var(--transition-base);
            position: relative;
            overflow: hidden;
        }

        .feedback-panel.show {
            display: block;
        }

        .feedback-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(0, 184, 148, 0.05) 0%, transparent 100%);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            gap: 25px;
            margin-bottom: 25px;
            position: relative;
            z-index: 1;
        }

        .feedback-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--color-success), #26a69a);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
        }

        .feedback-title {
            font-size: 1.7rem;
            font-weight: 900;
            color: var(--color-success);
        }

        .feedback-content {
            line-height: 1.8;
            position: relative;
            z-index: 1;
        }

        .key-learning {
            background: linear-gradient(135deg, rgba(131, 128, 240, 0.05) 0%, rgba(175, 75, 239, 0.05) 100%);
            border-left: 6px solid var(--color-secondary);
            padding: 25px;
            margin: 25px 0;
            border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
        }

        /* Enhanced Objectives Panel */
        .objectives-panel {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.98) 100%);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-lg);
            padding: 35px;
            margin-top: 45px;
            box-shadow: var(--shadow-lg);
        }

        .objectives-list {
            list-style: none;
            padding-left: 0;
            display: grid;
            gap: 18px;
        }

        .objective-item {
            padding: 25px;
            background: var(--color-bg-light);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            gap: 25px;
            transition: all var(--transition-base);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .objective-item:hover {
            transform: translateX(12px);
            border-color: var(--color-info);
            box-shadow: var(--shadow-md);
        }

        .objective-item.completed {
            background: linear-gradient(135deg, rgba(0, 184, 148, 0.05) 0%, rgba(0, 184, 148, 0.1) 100%);
            border-color: rgba(0, 184, 148, 0.2);
        }

        .objective-item.completed::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 6px;
            background: var(--color-success);
        }

        .objective-checkbox {
            width: 36px;
            height: 36px;
            border: 3px solid var(--color-bg-dark);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex-shrink: 0;
            transition: all var(--transition-fast);
            background: white;
            font-weight: 900;
        }

        .objective-item:hover .objective-checkbox {
            border-color: var(--color-info);
        }

        .objective-item.completed .objective-checkbox {
            background: var(--color-success);
            border-color: var(--color-success);
            color: white;
        }

        .objective-text {
            flex: 1;
            font-weight: 600;
            color: var(--color-text);
            font-size: 1.05rem;
        }

        .objective-number {
            color: var(--color-secondary);
            font-weight: 900;
            margin-right: 12px;
            font-size: 1.1rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .brand-header {
                padding: 25px;
            }

            .brand-title {
                font-size: 2rem;
            }

            .dashboard {
                grid-template-columns: 1fr;
            }

            .simulation-content {
                padding: 30px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }

            .analysis-steps {
                flex-direction: column;
                gap: 35px;
                padding: 0;
            }

            .analysis-steps::before {
                display: none;
            }

            .analysis-step {
                display: flex;
                align-items: center;
                gap: 25px;
                text-align: left;
            }

            .step-indicator {
                margin: 0;
                flex-shrink: 0;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .comparison-row {
                grid-template-columns: 1fr;
            }

            .comparison-cell {
                padding: 15px;
            }

            .map-grid {
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            }
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="simulation-container">
        <!-- Enhanced Brand Header -->
        <header class="brand-header">
            <div class="brand-content">
                <div class="brand-logo-container">
                    <img src="https://cdn.prod.website-files.com/64d0ccc1558d601cbfb09021/64e9d2f719b1e5258e5d57f5_IMG_1512-p-500.png" 
                         alt="Brand Logo" class="brand-logo">
                    <div class="logo-badge">üè•</div>
                </div>
                <div class="brand-text">
                    <div class="module-tag">Disability Income Insurance Module</div>
                    <h1 class="brand-title">Disability Income Insurance & Benefit Programs</h1>
                    <div class="brand-subtitle">
                        <span class="subtitle-icon">üéØ</span>
                        Interactive Simulation for Disability Benefits Analysis
                    </div>
                </div>
            </div>
        </header>

        <!-- Enhanced Dashboard -->
        <div class="dashboard">
            <div class="stat-card" onclick="focusOnProgress()">
                <div class="stat-icon">üìä</div>
                <div class="stat-content">
                    <div>
                        <div class="stat-number" id="progress-percent">0%</div>
                        <div class="stat-label">Simulation Progress</div>
                    </div>
                    <div class="stat-trend">‚Üë</div>
                </div>
            </div>
            <div class="stat-card" onclick="showObjectives()">
                <div class="stat-icon">üéØ</div>
                <div class="stat-content">
                    <div>
                        <div class="stat-number" id="completed-objectives">0/13</div>
                        <div class="stat-label">Objectives Met</div>
                    </div>
                    <div class="stat-trend">‚Üë</div>
                </div>
            </div>
            <div class="stat-card" onclick="showFeedback()">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-content">
                    <div>
                        <div class="stat-number" id="correct-decisions">0</div>
                        <div class="stat-label">Correct Decisions</div>
                    </div>
                    <div class="stat-trend">‚Üë</div>
                </div>
            </div>
            <div class="stat-card" onclick="showTimeStats()">
                <div class="stat-icon">‚è±Ô∏è</div>
                <div class="stat-content">
                    <div>
                        <div class="stat-number" id="time-spent">00:00</div>
                        <div class="stat-label">Time Learning</div>
                    </div>
                    <div class="stat-trend">‚è≥</div>
                </div>
            </div>
        </div>

        <!-- Enhanced Progress Tracker -->
        <div class="progress-tracker">
            <div class="tracker-header">
                <div class="tracker-title">Benefits Analysis Journey</div>
                <div class="tracker-percent" id="tracker-text">0% Complete</div>
            </div>
            <div class="tracker-visual">
                <div class="tracker-bar">
                    <div class="tracker-fill" id="tracker-fill"></div>
                </div>
                <div class="tracker-milestones">
                    <div class="milestone">
                        <div class="milestone-dot"></div>
                        <div class="milestone-label">Case Assessment</div>
                    </div>
                    <div class="milestone">
                        <div class="milestone-dot"></div>
                        <div class="milestone-label">Program Comparison</div>
                    </div>
                    <div class="milestone">
                        <div class="milestone-dot active"></div>
                        <div class="milestone-label">SSDI vs SSI</div>
                    </div>
                    <div class="milestone">
                        <div class="milestone-dot"></div>
                        <div class="milestone-label">Benefit Calculation</div>
                    </div>
                    <div class="milestone">
                        <div class="milestone-dot"></div>
                        <div class="milestone-label">State Plans</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Simulation Area -->
        <div class="simulation-area">
            <!-- Enhanced Patient Profile -->
            <aside class="patient-profile">
                <div class="profile-header">
                    <div class="profile-avatar">SR</div>
                    <div class="profile-name">Sarah Rodriguez</div>
                    <div class="profile-occupation">
                        <i class="fas fa-user-md"></i>
                        Registered Nurse ‚Ä¢ 12 Years Experience
                    </div>
                    <div class="profile-badge">Disability Claim ‚Ä¢ Under Review</div>
                </div>
                <div class="profile-details">
                    <div class="detail-section">
                        <div class="section-title">
                            <i class="fas fa-user-circle"></i>
                            Personal Information
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Age</span>
                            <span class="detail-value">38</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Annual Income</span>
                            <span class="detail-value">$82,000</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Work Credits</span>
                            <span class="detail-value">40+ (Fully Insured)</span>
                        </div>
                    </div>

                    <div class="detail-section">
                        <div class="section-title">
                            <i class="fas fa-file-medical"></i>
                            Disability Details
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Date of Disability</span>
                            <span class="detail-value">02/15/2024</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Condition</span>
                            <span class="detail-value">Multiple Sclerosis</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Expected Duration</span>
                            <span class="detail-value">Long-term (>12 months)</span>
                        </div>
                    </div>

                    <div class="detail-section">
                        <div class="section-title">
                            <i class="fas fa-shield-alt"></i>
                            Current Coverage
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Employer LTD</span>
                            <span class="detail-value">
                                <span class="coverage-badge coverage-active">
                                    <i class="fas fa-check"></i>
                                    Active
                                </span>
                            </span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Individual DI Policy</span>
                            <span class="detail-value">
                                <span class="coverage-badge coverage-active">
                                    <i class="fas fa-check"></i>
                                    Active
                                </span>
                            </span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">State Disability</span>
                            <span class="detail-value">
                                <span class="coverage-badge coverage-none">
                                    <i class="fas fa-times"></i>
                                    Not Available (TX)
                                </span>
                            </span>
                        </div>
                    </div>
                </div>
                <button class="btn btn-outline" style="width: 100%; margin-top: 30px;" onclick="changePatientScenario()">
                    <i class="fas fa-user-friends"></i>
                    Load Different Case
                </button>
            </aside>

            <!-- Enhanced Simulation Content -->
            <main class="simulation-content">
                <div class="scenario-header">
                    <div class="scenario-number">1</div>
                    <div class="scenario-title">
                        Disability Benefits Analysis & Program Eligibility
                        <span class="scenario-tag">Complex Case Analysis</span>
                    </div>
                </div>

                <div class="scenario-description">
                    <p><strong>Case Overview:</strong> Sarah Rodriguez, a 38-year-old registered nurse diagnosed with Multiple Sclerosis, has become unable to work due to progressive neurological symptoms. She has 12 years of nursing experience, annual income of $82,000, and is fully insured with 40+ Social Security work credits.</p>
                    <p style="margin-top: 15px;"><strong>Your Role:</strong> As a disability benefits coordinator, analyze Sarah's eligibility for various disability programs, compare SSDI vs SSI, calculate potential benefits, and determine state-specific options.</p>
                    
                    <div class="learning-objective">
                        <strong>Primary Learning Objectives:</strong> Differentiate disability program types, understand SSDI vs SSI eligibility, calculate benefits, and analyze state disability insurance plans.
                    </div>
                </div>

                <!-- Enhanced Program Comparison -->
                <div class="interactive-section">
                    <div class="section-header">
                        <i class="fas fa-balance-scale"></i>
                        Step 1: Program Type Analysis
                    </div>
                    <div class="program-comparison">
                        <div class="comparison-question">Based on Sarah's professional background and disability duration, which disability insurance program is most appropriate?</div>
                        <div class="comparison-grid">
                            <div class="program-card" onclick="selectProgram(this, 'ltd')">
                                <div class="program-icon">üìã</div>
                                <div class="program-name">Long-Term Disability (LTD)</div>
                                <div class="program-desc">Group or individual coverage for disabilities lasting beyond short-term periods</div>
                                <div class="program-features">
                                    <div class="feature-item">
                                        <i class="fas fa-check-circle"></i>
                                        Typically 50-70% of pre-disability earnings
                                    </div>
                                    <div class="feature-item">
                                        <i class="fas fa-check-circle"></i>
                                        90-180 day waiting period
                                    </div>
                                    <div class="feature-item">
                                        <i class="fas fa-check-circle"></i>
                                        Can last to age 65 or lifetime
                                    </div>
                                </div>
                            </div>
                            <div class="program-card" onclick="selectProgram(this, 'std')">
                                <div class="program-icon">‚è∞</div>
                                <div class="program-name">Short-Term Disability (STD)</div>
                                <div class="program-desc">Temporary coverage for disabilities lasting weeks to months</div>
                                <div class="program-features">
                                    <div class="feature-item">
                                        <i class="fas fa-check-circle"></i>
                                        0-14 day waiting period
                                    </div>
                                    <div class="feature-item">
                                        <i class="fas fa-check-circle"></i>
                                        Typically 3-6 months duration
                                    </div>
                                    <div class="feature-item">
                                        <i class="fas fa-check-circle"></i>
                                        60-70% of salary replacement
                                    </div>
                                </div>
                            </div>
                            <div class="program-card" onclick="selectProgram(this, 'ssdi')">
                                <div class="program-icon">üèõÔ∏è</div>
                                <div class="program-name">Social Security Disability (SSDI)</div>
                                <div class="program-desc">Federal program for long-term total disabilities</div>
                                <div class="program-features">
                                    <div class="feature-item">
                                        <i class="fas fa-check-circle"></i>
                                        5-month waiting period
                                    </div>
                                    <div class="feature-item">
                                        <i class="fas fa-check-circle"></i>
                                        Based on work credits
                                    </div>
                                    <div class="feature-item">
                                        <i class="fas fa-check-circle"></i>
                                        Medicare after 24 months
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced SSDI vs SSI Comparison -->
                <div class="interactive-section">
                    <div class="section-header">
                        <i class="fas fa-columns"></i>
                        Step 2: SSDI vs SSI Comparison
                    </div>
                    <div class="ssdi-ssi-comparison">
                        <p style="margin-bottom: 25px; color: var(--color-text-light);">Select the correct statements about SSDI and SSI programs based on Sarah's situation:</p>
                        <div class="comparison-table">
                            <div class="comparison-row header">
                                <div class="comparison-cell">
                                    <i class="fas fa-question-circle cell-icon"></i>
                                    Characteristic
                                </div>
                                <div class="comparison-cell">
                                    <i class="fas fa-landmark cell-icon"></i>
                                    SSDI
                                </div>
                                <div class="comparison-cell">
                                    <i class="fas fa-hand-holding-usd cell-icon"></i>
                                    SSI
                                </div>
                            </div>
                            
                            <div class="comparison-row">
                                <div class="comparison-cell dim">
                                    <i class="fas fa-user-check"></i>
                                    Eligibility Basis
                                </div>
                                <div class="comparison-cell">
                                    <label class="checkbox-container" style="display: block; text-align: left;">
                                        <input type="checkbox" class="ssdi-fact" value="work_credits">
                                        <span class="checkbox-label">Work credits & insured status</span>
                                        <span class="checkmark"></span>
                                    </label>
                                </div>
                                <div class="comparison-cell">
                                    <label class="checkbox-container" style="display: block; text-align: left;">
                                        <input type="checkbox" class="ssi-fact" value="financial_need">
                                        <span class="checkbox-label">Financial need & disability</span>
                                        <span class="checkmark"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="comparison-row">
                                <div class="comparison-cell dim">
                                    <i class="fas fa-money-check-alt"></i>
                                    Funding Source
                                </div>
                                <div class="comparison-cell">
                                    <label class="checkbox-container" style="display: block; text-align: left;">
                                        <input type="checkbox" class="ssdi-fact" value="social_security">
                                        <span class="checkbox-label">Social Security Trust Fund</span>
                                        <span class="checkmark"></span>
                                    </label>
                                </div>
                                <div class="comparison-cell">
                                    <label class="checkbox-container" style="display: block; text-align: left;">
                                        <input type="checkbox" class="ssi-fact" value="general_funds">
                                        <span class="checkbox-label">General tax revenues</span>
                                        <span class="checkmark"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="comparison-row">
                                <div class="comparison-cell dim">
                                    <i class="fas fa-calendar-alt"></i>
                                    Waiting Period
                                </div>
                                <div class="comparison-cell highlight">
                                    <label class="checkbox-container" style="display: block; text-align: left;">
                                        <input type="checkbox" class="ssdi-fact" value="5_month_wait">
                                        <span class="checkbox-label">5 full calendar months</span>
                                        <span class="checkmark"></span>
                                    </label>
                                </div>
                                <div class="comparison-cell">
                                    <label class="checkbox-container" style="display: block; text-align: left;">
                                        <input type="checkbox" class="ssi-fact" value="immediate">
                                        <span class="checkbox-label">First full month of eligibility</span>
                                        <span class="checkmark"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="comparison-row">
                                <div class="comparison-cell dim">
                                    <i class="fas fa-heartbeat"></i>
                                    Medicare/Medicaid
                                </div>
                                <div class="comparison-cell">
                                    <label class="checkbox-container" style="display: block; text-align: left;">
                                        <input type="checkbox" class="ssdi-fact" value="medicare_24">
                                        <span class="checkbox-label">Medicare after 24 months</span>
                                        <span class="checkmark"></span>
                                    </label>
                                </div>
                                <div class="comparison-cell highlight">
                                    <label class="checkbox-container" style="display: block; text-align: left;">
                                        <input type="checkbox" class="ssi-fact" value="immediate_medicaid">
                                        <span class="checkbox-label">Immediate Medicaid eligibility</span>
                                        <span class="checkmark"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Benefit Analysis -->
                <div class="interactive-section">
                    <div class="section-header">
                        <i class="fas fa-calculator"></i>
                        Step 3: Benefit Calculation & Offset Analysis
                    </div>
                    <div class="benefit-analysis">
                        <p style="margin-bottom: 30px; color: var(--color-primary); font-weight: 700; font-size: 1.1rem;">Calculate Sarah's potential disability benefits and understand coordination of benefits:</p>
                        
                        <div class="analysis-steps">
                            <div class="analysis-step active" id="analysis-step1">
                                <div class="step-indicator">1</div>
                                <div class="step-description">Calculate SSDI Primary Insurance Amount (PIA)</div>
                            </div>
                            <div class="analysis-step" id="analysis-step2">
                                <div class="step-indicator">2</div>
                                <div class="step-description">Determine LTD Benefit Amount</div>
                            </div>
                            <div class="analysis-step" id="analysis-step3">
                                <div class="step-indicator">3</div>
                                <div class="step-description">Calculate Benefit Offsets</div>
                            </div>
                            <div class="analysis-step" id="analysis-step4">
                                <div class="step-indicator">4</div>
                                <div class="step-description">Total Combined Benefits</div>
                            </div>
                        </div>

                        <div class="analysis-form">
                            <div class="form-group">
                                <label class="form-label">Average Indexed Monthly Earnings (AIME)</label>
                                <div class="form-input-group">
                                    <input type="number" class="form-input" id="monthly-earnings" value="6833" placeholder="Enter monthly earnings" onchange="updateBenefitCalculation()">
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <span style="font-weight: 600; color: var(--color-text-light);">SSDI Formula:</span>
                                        <span style="background: var(--color-bg-dark); padding: 10px 20px; border-radius: var(--radius-sm); font-weight: 700; color: var(--color-primary);">
                                            90% of first $1,174 + 32% of next $5,909 + 15% of remainder
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Employer LTD Coverage Percentage</label>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                                    <label class="checkbox-container" style="display: block; padding: 15px; border: 2px solid var(--color-bg-dark); border-radius: var(--radius-md);">
                                        <input type="radio" name="ltd-percentage" value="60" checked onchange="updateBenefitCalculation()">
                                        <span class="checkbox-label" style="padding-right: 40px;">60% (Standard)</span>
                                        <span class="checkmark"></span>
                                    </label>
                                    <label class="checkbox-container" style="display: block; padding: 15px; border: 2px solid var(--color-bg-dark); border-radius: var(--radius-md);">
                                        <input type="radio" name="ltd-percentage" value="66" onchange="updateBenefitCalculation()">
                                        <span class="checkbox-label" style="padding-right: 40px;">66.67% (Common)</span>
                                        <span class="checkmark"></span>
                                    </label>
                                    <label class="checkbox-container" style="display: block; padding: 15px; border: 2px solid var(--color-bg-dark); border-radius: var(--radius-md);">
                                        <input type="radio" name="ltd-percentage" value="50" onchange="updateBenefitCalculation()">
                                        <span class="checkbox-label" style="padding-right: 40px;">50% (Basic)</span>
                                        <span class="checkmark"></span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Individual Disability Insurance Monthly Benefit</label>
                                <input type="number" class="form-input" id="individual-di" value="2000" placeholder="Enter monthly IDI benefit" onchange="updateBenefitCalculation()">
                            </div>

                            <div id="benefit-summary" style="background: linear-gradient(135deg, rgba(0, 184, 148, 0.05) 0%, rgba(0, 184, 148, 0.1) 100%); padding: 25px; border-radius: var(--radius-md); border-left: 4px solid var(--color-success); margin-top: 20px;">
                                <h3 style="color: var(--color-success); margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-file-invoice-dollar"></i>
                                    Calculated Benefit Summary
                                </h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                                    <div>
                                        <div style="font-size: 0.9rem; color: var(--color-text-muted); margin-bottom: 5px;">Monthly SSDI Benefit</div>
                                        <div style="font-size: 1.8rem; font-weight: 900; color: var(--color-primary);" id="ssdi-benefit">$2,850</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.9rem; color: var(--color-text-muted); margin-bottom: 5px;">Monthly LTD Benefit</div>
                                        <div style="font-size: 1.8rem; font-weight: 900; color: var(--color-info);" id="ltd-benefit">$4,100</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.9rem; color: var(--color-text-muted); margin-bottom: 5px;">Offset Reduction</div>
                                        <div style="font-size: 1.8rem; font-weight: 900; color: var(--color-warning);" id="offset-amount">-$2,850</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.9rem; color: var(--color-text-muted); margin-bottom: 5px;">Total Monthly Income</div>
                                        <div style="font-size: 1.8rem; font-weight: 900; color: var(--color-success);" id="total-income">$6,100</div>
                                    </div>
                                </div>
                                <div style="margin-top: 20px; padding: 15px; background: rgba(131, 128, 240, 0.05); border-radius: var(--radius-sm);">
                                    <div style="font-size: 0.9rem; color: var(--color-text-muted);">
                                        <strong>Note:</strong> Most LTD policies reduce benefits by SSDI amounts (integration/offset provision). Individual DI typically pays on top without reduction.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced State Plan Visualization -->
                <div class="interactive-section">
                    <div class="section-header">
                        <i class="fas fa-map-marked-alt"></i>
                        Step 4: State Disability Insurance Plans
                    </div>
                    <div class="state-plan-map">
                        <div class="map-header">
                            <div class="map-title">State Disability Insurance (SDI) Coverage Map</div>
                            <div class="map-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background: var(--color-success);"></div>
                                    <span>Has SDI Program</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: var(--color-error);"></div>
                                    <span>No SDI Program</span>
                                </div>
                            </div>
                        </div>
                        <p style="margin-bottom: 20px; color: var(--color-text-light);">Select states to compare their disability insurance programs (Sarah resides in Texas):</p>
                        <div class="map-grid">
                            <!-- States with SDI Programs -->
                            <div class="state-box" onclick="selectState(this, 'CA')" style="background: rgba(0, 184, 148, 0.1);">
                                <div class="state-name">California</div>
                                <div class="state-status status-has-plan">SDI Program</div>
                            </div>
                            <div class="state-box" onclick="selectState(this, 'NY')" style="background: rgba(0, 184, 148, 0.1);">
                                <div class="state-name">New York</div>
                                <div class="state-status status-has-plan">DBL Program</div>
                            </div>
                            <div class="state-box" onclick="selectState(this, 'NJ')" style="background: rgba(0, 184, 148, 0.1);">
                                <div class="state-name">New Jersey</div>
                                <div class="state-status status-has-plan">TDI Program</div>
                            </div>
                            <div class="state-box" onclick="selectState(this, 'RI')" style="background: rgba(0, 184, 148, 0.1);">
                                <div class="state-name">Rhode Island</div>
                                <div class="state-status status-has-plan">TDI Program</div>
                            </div>
                            <div class="state-box" onclick="selectState(this, 'HI')" style="background: rgba(0, 184, 148, 0.1);">
                                <div class="state-name">Hawaii</div>
                                <div class="state-status status-has-plan">TDI Program</div>
                            </div>
                            <!-- States without SDI Programs -->
                            <div class="state-box" onclick="selectState(this, 'TX')" style="background: rgba(225, 112, 85, 0.1);">
                                <div class="state-name">Texas</div>
                                <div class="state-status status-no-plan">No SDI</div>
                            </div>
                            <div class="state-box" onclick="selectState(this, 'FL')" style="background: rgba(225, 112, 85, 0.1);">
                                <div class="state-name">Florida</div>
                                <div class="state-status status-no-plan">No SDI</div>
                            </div>
                            <div class="state-box" onclick="selectState(this, 'IL')" style="background: rgba(225, 112, 85, 0.1);">
                                <div class="state-name">Illinois</div>
                                <div class="state-status status-no-plan">No SDI</div>
                            </div>
                        </div>
                        
                        <div id="state-details" style="margin-top: 25px; padding: 20px; background: var(--color-bg); border-radius: var(--radius-md); display: none;">
                            <h4 style="color: var(--color-primary); margin-bottom: 15px;" id="state-title">State Details</h4>
                            <div id="state-description"></div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Action Buttons -->
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="processAnalysis()">
                        <i class="fas fa-check-double"></i>
                        Complete Benefits Analysis
                    </button>
                    <button class="btn btn-secondary" onclick="resetAnalysis()">
                        <i class="fas fa-redo"></i>
                        Reset Simulation
                    </button>
                    <button class="btn btn-outline" onclick="showProgramGuidance()">
                        <i class="fas fa-life-ring"></i>
                        Program Guidance
                    </button>
                </div>

                <!-- Enhanced Feedback Panel -->
                <div class="feedback-panel" id="feedback-panel">
                    <div class="feedback-header">
                        <div class="feedback-icon">üìà</div>
                        <div class="feedback-title">Benefits Analysis Report</div>
                    </div>
                    <div class="feedback-content" id="feedback-content">
                        <!-- Feedback will be inserted here -->
                    </div>
                </div>

                <!-- Enhanced Learning Objectives -->
                <div class="objectives-panel">
                    <div class="section-header">
                        <i class="fas fa-bullseye"></i>
                        Chapter Learning Objectives
                    </div>
                    <ul class="objectives-list" id="objectives-list">
                        <!-- Objectives will be populated by JavaScript -->
                    </ul>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Simulation State
        const simulationState = {
            currentCase: 1,
            completedObjectives: 0,
            correctDecisions: 0,
            totalObjectives: 13,
            startTime: new Date(),
            selectedProgram: null,
            ssdiFactsCorrect: false,
            ssiFactsCorrect: false,
            benefitCalculationCorrect: false,
            currentScenario: 'nurse'
        };

        // State SDI Program Data
        const stateSDIPrograms = {
            'CA': {
                name: 'California',
                program: 'State Disability Insurance (SDI)',
                details: 'Provides up to 52 weeks of benefits at 60-70% of wages. Funded through employee payroll deductions. Weekly benefit range: $50-$1,620.',
                waitingPeriod: '7-day non-payable waiting period',
                maxDuration: '52 weeks',
                funding: 'Employee payroll taxes',
                benefitRate: '60-70% of wages'
            },
            'NY': {
                name: 'New York',
                program: 'Disability Benefits Law (DBL)',
                details: 'Employer-paid insurance providing 26 weeks of benefits at 50% of average weekly wage, max $170/week. Coverage required for most employers.',
                waitingPeriod: '7-day waiting period',
                maxDuration: '26 weeks',
                funding: 'Employer-paid insurance',
                benefitRate: '50% of AWW, max $170'
            },
            'NJ': {
                name: 'New Jersey',
                program: 'Temporary Disability Insurance (TDI)',
                details: 'Provides up to 26 weeks of benefits at 85% of weekly wage, max $1,025/week (2024). Funded through employee/employer contributions.',
                waitingPeriod: '7-day waiting period',
                maxDuration: '26 weeks',
                funding: 'Employee/employer payroll taxes',
                benefitRate: '85% of wages, max $1,025'
            },
            'RI': {
                name: 'Rhode Island',
                program: 'Temporary Disability Insurance (TDI)',
                details: 'Provides 30 weeks of benefits at 4.62% of highest quarter wages. Funded through employee payroll deductions.',
                waitingPeriod: '7-day waiting period',
                maxDuration: '30 weeks',
                funding: 'Employee payroll taxes',
                benefitRate: '4.62% of highest quarter wages'
            },
            'HI': {
                name: 'Hawaii',
                program: 'Temporary Disability Insurance (TDI)',
                details: 'Provides 26 weeks of benefits at 58% of average weekly wage. Mandatory for most private employers.',
                waitingPeriod: '7-day waiting period',
                maxDuration: '26 weeks',
                funding: 'Employer-paid insurance',
                benefitRate: '58% of AWW'
            },
            'TX': {
                name: 'Texas',
                program: 'No State Program',
                details: 'Texas does not have a state-mandated disability insurance program. Residents must rely on employer-sponsored plans, individual policies, or federal programs.',
                waitingPeriod: 'N/A',
                maxDuration: 'N/A',
                funding: 'N/A',
                benefitRate: 'N/A'
            }
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeSimulation();
            startTimer();
            populateObjectives();
            updateProgress();
            setupInteractions();
            updateBenefitCalculation(); // Initial calculation
        });

        function initializeSimulation() {
            updateMilestone(3); // Start at SSDI vs SSI comparison
            setupAnalysisSteps();
        }

        function setupInteractions() {
            // Add hover effects
            document.querySelectorAll('.program-card, .state-box, .btn').forEach(el => {
                el.addEventListener('mouseenter', () => {
                    if (!el.classList.contains('selected')) {
                        el.style.transform = 'translateY(-6px)';
                    }
                });
                el.addEventListener('mouseleave', () => {
                    if (!el.classList.contains('selected')) {
                        el.style.transform = 'translateY(0)';
                    }
                });
            });

            // Setup SSDI/SSI fact checkboxes
            document.querySelectorAll('.ssdi-fact, .ssi-fact').forEach(cb => {
                cb.addEventListener('change', function() {
                    const container = this.closest('.comparison-cell');
                    if (this.checked) {
                        container.style.background = 'rgba(0, 184, 148, 0.05)';
                        container.style.borderLeft = '4px solid var(--color-success)';
                    } else {
                        container.style.background = '';
                        container.style.borderLeft = '';
                    }
                    checkSSDI_SSIFacts();
                });
            });
        }

        function setupAnalysisSteps() {
            const monthlyEarnings = document.getElementById('monthly-earnings');
            monthlyEarnings.addEventListener('input', function() {
                if (this.value) {
                    document.getElementById('analysis-step2').classList.add('active');
                }
            });

            document.querySelectorAll('input[name="ltd-percentage"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    document.getElementById('analysis-step3').classList.add('active');
                });
            });

            const individualDI = document.getElementById('individual-di');
            individualDI.addEventListener('input', function() {
                if (this.value) {
                    document.getElementById('analysis-step4').classList.add('active');
                }
            });
        }

        function updateMilestone(step) {
            const milestones = document.querySelectorAll('.milestone');
            milestones.forEach((milestone, index) => {
                milestone.classList.remove('active', 'completed');
                if (index < step - 1) {
                    milestone.classList.add('completed');
                } else if (index === step - 1) {
                    milestone.classList.add('active');
                }
            });
        }

        function selectProgram(element, type) {
            document.querySelectorAll('.program-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            element.classList.add('selected');
            simulationState.selectedProgram = type;
            
            // Determine if correct (LTD is most appropriate for long-term disability)
            simulationState.programCorrect = type === 'ltd';
            
            // Animate selection
            animateSelection(element);
            
            // Update milestone
            updateMilestone(2);
            updateProgress();
        }

        function checkSSDI_SSIFacts() {
            const ssdiChecked = document.querySelectorAll('.ssdi-fact:checked');
            const ssiChecked = document.querySelectorAll('.ssi-fact:checked');
            
            // All SSDI facts should be checked (all are correct)
            simulationState.ssdiFactsCorrect = ssdiChecked.length === 4;
            
            // All SSI facts should be checked (all are correct)
            simulationState.ssiFactsCorrect = ssiChecked.length === 4;
            
            updateMilestone(3);
            updateProgress();
        }

        function updateBenefitCalculation() {
            const monthlyEarnings = parseFloat(document.getElementById('monthly-earnings').value) || 6833;
            const ltdPercentage = parseFloat(document.querySelector('input[name="ltd-percentage"]:checked').value) / 100;
            const individualDI = parseFloat(document.getElementById('individual-di').value) || 2000;
            
            // Calculate SSDI using 2024 bend points
            const bendPoint1 = 1174;
            const bendPoint2 = 1174 + 5909; // First bend point + second segment
            
            let pia = 0;
            if (monthlyEarnings <= bendPoint1) {
                pia = monthlyEarnings * 0.9;
            } else if (monthlyEarnings <= bendPoint2) {
                pia = (bendPoint1 * 0.9) + ((monthlyEarnings - bendPoint1) * 0.32);
            } else {
                pia = (bendPoint1 * 0.9) + (5909 * 0.32) + ((monthlyEarnings - bendPoint2) * 0.15);
            }
            
            // Calculate LTD benefit (pre-offset)
            const ltdPreOffset = monthlyEarnings * ltdPercentage;
            
            // Apply SSDI offset to LTD (common provision)
            const ltdPostOffset = Math.max(0, ltdPreOffset - pia);
            
            // Total monthly income
            const totalIncome = pia + ltdPostOffset + individualDI;
            
            // Update display
            document.getElementById('ssdi-benefit').textContent = `$${pia.toFixed(0)}`;
            document.getElementById('ltd-benefit').textContent = `$${ltdPreOffset.toFixed(0)}`;
            document.getElementById('offset-amount').textContent = `-$${Math.min(pia, ltdPreOffset).toFixed(0)}`;
            document.getElementById('total-income').textContent = `$${totalIncome.toFixed(0)}`;
            
            // Check if calculation is reasonable
            simulationState.benefitCalculationCorrect = pia > 2000 && pia < 4000;
            
            // Update milestone
            updateMilestone(4);
            updateProgress();
        }

        function selectState(element, stateCode) {
            document.querySelectorAll('.state-box').forEach(box => {
                box.classList.remove('selected');
            });
            
            element.classList.add('selected');
            
            const state = stateSDIPrograms[stateCode];
            const detailsDiv = document.getElementById('state-details');
            const titleDiv = document.getElementById('state-title');
            const descriptionDiv = document.getElementById('state-description');
            
            titleDiv.textContent = `${state.name} Disability Insurance`;
            
            descriptionDiv.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div style="background: white; padding: 15px; border-radius: var(--radius-sm);">
                        <div style="font-size: 0.9rem; color: var(--color-text-muted);">Program Type</div>
                        <div style="font-weight: 700; color: var(--color-primary);">${state.program}</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: var(--radius-sm);">
                        <div style="font-size: 0.9rem; color: var(--color-text-muted);">Waiting Period</div>
                        <div style="font-weight: 700; color: var(--color-info);">${state.waitingPeriod}</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: var(--radius-sm);">
                        <div style="font-size: 0.9rem; color: var(--color-text-muted);">Maximum Duration</div>
                        <div style="font-weight: 700; color: var(--color-success);">${state.maxDuration}</div>
                    </div>
                </div>
                <div style="background: ${stateCode === 'TX' ? 'rgba(225, 112, 85, 0.05)' : 'rgba(0, 184, 148, 0.05)'}; padding: 15px; border-radius: var(--radius-sm); border-left: 4px solid ${stateCode === 'TX' ? 'var(--color-error)' : 'var(--color-success)'};">
                    <strong style="color: ${stateCode === 'TX' ? 'var(--color-error)' : 'var(--color-success)'};">Key Details:</strong>
                    <p style="margin: 10px 0 0 0; color: var(--color-text);">${state.details}</p>
                </div>
            `;
            
            detailsDiv.style.display = 'block';
            
            // Update milestone
            updateMilestone(5);
            updateProgress();
        }

        function processAnalysis() {
            // Calculate score
            let score = 0;
            let feedback = [];
            
            if (simulationState.programCorrect) {
                score++;
                feedback.push({
                    icon: '‚úÖ',
                    title: 'Program Selection',
                    message: 'Correct! Long-Term Disability (LTD) is most appropriate for Sarah\'s long-term condition.',
                    type: 'success'
                });
            } else {
                feedback.push({
                    icon: '‚ùå',
                    title: 'Program Selection',
                    message: 'LTD is typically most appropriate for disabilities expected to last beyond short-term periods.',
                    type: 'error'
                });
            }
            
            if (simulationState.ssdiFactsCorrect && simulationState.ssiFactsCorrect) {
                score += 2;
                feedback.push({
                    icon: '‚úÖ',
                    title: 'SSDI vs SSI Understanding',
                    message: 'Excellent! You correctly identified all key differences between SSDI and SSI programs.',
                    type: 'success'
                });
            } else {
                feedback.push({
                    icon: '‚ùå',
                    title: 'SSDI vs SSI Understanding',
                    message: 'SSDI is based on work credits and funded by Social Security taxes. SSI is based on financial need and funded by general revenues.',
                    type: 'error'
                });
            }
            
            if (simulationState.benefitCalculationCorrect) {
                score++;
                feedback.push({
                    icon: '‚úÖ',
                    title: 'Benefit Calculation',
                    message: 'Good calculation! You correctly applied SSDI bend points and understood LTD integration provisions.',
                    type: 'success'
                });
            } else {
                feedback.push({
                    icon: '‚ùå',
                    title: 'Benefit Calculation',
                    message: 'SSDI uses a three-tier formula with bend points. Most LTD policies offset benefits by SSDI amounts.',
                    type: 'error'
                });
            }

            // Update stats
            simulationState.correctDecisions += score;
            const newObjectives = Math.min(Math.ceil(score / 4 * 13), 5);
            simulationState.completedObjectives = Math.min(simulationState.totalObjectives, 
                simulationState.completedObjectives + newObjectives);

            // Show feedback
            const feedbackPanel = document.getElementById('feedback-panel');
            const feedbackContent = document.getElementById('feedback-content');
            
            const maxScore = 4;
            const scoreColor = score >= 3 ? 'var(--color-success)' : score >= 2 ? 'var(--color-warning)' : 'var(--color-error)';
            const scoreEmoji = score >= 3 ? 'üèÜ' : score >= 2 ? 'üëç' : 'üìö';
            const scoreMessage = score >= 3 ? 
                'Excellent analysis! You demonstrate strong understanding of disability income programs.' :
                score >= 2 ? 'Good work! Review the missed concepts for comprehensive understanding.' :
                'Review key concepts and try again. Understanding disability programs is crucial.';
            
            feedbackContent.innerHTML = `
                <div style="background: linear-gradient(135deg, ${score >= 3 ? 'rgba(0, 184, 148, 0.1)' : score >= 2 ? 'rgba(245, 158, 11, 0.1)' : 'rgba(225, 112, 85, 0.1)'} 0%, transparent 100%); 
                            padding: 30px; border-radius: 15px; margin-bottom: 30px; border: 3px solid ${scoreColor};">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
                        <div>
                            <h3 style="margin: 0 0 10px 0; color: ${scoreColor}; font-size: 1.5rem;">Analysis Score: ${score}/${maxScore}</h3>
                            <p style="margin: 0; color: var(--color-text-light); font-size: 1.1rem;">${scoreMessage}</p>
                        </div>
                        <div style="font-size: 4rem; color: ${scoreColor};">${scoreEmoji}</div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-top: 20px;">
                        <div style="text-align: center; padding: 15px; background: white; border-radius: 10px;">
                            <div style="font-size: 1.5rem; font-weight: 900; color: var(--color-primary);">${simulationState.correctDecisions}</div>
                            <div style="font-size: 0.9rem; color: var(--color-text-muted);">Total Correct</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: white; border-radius: 10px;">
                            <div style="font-size: 1.5rem; font-weight: 900; color: var(--color-secondary);">${simulationState.completedObjectives}</div>
                            <div style="font-size: 0.9rem; color: var(--color-text-muted);">Objectives Met</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: white; border-radius: 10px;">
                            <div style="font-size: 1.5rem; font-weight: 900; color: var(--color-info);">${Math.round((score/maxScore)*100)}%</div>
                            <div style="font-size: 0.9rem; color: var(--color-text-muted);">Accuracy Rate</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: white; border-radius: 10px;">
                            <div style="font-size: 1.5rem; font-weight: 900; color: var(--color-success);">${simulationState.totalObjectives - simulationState.completedObjectives}</div>
                            <div style="font-size: 0.9rem; color: var(--color-text-muted);">Objectives Remaining</div>
                        </div>
                    </div>
                </div>
                
                <div class="key-learning">
                    <strong style="display: block; margin-bottom: 15px; color: var(--color-secondary); font-size: 1.1rem;">üéì Key Learning Points from this Analysis:</strong>
                    <ul style="margin: 0; padding-left: 25px; font-size: 1.05rem;">
                        <li><strong>SSDI:</strong> Based on work credits, 5-month waiting period, Medicare after 24 months</li>
                        <li><strong>SSI:</strong> Based on financial need, immediate benefits, includes Medicaid</li>
                        <li><strong>LTD:</strong> Typically 50-70% of pre-disability earnings, offsets with SSDI</li>
                        <li><strong>State Programs:</strong> Only 5 states have mandatory programs (CA, NY, NJ, RI, HI)</li>
                        <li><strong>Benefit Coordination:</strong> Most policies coordinate to prevent overinsurance</li>
                        <li><strong>Waiting Periods:</strong> Vary by program (SSDI: 5 months, STD: 0-14 days, LTD: 90-180 days)</li>
                    </ul>
                </div>
                
                <div style="margin-top: 30px;">
                    <h4 style="color: var(--color-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-clipboard-list"></i>
                        Detailed Feedback
                    </h4>
                    ${feedback.map(f => `
                        <div style="display: flex; gap: 20px; margin-bottom: 20px; padding: 20px; background: ${f.type === 'success' ? 'rgba(0, 184, 148, 0.05)' : 'rgba(225, 112, 85, 0.05)'}; border-radius: 12px; border-left: 5px solid ${f.type === 'success' ? 'var(--color-success)' : 'var(--color-error)'};">
                            <div style="font-size: 1.8rem; flex-shrink: 0;">${f.icon}</div>
                            <div>
                                <div style="font-weight: 800; color: ${f.type === 'success' ? 'var(--color-success)' : 'var(--color-error)'}; margin-bottom: 8px; font-size: 1.1rem;">${f.title}</div>
                                <div style="color: var(--color-text); line-height: 1.6;">${f.message}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            feedbackPanel.classList.add('show');
            
            // Update progress and objectives
            updateProgress();
            updateObjectives();
            
            // Mark all steps as completed
            document.querySelectorAll('.analysis-step').forEach(step => {
                step.classList.add('completed');
            });
            
            // Update milestone to completed
            updateMilestone(5);
            
            // Show notification
            showNotification(`Analysis complete! Score: ${score}/${maxScore}`, score >= 3 ? 'success' : score >= 2 ? 'warning' : 'error');
            
            // Scroll to feedback
            setTimeout(() => {
                feedbackPanel.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 300);
        }

        function resetAnalysis() {
            // Reset all selections
            document.querySelectorAll('.program-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            document.querySelectorAll('.state-box').forEach(box => {
                box.classList.remove('selected');
            });
            
            document.querySelectorAll('.ssdi-fact, .ssi-fact').forEach(cb => {
                cb.checked = false;
                const container = cb.closest('.comparison-cell');
                container.style.background = '';
                container.style.borderLeft = '';
            });
            
            // Reset form values
            document.getElementById('monthly-earnings').value = '6833';
            document.getElementById('individual-di').value = '2000';
            document.querySelector('input[name="ltd-percentage"][value="60"]').checked = true;
            
            // Hide state details
            document.getElementById('state-details').style.display = 'none';
            
            // Reset analysis steps
            document.querySelectorAll('.analysis-step').forEach(step => {
                step.classList.remove('active', 'completed');
            });
            document.getElementById('analysis-step1').classList.add('active');
            
            // Reset milestone
            updateMilestone(1);
            
            // Hide feedback
            document.getElementById('feedback-panel').classList.remove('show');
            
            // Reset state
            simulationState.selectedProgram = null;
            simulationState.ssdiFactsCorrect = false;
            simulationState.ssiFactsCorrect = false;
            simulationState.benefitCalculationCorrect = false;
            
            // Update calculation
            updateBenefitCalculation();
            
            updateProgress();
            
            // Show notification
            showNotification('Analysis simulation reset', 'info');
        }

        function changePatientScenario() {
            const scenarios = ['nurse', 'teacher', 'construction'];
            const currentIndex = scenarios.indexOf(simulationState.currentScenario);
            const nextIndex = (currentIndex + 1) % scenarios.length;
            simulationState.currentScenario = scenarios[nextIndex];
            
            // In a full implementation, this would load different patient data
            showNotification(`Loaded ${simulationState.currentScenario} professional case`, 'info');
            resetAnalysis();
        }

        function showProgramGuidance() {
            const guidance = document.createElement('div');
            guidance.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(255, 255, 255, 0.95) 100%);
                padding: 35px;
                border-radius: var(--radius-lg);
                box-shadow: var(--shadow-xl);
                z-index: 1000;
                max-width: 650px;
                width: 90%;
                border: 3px solid var(--color-info);
                backdrop-filter: blur(20px);
            `;
            
            guidance.innerHTML = `
                <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 25px;">
                    <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--color-info), var(--color-secondary)); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-size: 1.8rem; color: white;">
                        <i class="fas fa-university"></i>
                    </div>
                    <div>
                        <h3 style="margin: 0; color: var(--color-primary); font-size: 1.5rem;">Disability Program Guidance</h3>
                        <p style="margin: 5px 0 0 0; color: var(--color-text-light); font-size: 1rem;">Understanding key disability income programs</p>
                    </div>
                </div>
                
                <div style="background: rgba(131, 128, 240, 0.05); padding: 25px; border-radius: var(--radius-md); margin-bottom: 25px; border-left: 4px solid var(--color-info);">
                    <strong style="color: var(--color-info); display: block; margin-bottom: 15px; font-size: 1.1rem;">
                        <i class="fas fa-lightbulb"></i>
                        Core Disability Program Concepts:
                    </strong>
                    <ul style="margin: 0; padding-left: 25px; color: var(--color-text); font-size: 1.05rem; line-height: 1.8;">
                        <li><strong>SSDI:</strong> Social Security program for workers with sufficient work credits</li>
                        <li><strong>SSI:</strong> Needs-based program for disabled individuals with limited income/resources</li>
                        <li><strong>LTD:</strong> Employer-sponsored coverage for long-term disabilities</li>
                        <li><strong>STD:</strong> Short-term coverage (typically 3-6 months)</li>
                        <li><strong>State Programs:</strong> Only 5 states have mandatory programs</li>
                        <li><strong>Integration:</strong> Most policies coordinate benefits to prevent duplication</li>
                    </ul>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 25px;">
                    <div style="background: rgba(0, 184, 148, 0.05); padding: 15px; border-radius: var(--radius-md);">
                        <div style="font-weight: 700; color: var(--color-success); margin-bottom: 5px;">SSDI Key Points</div>
                        <ul style="margin: 5px 0 0 0; padding-left: 20px; font-size: 0.9rem;">
                            <li>5-month waiting period</li>
                            <li>Based on work credits</li>
                            <li>Medicare after 24 months</li>
                        </ul>
                    </div>
                    <div style="background: rgba(131, 128, 240, 0.05); padding: 15px; border-radius: var(--radius-md);">
                        <div style="font-weight: 700; color: var(--color-info); margin-bottom: 5px;">SSI Key Points</div>
                        <ul style="margin: 5px 0 0 0; padding-left: 20px; font-size: 0.9rem;">
                            <li>Financial need based</li>
                            <li>Immediate Medicaid</li>
                            <li>Federal benefit rate: $943/month (2024)</li>
                        </ul>
                    </div>
                </div>
                
                <button onclick="this.parentElement.remove(); document.querySelector('.overlay')?.remove();" style="background: var(--color-info); color: white; border: none; padding: 15px 30px; border-radius: var(--radius-md); font-weight: 700; cursor: pointer; width: 100%; font-size: 1.1rem;">
                    <i class="fas fa-check"></i>
                    Understood - Continue Analysis
                </button>
            `;
            
            document.body.appendChild(guidance);
            
            // Add overlay
            const overlay = document.createElement('div');
            overlay.className = 'overlay';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.6);
                backdrop-filter: blur(10px);
                z-index: 999;
            `;
            overlay.onclick = () => {
                guidance.remove();
                overlay.remove();
            };
            document.body.appendChild(overlay);
        }

        function animateSelection(element) {
            element.style.animation = 'none';
            setTimeout(() => {
                element.style.animation = 'pulse 0.5s ease';
            }, 10);
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                success: 'var(--color-success)',
                error: 'var(--color-error)',
                warning: 'var(--color-warning)',
                info: 'var(--color-info)'
            };
            
            notification.style.cssText = `
                position: fixed;
                top: 25px;
                right: 25px;
                background: white;
                padding: 18px 24px;
                border-radius: var(--radius-md);
                box-shadow: var(--shadow-lg);
                z-index: 1000;
                border-left: 5px solid ${colors[type]};
                transform: translateX(120%);
                transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
                max-width: 350px;
                display: flex;
                align-items: center;
                gap: 15px;
            `;
            
            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: 'üí°'
            };
            
            notification.innerHTML = `
                <div style="color: ${colors[type]}; font-size: 1.5rem;">${icons[type]}</div>
                <div style="color: var(--color-text); font-weight: 600; font-size: 1.05rem;">${message}</div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 10);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(120%)';
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        function startTimer() {
            setInterval(() => {
                const now = new Date();
                const diff = Math.floor((now - simulationState.startTime) / 1000);
                const minutes = Math.floor(diff / 60);
                const seconds = diff % 60;
                document.getElementById('time-spent').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function populateObjectives() {
            const objectives = [
                "Discuss the history of disability income insurance",
                "Describe benefits and exclusions in individual and group disability insurance",
                "Name and describe federal disability benefit programs",
                "Differentiate between SSDI and SSI",
                "State eligibility requirements, benefits, and limitations of SSDI and SSI",
                "Explain disability benefit programs for disabled active military personnel, veterans, and their dependents",
                "Name states that have state disability insurance plans",
                "State eligibility requirements, benefits, and limitations of state disability plans",
                "Explain voluntary disability insurance plans",
                "Describe topics and contents of a medical report",
                "List guidelines for federal disability claims",
                "Explain procedures for state disability claims",
                "Recognize forms used for processing state disability plans"
            ];
            
            const list = document.getElementById('objectives-list');
            objectives.forEach((obj, index) => {
                const li = document.createElement('li');
                li.className = 'objective-item';
                li.innerHTML = `
                    <div class="objective-checkbox" onclick="toggleObjective(${index})">‚úì</div>
                    <div class="objective-text">
                        <span class="objective-number">${index + 1}.</span>
                        ${obj}
                    </div>
                `;
                list.appendChild(li);
            });
        }

        function toggleObjective(index) {
            const items = document.querySelectorAll('.objective-item');
            if (index < items.length) {
                items[index].classList.toggle('completed');
                updateObjectives();
                showNotification('Objective updated!', 'success');
            }
        }

        function updateObjectives() {
            const completed = document.querySelectorAll('.objective-item.completed').length;
            document.getElementById('completed-objectives').textContent = `${completed}/${simulationState.totalObjectives}`;
            simulationState.completedObjectives = Math.max(simulationState.completedObjectives, completed);
            updateProgress();
        }

        function updateProgress() {
            // Calculate overall progress
            const decisionProgress = (simulationState.correctDecisions / 20) * 30;
            const objectiveProgress = (simulationState.completedObjectives / simulationState.totalObjectives) * 40;
            const caseProgress = (simulationState.currentCase / 3) * 30;
            
            const totalProgress = Math.min(100, decisionProgress + objectiveProgress + caseProgress);
            
            // Update progress bar with animation
            const progressFill = document.getElementById('tracker-fill');
            progressFill.style.width = totalProgress + '%';
            document.getElementById('progress-percent').textContent = Math.round(totalProgress) + '%';
            document.getElementById('tracker-text').textContent = Math.round(totalProgress) + '% Complete';
            
            // Update stats
            document.getElementById('correct-decisions').textContent = simulationState.correctDecisions;
        }

        // Dashboard click handlers
        function focusOnProgress() {
            document.querySelector('.progress-tracker').scrollIntoView({ behavior: 'smooth' });
            showNotification('Focusing on progress tracker', 'info');
        }

        function showObjectives() {
            document.querySelector('.objectives-panel').scrollIntoView({ behavior: 'smooth' });
            showNotification('Showing learning objectives', 'info');
        }

        function showFeedback() {
            const feedbackPanel = document.getElementById('feedback-panel');
            if (feedbackPanel.classList.contains('show')) {
                feedbackPanel.scrollIntoView({ behavior: 'smooth' });
            } else {
                showNotification('Complete an analysis first to see feedback', 'warning');
            }
        }

        function showTimeStats() {
            const now = new Date();
            const diff = Math.floor((now - simulationState.startTime) / 1000);
            const minutes = Math.floor(diff / 60);
            const seconds = diff % 60;
            
            showNotification(`Learning time: ${minutes} minutes, ${seconds} seconds`, 'info');
        }
    </script>
</body>
</html>
