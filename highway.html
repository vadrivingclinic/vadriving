<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VA Driving Clinic - Highway & Street Signs Mastery</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root {
            --color-primary: #1e40af;
            --color-primary-light: #3b82f6;
            --color-secondary: #000000;
            --color-bg: #ffffff;
            --color-text: #000000;
            --color-muted: #6b7280;
            --color-success: #10b981;
            --color-warning: #f59e0b;
            --color-danger: #ef4444;
            --color-info: #0ea5e9;
            --radius-lg: 20px;
            --radius-md: 12px;
            --radius-sm: 8px;
            --shadow-soft: 0 10px 30px rgba(30, 64, 175, 0.1);
            --shadow-hover: 0 15px 35px rgba(30, 64, 175, 0.15);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #ffffff 0%, #eff6ff 100%);
            color: var(--color-text);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .lesson-container {
            max-width: 1200px;
            margin: 0 auto;
            animation: fadeIn 0.6s ease-out;
        }

        /* Timer Styles */
        .timer-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            animation: fadeIn 0.5s ease-out;
        }

        .timer {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            border-radius: 50px;
            padding: 15px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 8px 25px rgba(30, 64, 175, 0.3);
            border: 3px solid rgba(255, 255, 255, 0.2);
            font-weight: 700;
            transition: all 0.3s ease;
        }

        .timer.warning {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
            animation: pulse 1s infinite;
        }

        .timer.critical {
            background: linear-gradient(135deg, #ef4444, #f87171);
            animation: pulse 0.5s infinite;
        }

        .timer-display {
            font-family: 'Courier New', monospace;
            font-size: 1.5rem;
            font-weight: 800;
            letter-spacing: 2px;
            min-width: 100px;
            text-align: center;
        }

        .timer-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Header */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .brand-logo {
            height: 50px;
            width: auto;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .module-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .module-title {
            font-size: 1.1rem;
            color: var(--color-primary);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .lesson-title {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--color-text);
            margin-bottom: 10px;
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .time-estimate {
            background: rgba(30, 64, 175, 0.1);
            border: 2px solid rgba(30, 64, 175, 0.2);
            border-radius: var(--radius-md);
            padding: 20px 25px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .time-estimate-icon {
            font-size: 1.8rem;
            color: var(--color-primary);
        }

        .time-estimate-text {
            font-size: 1.1rem;
            color: var(--color-text);
            font-weight: 600;
            flex-grow: 1;
        }

        .time-highlight {
            color: var(--color-primary);
            font-weight: 800;
            font-size: 1.3em;
        }

        /* Progress Indicators */
        .progress-section {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 30px;
            margin-bottom: 30px;
            align-items: center;
        }

        @media (max-width: 768px) {
            .progress-section { grid-template-columns: 1fr; }
        }

        .progress-bar {
            height: 10px;
            background: rgba(30, 64, 175, 0.1);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #1e40af, #3b82f6);
            border-radius: 5px;
            width: 0%;
            transition: width 0.5s ease;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--color-muted);
            font-weight: 600;
        }

        .score-display {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            min-width: 300px;
        }

        .score-card {
            background: rgba(30, 64, 175, 0.05);
            border-radius: var(--radius-md);
            padding: 15px;
            text-align: center;
            border: 2px solid rgba(30, 64, 175, 0.1);
            transition: all 0.3s ease;
        }

        .score-value {
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--color-primary);
            display: block;
            line-height: 1;
            margin-bottom: 5px;
        }

        .score-label {
            font-size: 0.75rem;
            color: var(--color-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: 600;
        }

        /* Content Navigation */
        .content-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 12px 24px;
            background: rgba(30, 64, 175, 0.1);
            border: 2px solid rgba(30, 64, 175, 0.2);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn.active {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        /* Content Sections */
        .content-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .content-section.active {
            display: block;
        }

        /* Reading Material */
        .reading-material {
            background: var(--color-bg);
            border-radius: var(--radius-lg);
            padding: 40px;
            box-shadow: var(--shadow-soft);
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--color-text);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .sign-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .category-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-soft);
            border: 2px solid rgba(30, 64, 175, 0.1);
            transition: all 0.3s ease;
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .category-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .category-icon.regulatory { background: rgba(239, 68, 68, 0.1); color: #ef4444; }
        .category-icon.warning { background: rgba(245, 158, 11, 0.1); color: #f59e0b; }
        .category-icon.guide { background: rgba(16, 185, 129, 0.1); color: #10b981; }

        .category-title { font-size: 1.3rem; font-weight: 800; color: var(--color-text); }

        .sign-examples { display: grid; gap: 15px; }

        .sign-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(30, 64, 175, 0.03);
            border-radius: var(--radius-md);
            border: 1px solid rgba(30, 64, 175, 0.1);
        }

        .sign-symbol {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            background: #fff;
            padding: 5px;
        }

        .sign-symbol img { width: 100%; height: 100%; object-fit: contain; }

        .sign-info { flex-grow: 1; }
        .sign-name { font-weight: 700; color: var(--color-text); margin-bottom: 5px; }
        .sign-meaning { font-size: 0.85rem; color: var(--color-muted); line-height: 1.4; }

        /* Activities */
        .activities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .activity-card {
            background: var(--color-bg);
            border-radius: var(--radius-lg);
            padding: 30px;
            box-shadow: var(--shadow-soft);
            border: 2px solid rgba(30, 64, 175, 0.1);
        }

        .activity-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .activity-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(30, 64, 175, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--color-primary);
        }

        .activity-title { font-size: 1.4rem; font-weight: 800; color: var(--color-text); }
        .activity-description { color: var(--color-muted); margin-bottom: 25px; line-height: 1.6; }

        /* Matching Game */
        .matching-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        @media (max-width: 768px) { .matching-grid { grid-template-columns: repeat(2, 1fr); } }

        .matching-card {
            aspect-ratio: 1;
            background: rgba(30, 64, 175, 0.1);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s ease;
            transform-style: preserve-3d;
            position: relative;
        }

        .matching-card.flipped { transform: rotateY(180deg); }
        .matching-card.matched { background: rgba(16, 185, 129, 0.2); border-color: var(--color-success); cursor: default; }

        .matching-card-front, .matching-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            font-weight: 600;
        }

        .matching-card-front { background: var(--color-primary); color: white; font-size: 1.5rem; font-weight: bold; }
        .matching-card-back { background: white; border: 2px solid rgba(30, 64, 175, 0.2); transform: rotateY(180deg); text-align: center; font-size: 0.75rem; line-height: 1.3; overflow: hidden; }
        .matching-card-back img { width: 100%; height: 100%; object-fit: contain; }

        /* Quiz Styling */
        .quiz-container { background: rgba(30, 64, 175, 0.05); border-radius: var(--radius-md); padding: 25px; margin: 20px 0; }
        .quiz-question-box { margin-bottom: 30px; border-bottom: 1px solid rgba(30, 64, 175, 0.1); padding-bottom: 20px; }
        .quiz-question-box:last-child { border-bottom: none; }
        .question-text { font-weight: 700; color: var(--color-text); margin-bottom: 15px; font-size: 1.1rem; }
        .quiz-options { display: flex; flex-direction: column; gap: 10px; }
        .quiz-option { padding: 15px; background: white; border: 2px solid rgba(30, 64, 175, 0.2); border-radius: var(--radius-sm); cursor: pointer; display: flex; align-items: center; gap: 12px; transition: 0.2s; }
        .quiz-option:hover { border-color: var(--color-primary); }
        .quiz-option.selected { border-color: var(--color-primary); background: rgba(30, 64, 175, 0.1); font-weight: 600; }
        .option-label { width: 30px; height: 30px; border-radius: 50%; background: rgba(30, 64, 175, 0.1); display: flex; align-items: center; justify-content: center; font-weight: 700; color: var(--color-primary); flex-shrink: 0; }

        /* Identification Activity */
        .sign-identification { text-align: center; padding: 30px; background: rgba(30, 64, 175, 0.05); border-radius: var(--radius-md); margin: 20px 0; }
        .sign-display { width: 150px; height: 150px; margin: 0 auto 30px; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; background: #fff; padding: 10px; border: 1px solid rgba(0,0,0,0.1); }
        .sign-display img { width: 100%; height: 100%; object-fit: contain; }
        .identify-btn { padding: 12px 20px; background: white; border: 2px solid rgba(30, 64, 175, 0.2); border-radius: var(--radius-md); cursor: pointer; font-weight: 600; transition: 0.2s; }
        .identify-btn:hover { border-color: var(--color-primary); }

        /* Results & Feedback */
        .results-score { font-size: 4rem; font-weight: 900; color: var(--color-primary); text-align: center; margin: 20px 0; }
        .performance-chart { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 40px 0; }
        .chart-item { padding: 25px; border-radius: var(--radius-md); text-align: center; background: rgba(30, 64, 175, 0.05); }
        .chart-value { font-size: 2.2rem; font-weight: 900; color: var(--color-primary); }
        .chart-label { font-size: 0.8rem; font-weight: 700; color: var(--color-muted); text-transform: uppercase; }

        /* Action Buttons */
        .action-buttons { display: flex; justify-content: center; gap: 20px; margin: 30px 0; flex-wrap: wrap; }
        .action-btn { padding: 16px 40px; background: var(--color-primary); color: white; border: none; border-radius: var(--radius-md); font-weight: 700; cursor: pointer; text-transform: uppercase; transition: 0.3s; }
        .action-btn:hover { background: #1e3a8a; transform: translateY(-2px); }
        .action-btn.secondary { background: white; border: 2px solid var(--color-primary); color: var(--color-primary); }

        /* Completion Screen */
        .completion-message { display: none; background: linear-gradient(135deg, #10b981, #34d399); color: white; border-radius: var(--radius-lg); padding: 40px; margin-top: 30px; text-align: center; }
        .completion-message.show { display: block; animation: fadeIn 1s; }
        .completion-time { font-size: 3rem; font-weight: 900; margin: 20px 0; font-family: 'Courier New', monospace; }

        .feedback-area { background: rgba(30, 64, 175, 0.05); border-radius: var(--radius-md); padding: 15px; margin: 15px 0; border-left: 4px solid var(--color-primary); }
    </style>
</head>
<body>
    <div class="timer-container">
        <div class="timer" id="timer">
            <div class="timer-icon">‚è±Ô∏è</div>
            <div class="timer-display" id="timer-display">00:00</div>
            <div class="timer-label">Session Time</div>
        </div>
    </div>

    <div class="lesson-container">
        <!-- Header -->
        <div class="header">
            <div class="brand">
                <img src="https://lwfiles.mycourse.app/vadrivingclinic-public/9f5c6b8121721c8ef241f929fd983b3e.png" alt="Logo" class="brand-logo">
                <div class="module-info">
                    <div class="module-title">Road Signs Mastery Module</div>
                    <div style="color: var(--color-muted); font-size: 0.9rem;">Course Component</div>
                </div>
            </div>
        </div>

        <h1 class="lesson-title">Highway & Street Signs Mastery</h1>

        <div class="time-estimate">
            <div class="time-estimate-icon">üè¢</div>
            <div class="time-estimate-text">Estimated mastery time: <span class="time-highlight">20 minutes</span></div>
        </div>

        <div class="progress-section">
            <div class="progress-indicator">
                <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
                <div class="progress-label"><span>Overall Progress</span><span>Time Elapsed: <span id="time-spent">0:00</span></span></div>
            </div>
            <div class="score-display">
                <div class="score-card"><span class="score-value" id="activity-score">0</span><span class="score-label">Points</span></div>
                <div class="score-card"><span class="score-value" id="signs-mastered">0</span><span class="score-label">Signs</span></div>
                <div class="score-card"><span class="score-value" id="final-score-stat">-%</span><span class="score-label">Quiz</span></div>
            </div>
        </div>

        <div class="content-nav">
            <div class="nav-btn active" onclick="switchSection(1)"><span>üìö</span> Learn</div>
            <div class="nav-btn" onclick="switchSection(2)"><span>üéÆ</span> Practice</div>
            <div class="nav-btn" onclick="switchSection(3)"><span>üìù</span> Quiz</div>
            <div class="nav-btn" onclick="switchSection(4)"><span>üìä</span> Results</div>
        </div>

        <!-- Section 1: Learn -->
        <div class="content-section active" id="section-1">
            <div class="reading-material">
                <h2 class="section-title"><span>üö∏</span> Highway & Street Sign Guide</h2>
                <div class="sign-categories">
                    <!-- Regulatory -->
                    <div class="category-card">
                        <div class="category-header"><div class="category-icon regulatory">üö´</div><div class="category-title">Regulatory</div></div>
                        <div class="sign-examples">
                            <div class="sign-item">
                                <div class="sign-symbol"><img src="https://www.clipartmax.com/png/middle/156-1565923_sign-blanks-stop-sign.png" alt="Stop"></div>
                                <div class="sign-info"><div class="sign-name">Stop Sign</div><div class="sign-meaning">Complete stop, yield right of way.</div></div>
                            </div>
                            <div class="sign-item">
                                <div class="sign-symbol"><img src="https://p7.hiclipart.com/preview/689/696/47/yield-sign-traffic-sign-clip-art-images-of-traffic-signs.jpg" alt="Yield"></div>
                                <div class="sign-info"><div class="sign-name">Yield Sign</div><div class="sign-meaning">Slow down, proceed when clear.</div></div>
                            </div>
                            <div class="sign-item">
                                <div class="sign-symbol"><img src="https://www.roadtrafficsigns.com/img/lg/X/speed-limit-sign-x-r2-1-45.png" alt="Speed"></div>
                                <div class="sign-info"><div class="sign-name">Speed Limit</div><div class="sign-meaning">Lawful maximum speed for current road.</div></div>
                            </div>
                        </div>
                    </div>
                    <!-- Warning -->
                    <div class="category-card">
                        <div class="category-header"><div class="category-icon warning">‚ö†Ô∏è</div><div class="category-title">Warning</div></div>
                        <div class="sign-examples">
                            <div class="sign-item">
                                <div class="sign-symbol"><img src="https://www.roadtrafficsigns.com/img/lg/X/left-winding-road-sign-x-w1-5l.png" alt="Curve"></div>
                                <div class="sign-info"><div class="sign-name">Curve Ahead</div><div class="sign-meaning">Caution: change in road alignment.</div></div>
                            </div>
                            <div class="sign-item">
                                <div class="sign-symbol"><img src="https://res.cloudinary.com/woodland/image/upload/c_limit,d_ni.png,f_auto,q_auto,w_1024/v1/advanced_media/media/catalog/product/p/e/pedestrian-crossing.jpg" alt="Pedestrian"></div>
                                <div class="sign-info"><div class="sign-name">Pedestrian</div><div class="sign-meaning">Alert: People may be crossing ahead.</div></div>
                            </div>
                            <div class="sign-item">
                                <div class="sign-symbol"><img src="https://www.alphabetsigns.com/mm5/graphics/00000044/deer-crossing-sign-w11-3.png" alt="Deer"></div>
                                <div class="sign-info"><div class="sign-name">Deer Crossing</div><div class="sign-meaning">Caution: Wild wildlife area.</div></div>
                            </div>
                        </div>
                    </div>
                    <!-- Guide -->
                    <div class="category-card">
                        <div class="category-header"><div class="category-icon guide">üõ£Ô∏è</div><div class="category-title">Guide</div></div>
                        <div class="sign-examples">
                            <div class="sign-item">
                                <div class="sign-symbol"><img src="https://e7.pngegg.com/pngimages/23/217/png-clipart-traffic-sign-road-highway-exit-sign-exit-s-text-logo.png" alt="Exit"></div>
                                <div class="sign-info"><div class="sign-name">Highway Exit</div><div class="sign-meaning">Route markers and exit directions.</div></div>
                            </div>
                            <div class="sign-item">
                                <div class="sign-symbol"><img src="https://www.roadtrafficsigns.com/img/lg/K/us-custom-state-route-marker-shield-sign-k2-3382.png" alt="Route"></div>
                                <div class="sign-info"><div class="sign-name">Route Shield</div><div class="sign-meaning">Identifies designated highway routes.</div></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="action-btn" onclick="switchSection(2)">Enter Practice Zone ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Section 2: Practice -->
        <div class="content-section" id="section-2">
            <div class="activities-grid">
                <div class="activity-card">
                    <div class="activity-header"><div class="activity-icon">üîó</div><div class="activity-title">Sign Matcher</div></div>
                    <p class="activity-description">Match symbols with their legal meanings.</p>
                    <div class="matching-grid" id="matching-grid"></div>
                    <div class="feedback-area" id="matching-feedback">Pairs: <span id="matches-found">0</span>/8</div>
                    <button class="action-btn secondary" onclick="resetMatchingGame()" style="width:100%">Reset Board</button>
                </div>
                <div class="activity-card">
                    <div class="activity-header"><div class="activity-icon">üîç</div><div class="activity-title">ID Challenge</div></div>
                    <p class="activity-description">Identify the sign's legal category.</p>
                    <div class="sign-identification">
                        <div class="sign-display" id="current-sign"></div>
                        <div class="identification-options">
                            <button class="identify-btn" onclick="identifySign('regulatory')">Regulatory</button>
                            <button class="identify-btn" onclick="identifySign('warning')">Warning</button>
                            <button class="identify-btn" onclick="identifySign('guide')">Guide</button>
                        </div>
                        <div class="feedback-area" id="identification-feedback" style="display:none; margin-top:10px;"></div>
                        <button class="action-btn secondary" onclick="nextIdentification()" style="margin-top:10px; width:100%">Next Sign</button>
                    </div>
                </div>
            </div>
            <div class="action-buttons"><button class="action-btn" onclick="completeActivities()">Proceed to Final Quiz ‚Üí</button></div>
        </div>

        <!-- Section 3: Quiz (FULL RESTORATION) -->
        <div class="content-section" id="section-3">
            <div class="comprehensive-quiz">
                <div class="quiz-header">
                    <h2 class="quiz-title">Final Mastery Quiz</h2>
                    <p>Complete all 10 questions to verify mastery.</p>
                    <div class="quiz-timer" id="quiz-timer">10:00</div>
                </div>
                <div id="quiz-questions-container"></div>
                <div class="action-buttons">
                    <button class="action-btn" id="quiz-submit-btn" onclick="submitFinalQuiz()">Calculate Results ‚úì</button>
                </div>
            </div>
        </div>

        <!-- Section 4: Results -->
        <div class="content-section" id="section-4">
            <div class="review-section">
                <div class="results-summary">
                    <h2 class="section-title">Mastery Results</h2>
                    <div class="results-score" id="final-percentage-display">0%</div>
                </div>
                <div class="performance-chart">
                    <div class="chart-item"><div class="chart-value" id="reg-score">0%</div><div class="chart-label">Regulatory</div></div>
                    <div class="chart-item"><div class="chart-value" id="warn-score">0%</div><div class="chart-label">Warning</div></div>
                    <div class="chart-item"><div class="chart-value" id="gui-score">0%</div><div class="chart-label">Guide</div></div>
                </div>
                <div class="action-buttons">
                    <button class="action-btn" onclick="completeLesson()">Finalize & Export Certificate</button>
                </div>
            </div>
        </div>

        <!-- Completion Message -->
        <div class="completion-message" id="completion-message">
            <div class="completion-title">üéâ Road Signs Mastered!</div>
            <div class="completion-time" id="completion-time-final">00:00</div>
            <div class="completion-stats">
                <div class="completion-stat"><div class="completion-stat-value" id="mastery-final">0%</div><div class="completion-stat-label">Final Grade</div></div>
            </div>
            <button class="action-btn" style="background:#fff; color:#1e40af;" onclick="location.reload()">Restart Module</button>
        </div>
    </div>

    <script>
        const IMAGES = {
            stop: 'https://www.clipartmax.com/png/middle/156-1565923_sign-blanks-stop-sign.png',
            yield: 'https://p7.hiclipart.com/preview/689/696/47/yield-sign-traffic-sign-clip-art-images-of-traffic-signs.jpg',
            speed: 'https://www.roadtrafficsigns.com/img/lg/X/speed-limit-sign-x-r2-1-45.png',
            curve: 'https://www.roadtrafficsigns.com/img/lg/X/left-winding-road-sign-x-w1-5l.png',
            pedestrian: 'https://res.cloudinary.com/woodland/image/upload/c_limit,d_ni.png,f_auto,q_auto,w_1024/v1/advanced_media/media/catalog/product/p/e/pedestrian-crossing.jpg',
            deer: 'https://www.alphabetsigns.com/mm5/graphics/00000044/deer-crossing-sign-w11-3.png',
            exit: 'https://e7.pngegg.com/pngimages/23/217/png-clipart-traffic-sign-road-highway-exit-sign-exit-s-text-logo.png',
            route: 'https://www.roadtrafficsigns.com/img/lg/K/us-custom-state-route-marker-shield-sign-k2-3382.png',
            service: 'https://wallpapers.com/images/hd/highway-exit-services-signs-4tyyhwcua3t2t43v.jpg'
        };

        const state = {
            totalSeconds: 0,
            score: 0,
            signs: 0,
            currentSection: 1,
            matchingPairsDone: 0,
            quizAnswers: {},
            quizTimeLeft: 600,
            timerStarted: false,
            matchingData: [
                { img: IMAGES.stop, text: 'Stop: Complete stop required' },
                { img: IMAGES.yield, text: 'Yield: Give way to others' },
                { img: IMAGES.speed, text: 'Speed: Legal maximum' },
                { img: IMAGES.curve, text: 'Curve: Winding road ahead' },
                { img: IMAGES.pedestrian, text: 'Pedestrian: Crosswalk alert' },
                { img: IMAGES.deer, text: 'Deer: Crossing area' },
                { img: IMAGES.exit, text: 'Exit: Highway departure' },
                { img: IMAGES.route, text: 'Route: Road marker' }
            ],
            idData: [
                { img: IMAGES.stop, type: 'regulatory' },
                { img: IMAGES.yield, type: 'warning' },
                { img: IMAGES.speed, type: 'regulatory' },
                { img: IMAGES.curve, type: 'warning' },
                { img: IMAGES.exit, type: 'guide' },
                { img: IMAGES.route, type: 'guide' }
            ],
            curIdIndex: 0
        };

        const finalQuizQuestions = [
            { question: "What is the primary purpose of regulatory signs?", options: ["Give directions", "Warn about hazards", "Inform about traffic laws", "Identify services"], correct: 2, type: 'regulatory' },
            { question: "A diamond-shaped sign is used exclusively for:", options: ["Stop signs", "Yield signs", "Warning signs", "Route markers"], correct: 2, type: 'warning' },
            { question: "How many sides does a standard STOP sign have?", options: ["4", "6", "8", "10"], correct: 2, type: 'regulatory' },
            { question: "Blue signs along a highway typically indicate:", options: ["Construction", "Prohibitions", "Driver services", "Exits"], correct: 2, type: 'guide' },
            { question: "A triangle-shaped sign always means:", options: ["Yield", "Caution", "Merge", "Stop"], correct: 0, type: 'warning' },
            { question: "What information do green guide signs provide?", options: ["Speed limits", "Hazard warnings", "Directions and distances", "Nearby services"], correct: 2, type: 'guide' },
            { question: "Orange signs are specifically used for:", options: ["Parks", "Construction zones", "School zones", "Hospitals"], correct: 1, type: 'warning' },
            { question: "Which color background is standard for speed limit signs?", options: ["Yellow", "Red", "White", "Green"], correct: 2, type: 'regulatory' },
            { question: "A route shield marker (shield shape) is what type of sign?", options: ["Warning", "Guide", "Regulatory", "Information"], correct: 1, type: 'guide' },
            { question: "What must you do at a Yield sign?", options: ["Stop regardless", "Slow down and proceed if clear", "Ignore if empty", "Flash headlights"], correct: 1, type: 'regulatory' }
        ];

        function startGlobalTimer() {
            if(state.timerStarted) return;
            state.timerStarted = true;
            setInterval(() => {
                state.totalSeconds++;
                const m = Math.floor(state.totalSeconds / 60).toString().padStart(2, '0');
                const s = (state.totalSeconds % 60).toString().padStart(2, '0');
                document.getElementById('timer-display').innerText = `${m}:${s}`;
                document.getElementById('time-spent').innerText = `${m}:${s}`;
            }, 1000);
        }

        function switchSection(n) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`section-${n}`).classList.add('active');
            document.querySelectorAll('.nav-btn')[n-1].classList.add('active');
            state.currentSection = n;
            if(n === 2) { setupMatchingGame(); nextIdentification(); }
            if(n === 3) { loadFullQuiz(); startQuizCountdown(); }
            updateProgress();
        }

        function updateProgress() {
            const p = (state.currentSection / 4) * 100;
            document.getElementById('progress-fill').style.width = p + '%';
            document.getElementById('activity-score').innerText = state.score;
            document.getElementById('signs-mastered').innerText = state.signs;
        }

        // --- MATCHING GAME LOGIC ---
        let firstCard = null, secondCard = null, lockBoard = false;
        function setupMatchingGame() {
            const grid = document.getElementById('matching-grid');
            grid.innerHTML = '';
            let deck = [];
            state.matchingData.forEach((d, i) => {
                deck.push({ type: 'img', val: d.img, id: i });
                deck.push({ type: 'txt', val: d.text, id: i });
            });
            deck.sort(() => Math.random() - 0.5);
            deck.forEach(d => {
                const el = document.createElement('div');
                el.className = 'matching-card';
                el.innerHTML = `<div class="matching-card-front">?</div><div class="matching-card-back">${d.type==='img'?`<img src="${d.val}">`:d.val}</div>`;
                el.onclick = () => {
                    if(lockBoard || el.classList.contains('flipped') || el.classList.contains('matched')) return;
                    el.classList.add('flipped');
                    if(!firstCard) { firstCard = {el, d}; return; }
                    secondCard = {el, d}; lockBoard = true;
                    if(firstCard.d.id === secondCard.d.id) {
                        state.score += 50; state.signs++;
                        firstCard.el.classList.add('matched'); secondCard.el.classList.add('matched');
                        document.getElementById('matches-found').innerText = ++state.matchingPairsDone;
                        firstCard = null; secondCard = null; lockBoard = false;
                        updateProgress();
                    } else {
                        setTimeout(() => { firstCard.el.classList.remove('flipped'); secondCard.el.classList.remove('flipped'); firstCard = null; secondCard = null; lockBoard = false; }, 1000);
                    }
                };
                grid.appendChild(el);
            });
        }
        function resetMatchingGame() { state.matchingPairsDone = 0; setupMatchingGame(); }

        // --- IDENTIFICATION LOGIC ---
        function nextIdentification() {
            state.curIdIndex = Math.floor(Math.random() * state.idData.length);
            const sign = state.idData[state.curIdIndex];
            document.getElementById('current-sign').innerHTML = `<img src="${sign.img}">`;
            document.getElementById('identification-feedback').style.display = 'none';
        }
        function identifySign(t) {
            const correct = state.idData[state.curIdIndex].type;
            const fb = document.getElementById('identification-feedback');
            fb.style.display = 'block';
            if(t === correct) {
                fb.innerHTML = '<span style="color:#10b981; font-weight:800">‚úì CORRECT!</span>';
                state.score += 20; state.signs++;
            } else {
                fb.innerHTML = `<span style="color:#ef4444; font-weight:800">‚úò INCORRECT. This is ${correct}.</span>`;
            }
            updateProgress();
        }

        // --- FULL QUIZ LOGIC ---
        function loadFullQuiz() {
            const container = document.getElementById('quiz-questions-container');
            container.innerHTML = '';
            finalQuizQuestions.forEach((q, idx) => {
                const box = document.createElement('div');
                box.className = 'quiz-question-box';
                box.innerHTML = `<p class="question-text">${idx+1}. ${q.question}</p>`;
                const opts = document.createElement('div');
                opts.className = 'quiz-options';
                q.options.forEach((opt, optIdx) => {
                    const btn = document.createElement('div');
                    btn.className = 'quiz-option';
                    btn.innerHTML = `<div class="option-label">${String.fromCharCode(65 + optIdx)}</div><div>${opt}</div>`;
                    btn.onclick = () => {
                        state.quizAnswers[idx] = optIdx;
                        Array.from(opts.children).forEach(c => c.classList.remove('selected'));
                        btn.classList.add('selected');
                    };
                    opts.appendChild(btn);
                });
                box.appendChild(opts);
                container.appendChild(box);
            });
        }

        function startQuizCountdown() {
            const timerEl = document.getElementById('quiz-timer');
            const quizInterval = setInterval(() => {
                if(state.currentSection !== 3) { clearInterval(quizInterval); return; }
                state.quizTimeLeft--;
                const m = Math.floor(state.quizTimeLeft/60).toString().padStart(2,'0');
                const s = (state.quizTimeLeft%60).toString().padStart(2,'0');
                timerEl.innerText = `${m}:${s}`;
                if(state.quizTimeLeft <= 0) { clearInterval(quizInterval); submitFinalQuiz(); }
            }, 1000);
        }

        function submitFinalQuiz() {
            let correctCount = 0;
            const catScore = { regulatory: {c:0, t:0}, warning: {c:0, t:0}, guide: {c:0, t:0} };

            finalQuizQuestions.forEach((q, i) => {
                catScore[q.type].t++;
                if(state.quizAnswers[i] === q.correct) {
                    correctCount++;
                    catScore[q.type].c++;
                }
            });

            const totalGrade = Math.round((correctCount/10)*100);
            document.getElementById('final-score-stat').innerText = totalGrade + '%';
            document.getElementById('final-percentage-display').innerText = totalGrade + '%';
            document.getElementById('mastery-final').innerText = totalGrade + '%';
            
            document.getElementById('reg-score').innerText = Math.round((catScore.regulatory.c/catScore.regulatory.t)*100) + '%';
            document.getElementById('warn-score').innerText = Math.round((catScore.warning.c/catScore.warning.t)*100) + '%';
            document.getElementById('gui-score').innerText = Math.round((catScore.guide.c/catScore.guide.t)*100) + '%';

            switchSection(4);
        }

        function completeActivities() {
            if(state.matchingPairsDone < 1) {
                alert("Please try the matching game at least once before the quiz.");
                return;
            }
            switchSection(3);
        }

        function completeLesson() {
            document.getElementById('completion-message').classList.add('show');
            document.getElementById('completion-time-final').innerText = document.getElementById('timer-display').innerText;
            document.getElementById('completion-message').scrollIntoView({ behavior: 'smooth' });
        }

        window.onload = () => {
            startGlobalTimer();
            updateProgress();
        };
    </script>
</body>
</html>
