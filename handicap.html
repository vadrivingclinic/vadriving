<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VA Driving Clinic - Handicapped Parking in Virginia</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root {
            --color-primary: #5f17eb; /* Brand purple */
            --color-primary-soft: #8a5feb;
            --color-secondary: #000000; /* Black */
            --color-accent: #7c3aed;
            --color-success: #10b981;
            --color-error: #ef4444;
            --color-warning: #f59e0b;
            --color-bg: #ffffff; /* White */
            --color-text: #000000; /* Black */
            --color-muted: #6b7280;
            --color-dark: #000000; /* Black */
            --color-light: #f9fafb;
            --radius-lg: 20px;
            --radius-md: 12px;
            --radius-sm: 8px;
            --shadow-soft: 0 10px 30px rgba(95, 23, 235, 0.1);
            --shadow-hover: 0 15px 35px rgba(95, 23, 235, 0.15);
            --shadow-card: 0 8px 25px rgba(0, 0, 0, 0.08);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            padding: 24px;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            color: var(--color-text);
            line-height: 1.6;
        }

        @media (max-width: 600px) {
            body { padding: 12px; }
        }

        /* Animations */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(95, 23, 235, 0.5); }
            50% { box-shadow: 0 0 20px rgba(95, 23, 235, 0.8); }
        }

        /* Main Container */
        .page {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--color-bg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            padding: 30px;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease-out;
            border: 1px solid rgba(95, 23, 235, 0.1);
        }

        @media (max-width: 900px) {
            .page { padding: 20px; }
        }

        @media (max-width: 480px) {
            body { padding: 0; }
            .page {
                border-radius: 0;
                box-shadow: none;
                padding: 16px 12px 20px;
            }
        }

        /* Header */
        .brand-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
            width: 100%;
            animation: fadeIn 0.6s ease-out 0.2s both;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .brand-logo {
            height: 50px;
            width: auto;
            max-width: 100%;
            transition: transform 0.3s ease;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .brand-logo:hover { 
            transform: scale(1.05); 
            animation: glow 2s infinite;
        }

        .course-meta {
            display: flex;
            flex-direction: column;
            gap: 4px;
            max-width: 100%;
        }

        .course-name {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--color-primary);
            font-weight: 700;
        }

        .week-label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 999px;
            background: rgba(95, 23, 235, 0.1);
            font-size: 0.8rem;
            color: var(--color-primary);
            font-weight: 600;
            border: 1px solid rgba(95, 23, 235, 0.2);
        }

        .week-label-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: var(--color-primary);
            flex-shrink: 0;
            animation: pulse 2s infinite;
        }

        .badge-mode {
            padding: 6px 12px;
            border-radius: 999px;
            background: rgba(95, 23, 235, 0.08);
            border: 1px solid rgba(95, 23, 235, 0.15);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--color-primary);
            white-space: nowrap;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .badge-mode:hover {
            background: rgba(95, 23, 235, 0.15);
            border-color: var(--color-primary);
            transform: translateY(-2px);
        }

        h1 {
            font-size: clamp(1.8rem, 3vw, 2.4rem);
            line-height: 1.1;
            color: var(--color-text);
            margin-bottom: 10px;
            animation: fadeInUp 0.6s ease-out 0.3s both;
        }

        .module-subtitle {
            font-size: 1rem;
            color: var(--color-muted);
            max-width: 800px;
            margin-bottom: 28px;
            animation: fadeInUp 0.6s ease-out 0.4s both;
            line-height: 1.7;
        }

        /* Time Estimate Banner */
        .time-estimate-banner {
            background: linear-gradient(135deg, rgba(95, 23, 235, 0.1) 0%, rgba(124, 58, 237, 0.1) 100%);
            border: 2px solid rgba(95, 23, 235, 0.2);
            border-radius: var(--radius-md);
            padding: 15px 20px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: fadeIn 0.5s ease;
        }

        .time-estimate-icon {
            font-size: 1.5rem;
            color: var(--color-primary);
            background: rgba(95, 23, 235, 0.1);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .time-estimate-content h3 {
            color: var(--color-primary);
            font-size: 1rem;
            margin-bottom: 5px;
            font-weight: 700;
        }

        .time-estimate-content p {
            color: var(--color-text);
            font-size: 0.9rem;
            margin: 0;
        }

        .time-highlight {
            color: var(--color-primary);
            font-weight: 800;
            font-size: 1.1em;
        }

        /* Stats Display */
        .stats-display {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 600px) {
            .stats-display { grid-template-columns: 1fr; }
        }

        .stat-card {
            background: rgba(95, 23, 235, 0.05);
            border-radius: var(--radius-md);
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(95, 23, 235, 0.1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--color-primary);
            box-shadow: 0 10px 25px rgba(95, 23, 235, 0.1);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--color-primary);
            display: block;
            line-height: 1;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--color-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: 600;
        }

        /* Progress Tracker */
        .progress-tracker {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
            padding: 0 20px;
        }

        .progress-tracker::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 50px;
            right: 50px;
            height: 3px;
            background: rgba(95, 23, 235, 0.1);
            z-index: 1;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            flex: 1;
        }

        .step-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: white;
            border: 2px solid rgba(95, 23, 235, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .progress-step.active .step-circle {
            background: var(--color-primary);
            border-color: var(--color-primary);
            color: white;
            transform: scale(1.1);
            animation: pulse 2s infinite;
        }

        .progress-step.completed .step-circle {
            background: var(--color-success);
            border-color: var(--color-success);
            color: white;
        }

        .step-label {
            font-size: 0.75rem;
            color: var(--color-muted);
            text-align: center;
            font-weight: 600;
        }

        .progress-step.active .step-label {
            color: var(--color-primary);
            font-weight: 700;
        }

        /* Activity Grid */
        .activity-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            margin-bottom: 30px;
        }

        @media (max-width: 900px) {
            .activity-grid { grid-template-columns: 1fr; }
        }

        .activity-card {
            background: var(--color-bg);
            border-radius: var(--radius-md);
            border: 1px solid rgba(95, 23, 235, 0.15);
            padding: 24px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .activity-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--color-primary);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .activity-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
            border-color: var(--color-primary);
        }

        .activity-card:hover::before { 
            opacity: 1;
            animation: glow 2s infinite;
        }

        .activity-card.completed {
            border-color: var(--color-success);
        }

        .activity-card.completed::before {
            background: var(--color-success);
            opacity: 1;
        }

        .activity-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .activity-number {
            font-size: 0.85rem;
            font-weight: 800;
            color: var(--color-primary);
            background: rgba(95, 23, 235, 0.1);
            padding: 4px 12px;
            border-radius: 20px;
            border: 1px solid rgba(95, 23, 235, 0.2);
        }

        .activity-status {
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: 12px;
            background: rgba(95, 23, 235, 0.08);
            color: var(--color-primary);
            font-weight: 600;
            border: 1px solid rgba(95, 23, 235, 0.15);
        }

        .activity-card.completed .activity-status {
            background: rgba(16, 185, 129, 0.1);
            color: var(--color-success);
            border-color: rgba(16, 185, 129, 0.2);
        }

        .activity-title {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--color-text);
            margin-bottom: 12px;
        }

        .activity-description {
            font-size: 0.95rem;
            color: var(--color-muted);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        /* Activity Time Estimate */
        .activity-time-estimate {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
            padding: 8px 12px;
            background: rgba(95, 23, 235, 0.05);
            border-radius: var(--radius-sm);
            border-left: 3px solid var(--color-primary);
        }

        .activity-time-icon {
            color: var(--color-primary);
            font-weight: bold;
        }

        .activity-time-text {
            font-size: 0.85rem;
            color: var(--color-text);
            font-weight: 600;
        }

        /* Eligibility Checker */
        .eligibility-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        @media (max-width: 600px) {
            .eligibility-container { grid-template-columns: 1fr; }
        }

        .eligibility-item {
            background: rgba(95, 23, 235, 0.03);
            border-radius: var(--radius-sm);
            padding: 20px;
            border: 2px solid rgba(95, 23, 235, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .eligibility-item:hover {
            border-color: var(--color-primary);
            background: rgba(95, 23, 235, 0.05);
            transform: translateY(-3px);
        }

        .eligibility-item.selected {
            border-color: var(--color-primary);
            background: rgba(95, 23, 235, 0.08);
            border-left: 4px solid var(--color-primary);
        }

        .eligibility-item.eligible {
            border-color: var(--color-success);
            background: rgba(16, 185, 129, 0.1);
        }

        .eligibility-item.not-eligible {
            border-color: var(--color-muted);
            background: rgba(107, 114, 128, 0.1);
        }

        .eligibility-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .eligibility-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 5px;
        }

        .eligibility-description {
            font-size: 0.8rem;
            color: var(--color-muted);
        }

        /* Parking Space Simulator */
        .parking-simulator {
            background: #2a2a2a;
            border-radius: var(--radius-md);
            padding: 25px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .parking-space {
            width: 100%;
            height: 120px;
            background: #444;
            border: 3px dashed #666;
            border-radius: var(--radius-sm);
            margin: 20px auto;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .parking-space.occupied {
            background: #555;
            border: 3px solid #888;
        }

        .access-aisle {
            width: 100%;
            height: 60px;
            background: repeating-linear-gradient(
                45deg,
                #ff4444,
                #ff4444 10px,
                #ff6666 10px,
                #ff6666 20px
            );
            border-radius: var(--radius-sm);
            margin: 10px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .parking-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .parking-btn {
            padding: 10px 20px;
            border-radius: var(--radius-sm);
            border: 2px solid var(--color-primary);
            background: white;
            color: var(--color-primary);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
        }

        .parking-btn:hover {
            background: var(--color-primary);
            color: white;
            transform: translateY(-2px);
        }

        .parking-btn.legal {
            border-color: var(--color-success);
            color: var(--color-success);
        }

        .parking-btn.legal:hover {
            background: var(--color-success);
            color: white;
        }

        .parking-btn.illegal {
            border-color: var(--color-error);
            color: var(--color-error);
        }

        .parking-btn.illegal:hover {
            background: var(--color-error);
            color: white;
        }

        /* Application Process */
        .process-steps {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .process-step {
            background: rgba(95, 23, 235, 0.03);
            border-radius: var(--radius-sm);
            padding: 20px;
            border: 2px solid rgba(95, 23, 235, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .process-step:hover {
            border-color: var(--color-primary);
            background: rgba(95, 23, 235, 0.05);
            transform: translateX(5px);
        }

        .process-step.active {
            border-color: var(--color-primary);
            background: rgba(95, 23, 235, 0.08);
            border-left: 4px solid var(--color-primary);
        }

        .process-step-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .process-step-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(95, 23, 235, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--color-primary);
            flex-shrink: 0;
        }

        .process-step-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--color-primary);
            flex-grow: 1;
            margin-left: 15px;
        }

        .process-step-details {
            display: none;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(95, 23, 235, 0.1);
        }

        .process-step.active .process-step-details {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        /* Quiz Activity */
        .quiz-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .quiz-question {
            font-size: 1rem;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(95, 23, 235, 0.1);
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            padding: 14px 16px;
            border-radius: var(--radius-sm);
            border: 2px solid rgba(95, 23, 235, 0.2);
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .quiz-option:hover {
            border-color: var(--color-primary);
            background: rgba(95, 23, 235, 0.05);
            transform: translateX(5px);
        }

        .quiz-option.selected {
            border-color: var(--color-primary);
            background: rgba(95, 23, 235, 0.1);
            font-weight: 600;
        }

        .quiz-option.correct {
            border-color: var(--color-success);
            background: rgba(16, 185, 129, 0.1);
        }

        .quiz-option.incorrect {
            border-color: var(--color-error);
            background: rgba(239, 68, 68, 0.1);
            animation: shake 0.5s ease;
        }

        .option-label {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(95, 23, 235, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
            color: var(--color-primary);
            border: 1px solid rgba(95, 23, 235, 0.2);
        }

        .quiz-option.selected .option-label {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        .quiz-option.correct .option-label {
            background: var(--color-success);
            color: white;
            border-color: var(--color-success);
        }

        /* Feedback */
        .feedback-container {
            background: rgba(95, 23, 235, 0.03);
            border-radius: var(--radius-sm);
            padding: 20px;
            border: 1px solid rgba(95, 23, 235, 0.15);
            margin-top: 20px;
            display: none;
            border-left: 4px solid var(--color-primary);
        }

        .feedback-container.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .feedback-title {
            font-size: 0.95rem;
            font-weight: 800;
            color: var(--color-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .feedback-icon {
            font-size: 1.3rem;
            font-weight: bold;
        }

        .feedback-icon.correct { 
            color: var(--color-success); 
        }
        
        .feedback-icon.incorrect { 
            color: var(--color-error); 
        }

        .feedback-content {
            font-size: 0.9rem;
            color: var(--color-text);
            line-height: 1.7;
        }

        .feedback-content strong { 
            color: var(--color-primary); 
            font-weight: 700;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 14px 28px;
            border-radius: var(--radius-md);
            border: none;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
            border: 2px solid var(--color-primary);
        }

        .btn-primary:hover {
            background: #4c0fcf;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(95, 23, 235, 0.4);
            animation: glow 1.5s infinite;
        }

        .btn-secondary {
            background: white;
            color: var(--color-primary);
            border: 2px solid var(--color-primary);
        }

        .btn-secondary:hover {
            background: rgba(95, 23, 235, 0.1);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(95, 23, 235, 0.2);
        }

        .btn-icon { 
            font-size: 1.2em; 
            font-weight: bold;
        }

        /* Results Panel */
        .results-panel {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            color: white;
            border-radius: var(--radius-md);
            padding: 40px;
            margin-top: 40px;
            display: none;
            animation: fadeInUp 0.6s ease;
            border: 2px solid var(--color-primary);
        }

        .results-panel.show { 
            display: block; 
            animation: glow 2s infinite;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .results-title {
            font-size: 1.6rem;
            font-weight: 800;
            color: white;
        }

        .score-display {
            font-size: 3.5rem;
            font-weight: 900;
            color: var(--color-primary);
            text-align: center;
            margin: 30px 0;
            text-shadow: 0 0 20px rgba(95, 23, 235, 0.7);
            animation: pulse 2s infinite;
        }

        .safety-insights {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
            padding: 25px;
            margin-top: 25px;
            border-left: 4px solid var(--color-primary);
        }

        .insights-title {
            font-size: 1.1rem;
            font-weight: 800;
            color: var(--color-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .insights-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .insights-list li {
            display: flex;
            gap: 12px;
            align-items: flex-start;
            font-size: 0.95rem;
            color: #e5e7eb;
            line-height: 1.6;
        }

        .insight-dot {
            width: 8px;
            height: 8px;
            margin-top: 10px;
            border-radius: 999px;
            background: var(--color-primary);
            flex-shrink: 0;
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <main class="page" aria-labelledby="module-heading">
        <!-- Header -->
        <header class="brand-row">
            <div class="brand">
                <img
                    src="https://lwfiles.mycourse.app/vadrivingclinic-public/9f5c6b8121721c8ef241f929fd983b3e.png"
                    alt="VA Driving Clinic logo"
                    class="brand-logo"
                />
                <div class="course-meta">
                    <span class="course-name">VA Driving Clinic ‚Ä¢ Module 3</span>
                    <div class="week-label">
                        <span class="week-label-dot"></span>
                        <span>Handicapped Parking in Virginia</span>
                    </div>
                </div>
            </div>
            <span class="badge-mode">Interactive Learning</span>
        </header>

        <h1 id="module-heading">Handicapped Parking in Virginia</h1>
        <p class="module-subtitle">
            A comprehensive interactive module covering eligibility requirements, application processes, proper usage, 
            and enforcement of handicapped parking permits in Virginia. Learn how these spaces provide essential accessibility 
            for individuals with disabilities and the serious consequences of misuse.
        </p>

        <!-- Time Estimate Banner -->
        <div class="time-estimate-banner">
            <div class="time-estimate-icon">
                ‚è±Ô∏è
            </div>
            <div class="time-estimate-content">
                <h3>Module Time Estimate</h3>
                <p>Complete all 3 activities in approximately <span class="time-highlight">7 minutes</span>. This module provides essential knowledge about accessible parking regulations and proper permit usage.</p>
            </div>
        </div>

        <!-- Stats Display -->
        <div class="stats-display">
            <div class="stat-card">
                <span class="stat-number" id="completed-count">0</span>
                <span class="stat-label">Activities Completed</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="accuracy-rate">0%</span>
                <span class="stat-label">Accuracy Rate</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="time-spent">0:00</span>
                <span class="stat-label">Time Learning</span>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-step active" data-step="1">
                <div class="step-circle">1</div>
                <div class="step-label">Eligibility & Application</div>
            </div>
            <div class="progress-step" data-step="2">
                <div class="step-circle">2</div>
                <div class="step-label">Proper Usage</div>
            </div>
            <div class="progress-step" data-step="3">
                <div class="step-circle">3</div>
                <div class="step-label">Laws & Enforcement</div>
            </div>
        </div>

        <!-- Activity Grid -->
        <div class="activity-grid">
            <!-- Activity 1: Eligibility & Application -->
            <section class="activity-card" id="activity-1" data-activity="1">
                <div class="activity-header">
                    <span class="activity-number">Activity 1</span>
                    <span class="activity-status">Not Started</span>
                </div>
                <h3 class="activity-title">Eligibility & Application Process</h3>
                <p class="activity-description">
                    Discover who qualifies for handicapped parking permits in Virginia and learn the step-by-step application process. 
                    Click on eligibility conditions and application steps to reveal detailed information.
                </p>

                <div class="activity-time-estimate">
                    <span class="activity-time-icon">‚è±Ô∏è</span>
                    <span class="activity-time-text">Estimated time: <strong>2-3 minutes</strong></span>
                </div>

                <h4 style="margin-bottom: 15px; color: var(--color-primary);">Who Qualifies for Handicapped Parking?</h4>
                <div class="eligibility-container">
                    <div class="eligibility-item" data-eligible="true">
                        <div class="eligibility-icon">üö∂‚Äç‚ôÇÔ∏è</div>
                        <div class="eligibility-title">Walking Limitations</div>
                        <div class="eligibility-description">Cannot walk 200+ feet without resting</div>
                    </div>
                    
                    <div class="eligibility-item" data-eligible="true">
                        <div class="eligibility-icon">ü¶Ω</div>
                        <div class="eligibility-title">Mobility Devices</div>
                        <div class="eligibility-description">Uses wheelchair, walker, crutches, etc.</div>
                    </div>
                    
                    <div class="eligibility-item" data-eligible="true">
                        <div class="eligibility-icon">‚ù§Ô∏è</div>
                        <div class="eligibility-title">Cardiac Conditions</div>
                        <div class="eligibility-description">Class III or IV heart conditions</div>
                    </div>
                    
                    <div class="eligibility-item" data-eligible="true">
                        <div class="eligibility-icon">üëÅÔ∏è</div>
                        <div class="eligibility-title">Visual Impairment</div>
                        <div class="eligibility-description">Legally blind individuals qualify</div>
                    </div>
                </div>

                <h4 style="margin: 25px 0 15px; color: var(--color-primary);">Application Process</h4>
                <div class="process-steps">
                    <div class="process-step" data-step="1">
                        <div class="process-step-header">
                            <div class="process-step-number">1</div>
                            <div class="process-step-title">Medical Certification</div>
                        </div>
                        <div class="process-step-details">
                            Obtain certification from a licensed physician, physician assistant, nurse practitioner, podiatrist, or chiropractor verifying your disability. Must include specific details about mobility limitations.
                        </div>
                    </div>
                    
                    <div class="process-step" data-step="2">
                        <div class="process-step-header">
                            <div class="process-step-number">2</div>
                            <div class="process-step-title">Complete Form MED 10</div>
                        </div>
                        <div class="process-step-details">
                            Fill out Virginia's Disabled Parking Placard or Plates Application (Form MED 10). Available online at DMV website or at any DMV customer service center.
                        </div>
                    </div>
                    
                    <div class="process-step" data-step="3">
                        <div class="process-step-header">
                            <div class="process-step-number">3</div>
                            <div class="process-step-title">Submit Application</div>
                        </div>
                        <div class="process-step-details">
                            Submit completed form with medical certification to DMV in person or by mail. No fee for permanent placards. Temporary placards may have minimal fees.
                        </div>
                    </div>
                </div>

                <!-- Feedback -->
                <div class="feedback-container" id="feedback-1">
                    <div class="feedback-title">
                        <span class="feedback-icon correct">‚úì</span>
                        Eligibility & Application Complete
                    </div>
                    <div class="feedback-content">
                        <strong>Key Information:</strong><br><br>
                        ‚Ä¢ <strong>Multiple Qualifying Conditions:</strong> Virginia recognizes various disabilities including walking limitations, mobility device users, cardiac conditions, and visual impairments.<br>
                        ‚Ä¢ <strong>Temporary Permits Available:</strong> Individuals recovering from surgery or injuries can obtain temporary permits (up to 6 months, renewable).<br>
                        ‚Ä¢ <strong>Medical Certification Required:</strong> Must be completed by licensed healthcare professional.<br>
                        ‚Ä¢ <strong>No Fee for Permanent:</strong> Virginia provides permanent handicapped placards free of charge.<br><br>
                        
                        <strong>Important Note:</strong> Handicapped parking permits are issued to the individual, not the vehicle. The permit holder must be present when using the space.
                    </div>
                </div>
            </section>

            <!-- Activity 2: Proper Usage -->
            <section class="activity-card" id="activity-2" data-activity="2">
                <div class="activity-header">
                    <span class="activity-number">Activity 2</span>
                    <span class="activity-status">Not Started</span>
                </div>
                <h3 class="activity-title">Proper Usage & Parking Rules</h3>
                <p class="activity-description">
                    Practice proper handicapped parking procedures with this interactive simulator. Learn where to display permits, 
                    how to identify valid spaces, and understand access aisle requirements.
                </p>

                <div class="activity-time-estimate">
                    <span class="activity-time-icon">‚è±Ô∏è</span>
                    <span class="activity-time-text">Estimated time: <strong>2 minutes</strong></span>
                </div>

                <div class="parking-simulator">
                    <h4 style="color: white; text-align: center; margin-bottom: 20px;">Parking Scenario: Is this parking legal?</h4>
                    
                    <div class="parking-space" id="parking-space">
                        üÖøÔ∏è HANDICAPPED PARKING
                        <div style="font-size: 0.8rem; margin-top: 10px;">Valid Permit Displayed ‚úì</div>
                    </div>
                    
                    <div class="access-aisle" id="access-aisle">
                        ACCESS AISLE - NO PARKING
                    </div>
                    
                    <div class="parking-controls">
                        <button class="parking-btn" data-scenario="correct-parking">
                            ‚úÖ Correct Parking
                        </button>
                        <button class="parking-btn" data-scenario="no-permit">
                            üö´ No Permit Displayed
                        </button>
                        <button class="parking-btn" data-scenario="block-aisle">
                            ‚õî Blocking Access Aisle
                        </button>
                        <button class="parking-btn" data-scenario="expired-permit">
                            üìÖ Expired Permit
                        </button>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px; color: #aaa; font-size: 0.9rem;">
                        <div id="scenario-feedback" style="font-weight: bold; min-height: 24px;"></div>
                    </div>
                </div>

                <div style="margin-top: 25px;">
                    <h4 style="color: var(--color-primary); margin-bottom: 15px;">Proper Display Requirements:</h4>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                        <div style="background: rgba(95, 23, 235, 0.05); padding: 15px; border-radius: var(--radius-sm);">
                            <strong>Placards:</strong> Hang from rearview mirror when parked. Remove while driving to avoid obstruction.
                        </div>
                        <div style="background: rgba(95, 23, 235, 0.05); padding: 15px; border-radius: var(--radius-sm);">
                            <strong>License Plates:</strong> Must be clearly visible and properly mounted on vehicle.
                        </div>
                    </div>
                </div>

                <!-- Feedback -->
                <div class="feedback-container" id="feedback-2">
                    <div class="feedback-title">
                        <span class="feedback-icon correct">‚úì</span>
                        Parking Rules Mastered
                    </div>
                    <div class="feedback-content">
                        <strong>Correct Parking Procedures:</strong><br><br>
                        ‚Ä¢ <strong>Valid Permit Required:</strong> Must display current, valid handicapped parking placard or have disabled license plates.<br>
                        ‚Ä¢ <strong>Permit Holder Present:</strong> The individual to whom the permit is issued must be in the vehicle.<br>
                        ‚Ä¢ <strong>Access Aisles Protected:</strong> Never park in or block the striped access aisle next to handicapped spaces.<br>
                        ‚Ä¢ <strong>Designated Spaces Only:</strong> Only use spaces marked with the International Symbol of Accessibility.<br><br>
                        
                        <strong>Common Violations:</strong><br>
                        - Using someone else's permit<br>
                        - Parking without the permit holder present<br>
                        - Blocking access aisles (even with a valid permit)<br>
                        - Using expired or counterfeit permits
                    </div>
                </div>
            </section>

            <!-- Activity 3: Laws & Enforcement -->
            <section class="activity-card" id="activity-3" data-activity="3">
                <div class="activity-header">
                    <span class="activity-number">Activity 3</span>
                    <span class="activity-status">Not Started</span>
                </div>
                <h3 class="activity-title">Laws & Enforcement Quiz</h3>
                <p class="activity-description">
                    Test your knowledge of Virginia's handicapped parking laws, penalties for violations, 
                    and enforcement procedures. Select the correct answer for each multiple-choice question.
                </p>

                <div class="activity-time-estimate">
                    <span class="activity-time-icon">‚è±Ô∏è</span>
                    <span class="activity-time-text">Estimated time: <strong>2 minutes</strong></span>
                </div>

                <div class="quiz-container" id="quiz-container">
                    <!-- Question 1 -->
                    <div class="quiz-question">1. What is the minimum fine for illegally parking in a handicapped space in Virginia?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-question="1" data-option="A">
                            <span class="option-label">A</span>
                            <span>$50-100</span>
                        </div>
                        <div class="quiz-option" data-question="1" data-option="B">
                            <span class="option-label">B</span>
                            <span>$100-500</span>
                        </div>
                        <div class="quiz-option" data-question="1" data-option="C">
                            <span class="option-label">C</span>
                            <span>$500-1,000</span>
                        </div>
                        <div class="quiz-option" data-question="1" data-option="D">
                            <span class="option-label">D</span>
                            <span>$25-75</span>
                        </div>
                    </div>

                    <!-- Question 2 -->
                    <div class="quiz-question">2. How often must permanent handicapped parking placards be renewed in Virginia?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-question="2" data-option="A">
                            <span class="option-label">A</span>
                            <span>Every year</span>
                        </div>
                        <div class="quiz-option" data-question="2" data-option="B">
                            <span class="option-label">B</span>
                            <span>Every 2 years</span>
                        </div>
                        <div class="quiz-option" data-question="2" data-option="C">
                            <span class="option-label">C</span>
                            <span>Every 5 years</span>
                        </div>
                        <div class="quiz-option" data-question="2" data-option="D">
                            <span class="option-label">D</span>
                            <span>Never (permanent means permanent)</span>
                        </div>
                    </div>

                    <!-- Question 3 -->
                    <div class="quiz-question">3. What additional penalty can occur if you park illegally in a handicapped space?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-question="3" data-option="A">
                            <span class="option-label">A</span>
                            <span>Vehicle may be towed at owner's expense</span>
                        </div>
                        <div class="quiz-option" data-question="3" data-option="B">
                            <span class="option-label">B</span>
                            <span>License suspension for 30 days</span>
                        </div>
                        <div class="quiz-option" data-question="3" data-option="C">
                            <span class="option-label">C</span>
                            <span>Mandatory community service</span>
                        </div>
                        <div class="quiz-option" data-question="3" data-option="D">
                            <span class="option-label">D</span>
                            <span>All of the above</span>
                        </div>
                    </div>
                    
                    <!-- Question 4 -->
                    <div class="quiz-question">4. Who can issue medical certification for a handicapped parking permit in Virginia?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-question="4" data-option="A">
                            <span class="option-label">A</span>
                            <span>Licensed physician only</span>
                        </div>
                        <div class="quiz-option" data-question="4" data-option="B">
                            <span class="option-label">B</span>
                            <span>Physician or nurse practitioner</span>
                        </div>
                        <div class="quiz-option" data-question="4" data-option="C">
                            <span class="option-label">C</span>
                            <span>Physician, PA, NP, podiatrist, or chiropractor</span>
                        </div>
                        <div class="quiz-option" data-question="4" data-option="D">
                            <span class="option-label">D</span>
                            <span>Any healthcare professional</span>
                        </div>
                    </div>
                </div>

                <!-- Feedback -->
                <div class="feedback-container" id="feedback-3">
                    <div class="feedback-title">
                        <span class="feedback-icon correct">‚úì</span>
                        Quiz Results
                    </div>
                    <div class="feedback-content">
                        <strong>Correct Answers:</strong><br>
                        1. <strong>B - $100-500</strong> (Fines vary by jurisdiction but start at $100)<br>
                        2. <strong>C - Every 5 years</strong> (Permanent placards must be renewed every 5 years)<br>
                        3. <strong>A - Vehicle may be towed at owner's expense</strong><br>
                        4. <strong>C - Physician, PA, NP, podiatrist, or chiropractor</strong><br><br>
                        
                        <strong>Enforcement Summary:</strong><br>
                        ‚Ä¢ <strong>Fines:</strong> $100-500 depending on jurisdiction<br>
                        ‚Ä¢ <strong>Towing:</strong> Illegal parkers can be towed immediately<br>
                        ‚Ä¢ <strong>Permit Revocation:</strong> Misuse can lead to permit revocation<br>
                        ‚Ä¢ <strong>Community Reporting:</strong> Citizens are encouraged to report violations to local law enforcement<br><br>
                        
                        <div style="background: rgba(239, 68, 68, 0.1); padding: 15px; border-radius: var(--radius-sm); border-left: 3px solid var(--color-error);">
                            <strong>‚ö†Ô∏è Serious Consequences:</strong> Handicapped parking violations are considered serious offenses in Virginia because they directly impact accessibility for individuals with disabilities.
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-secondary" id="reset-all-btn">
                <span class="btn-icon">‚Üª</span>
                Reset All Activities
            </button>
            <button class="btn btn-secondary" id="check-answers-btn">
                <span class="btn-icon">‚úì</span>
                Check All Answers
            </button>
            <button class="btn btn-primary" id="view-results-btn">
                <span class="btn-icon">üìä</span>
                View Final Results
            </button>
        </div>

        <!-- Results Panel -->
        <div class="results-panel" id="results-panel">
            <div class="results-header">
                <h2 class="results-title">Handicapped Parking Proficiency</h2>
                <div class="score-display" id="final-score">0%</div>
            </div>
            
            <div class="safety-insights">
                <h3 class="insights-title">
                    <span>‚ôø</span> Accessibility & Social Responsibility
                </h3>
                <ul class="insights-list">
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Essential Accessibility:</strong> Handicapped parking spaces provide critical access for 61 million Americans with disabilities. These spaces are typically 8-12 feet wider than standard spaces to accommodate wheelchair lifts and mobility devices.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Economic Impact:</strong> Americans with disabilities represent $490 billion in disposable income. Accessible parking ensures they can participate fully in economic and social activities.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Safety Considerations:</strong> Access aisles (striped areas next to handicapped spaces) provide essential room for wheelchair transfers. Blocking these aisles can trap individuals with disabilities in their vehicles.</span>
                    </li>
                </ul>
            </div>
            
            <div class="safety-insights" style="margin-top: 20px;">
                <h3 class="insights-title">
                    <span>üëÆ‚Äç‚ôÇÔ∏è</span> Enforcement & Community Action
                </h3>
                <ul class="insights-list">
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Reporting Violations:</strong> If you see illegal parking in handicapped spaces, note the vehicle description, license plate, time, and location. Report to local law enforcement or parking authorities. Many jurisdictions have dedicated hotlines.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Education Over Confrontation:</strong> While violations are frustrating, avoid confrontations. Some disabilities are not visible, and some drivers may have forgotten to display their permits. Report rather than confront.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Business Responsibility:</strong> Virginia law requires businesses to provide accessible parking. If you notice inadequate or improperly maintained handicapped parking at a business, you can report it to the Virginia Department of Housing and Community Development.</span>
                    </li>
                </ul>
            </div>
            
            <div class="safety-insights" style="margin-top: 20px; background: rgba(95, 23, 235, 0.1);">
                <h3 class="insights-title">
                    <span>üíô</span> Best Practices for All Drivers
                </h3>
                <ul class="insights-list">
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Never Use Without Authorization:</strong> Even "just for a minute" parking in handicapped spaces without authorization denies access to those who need it.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Respect Access Aisles:</strong> The striped areas are for wheelchair access, not temporary parking, standing, or shopping cart returns.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Support Accessibility:</strong> If you see someone struggling with accessibility issues, offer assistance (after asking if help is wanted) or report inadequate facilities.</span>
                    </li>
                </ul>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // State Management
            const state = {
                activities: {
                    1: { completed: false, correct: 0, total: 8, score: 0 },
                    2: { completed: false, correct: 0, total: 4, score: 0 },
                    3: { completed: false, correct: 0, total: 4, score: 0, answers: {} }
                },
                startedAt: new Date(),
                timeSpent: 0
            };

            // Correct answers for Activity 3 (quiz)
            const quizAnswers = {
                1: 'B',
                2: 'C',
                3: 'A',
                4: 'C'
            };

            // DOM Elements
            const progressSteps = document.querySelectorAll('.progress-step');
            const activityCards = document.querySelectorAll('.activity-card');
            const completedCount = document.getElementById('completed-count');
            const accuracyRate = document.getElementById('accuracy-rate');
            const timeSpentEl = document.getElementById('time-spent');
            const resetBtn = document.getElementById('reset-all-btn');
            const checkBtn = document.getElementById('check-answers-btn');
            const resultsBtn = document.getElementById('view-results-btn');
            const resultsPanel = document.getElementById('results-panel');
            const finalScore = document.getElementById('final-score');

            // Timer for time spent
            function updateTimer() {
                const now = new Date();
                const diff = Math.floor((now - state.startedAt) / 1000);
                state.timeSpent = diff;
                const minutes = Math.floor(diff / 60);
                const seconds = diff % 60;
                timeSpentEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                // Update stats display
                let completed = 0;
                let totalCorrect = 0;
                let totalItems = 0;
                
                Object.values(state.activities).forEach(activity => {
                    if (activity.completed) completed++;
                    totalCorrect += activity.correct;
                    totalItems += activity.total;
                });
                
                completedCount.textContent = completed;
                const accuracy = totalItems > 0 ? Math.round((totalCorrect / totalItems) * 100) : 0;
                accuracyRate.textContent = `${accuracy}%`;
            }

            setInterval(updateTimer, 1000);

            // Update Progress Summary
            function updateProgressSummary() {
                let completed = 0;
                let totalCorrect = 0;
                let totalItems = 0;
                
                Object.values(state.activities).forEach(activity => {
                    if (activity.completed) completed++;
                    totalCorrect += activity.correct;
                    totalItems += activity.total;
                });

                // Update progress steps
                progressSteps.forEach((step, index) => {
                    if (index < completed) {
                        step.classList.add('completed');
                        step.classList.remove('active');
                    } else if (index === completed) {
                        step.classList.add('active');
                        step.classList.remove('completed');
                    } else {
                        step.classList.remove('active', 'completed');
                    }
                });
            }

            // Activity 1: Eligibility & Application
            function initActivity1() {
                const eligibilityItems = document.querySelectorAll('.eligibility-item');
                const processSteps = document.querySelectorAll('.process-step');
                const status = document.querySelector('#activity-1 .activity-status');
                const feedback = document.getElementById('feedback-1');
                
                let eligibilityClicks = 0;
                let processClicks = 0;
                
                // Eligibility item click handlers
                eligibilityItems.forEach(item => {
                    item.addEventListener('click', function() {
                        if (!this.classList.contains('selected')) {
                            this.classList.add('selected');
                            eligibilityClicks++;
                            
                            // Mark as eligible (all are eligible in this activity)
                            this.classList.add('eligible');
                            
                            // Check completion
                            if (eligibilityClicks >= 3 && processClicks >= 2 && !state.activities[1].completed) {
                                state.activities[1].completed = true;
                                state.activities[1].correct = 8;
                                state.activities[1].score = 100;
                                status.textContent = 'Completed';
                                status.style.color = '#10b981';
                                document.querySelector('#activity-1').classList.add('completed');
                                feedback.classList.add('show');
                                updateProgressSummary();
                            }
                        }
                    });
                });
                
                // Process step click handlers
                processSteps.forEach(step => {
                    step.addEventListener('click', function() {
                        // Toggle active state
                        const isActive = this.classList.contains('active');
                        
                        if (!isActive) {
                            // Deactivate all other steps
                            processSteps.forEach(s => s.classList.remove('active'));
                            // Activate this step
                            this.classList.add('active');
                            
                            processClicks++;
                            
                            // Check completion
                            if (eligibilityClicks >= 3 && processClicks >= 2 && !state.activities[1].completed) {
                                state.activities[1].completed = true;
                                state.activities[1].correct = 8;
                                state.activities[1].score = 100;
                                status.textContent = 'Completed';
                                status.style.color = '#10b981';
                                document.querySelector('#activity-1').classList.add('completed');
                                feedback.classList.add('show');
                                updateProgressSummary();
                            }
                        }
                    });
                });
                
                // Auto-activate first items
                eligibilityItems[0].click();
                processSteps[0].click();
            }

            // Activity 2: Proper Usage
            function initActivity2() {
                const parkingBtns = document.querySelectorAll('.parking-btn');
                const parkingSpace = document.getElementById('parking-space');
                const accessAisle = document.getElementById('access-aisle');
                const scenarioFeedback = document.getElementById('scenario-feedback');
                const status = document.querySelector('#activity-2 .activity-status');
                const feedback = document.getElementById('feedback-2');
                
                let scenariosCompleted = 0;
                const scenarioResults = {
                    'correct-parking': { correct: true, message: '‚úÖ Correct! Valid permit displayed in designated space.' },
                    'no-permit': { correct: false, message: '‚ùå Illegal! No permit displayed. Fine: $100-500 + towing possible.' },
                    'block-aisle': { correct: false, message: '‚ùå Illegal! Blocking access aisle. Even with permit, this violates accessibility rules.' },
                    'expired-permit': { correct: false, message: '‚ùå Illegal! Expired permits are not valid. Must renew every 5 years.' }
                };
                
                parkingBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        const scenario = this.dataset.scenario;
                        const result = scenarioResults[scenario];
                        
                        // Reset all buttons
                        parkingBtns.forEach(b => {
                            b.classList.remove('legal', 'illegal');
                        });
                        
                        // Update visual feedback
                        if (result.correct) {
                            this.classList.add('legal');
                            scenarioFeedback.textContent = result.message;
                            scenarioFeedback.style.color = '#10b981';
                            
                            // Update parking space display
                            parkingSpace.innerHTML = 'üÖøÔ∏è HANDICAPPED PARKING<div style="font-size: 0.8rem; margin-top: 10px;">Valid Permit Displayed ‚úì</div>';
                            parkingSpace.classList.remove('occupied');
                        } else {
                            this.classList.add('illegal');
                            scenarioFeedback.textContent = result.message;
                            scenarioFeedback.style.color = '#ef4444';
                            
                            // Update parking space display
                            if (scenario === 'no-permit') {
                                parkingSpace.innerHTML = 'üÖøÔ∏è HANDICAPPED PARKING<div style="font-size: 0.8rem; margin-top: 10px;">NO PERMIT DISPLAYED ‚ö†Ô∏è</div>';
                            } else if (scenario === 'block-aisle') {
                                parkingSpace.classList.add('occupied');
                            }
                        }
                        
                        scenariosCompleted++;
                        
                        // Check completion
                        if (scenariosCompleted >= 3 && !state.activities[2].completed) {
                            state.activities[2].completed = true;
                            state.activities[2].correct = 4;
                            state.activities[2].score = 100;
                            status.textContent = 'Completed';
                            status.style.color = '#10b981';
                            document.querySelector('#activity-2').classList.add('completed');
                            feedback.classList.add('show');
                            updateProgressSummary();
                        }
                    });
                });
                
                // Auto-click first scenario
                parkingBtns[0].click();
            }

            // Activity 3: Laws & Enforcement Quiz
            function initActivity3() {
                const quizOptions = document.querySelectorAll('#activity-3 .quiz-option');
                const feedback = document.getElementById('feedback-3');
                const status = document.querySelector('#activity-3 .activity-status');
                
                let answeredQuestions = 0;
                
                quizOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        const question = this.dataset.question;
                        const selectedOption = this.dataset.option;
                        
                        // Remove selected class from all options for this question
                        const allOptionsForQuestion = document.querySelectorAll(`[data-question="${question}"]`);
                        allOptionsForQuestion.forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        
                        // Add selected class to clicked option
                        this.classList.add('selected');
                        
                        // Store the answer
                        state.activities[3].answers[question] = selectedOption;
                        
                        // Check if all questions are answered
                        answeredQuestions = Object.keys(state.activities[3].answers).length;
                        if (answeredQuestions === 4 && !state.activities[3].completed) {
                            checkActivity3();
                        }
                    });
                });
                
                function checkActivity3() {
                    let correctCount = 0;
                    
                    // Check each answer
                    Object.keys(quizAnswers).forEach(question => {
                        const userAnswer = state.activities[3].answers[question];
                        const correctAnswer = quizAnswers[question];
                        
                        if (userAnswer === correctAnswer) {
                            correctCount++;
                            
                            // Mark correct option
                            const correctOption = document.querySelector(`[data-question="${question}"][data-option="${correctAnswer}"]`);
                            correctOption.classList.add('correct');
                        } else {
                            // Mark incorrect user selection
                            const userOption = document.querySelector(`[data-question="${question}"][data-option="${userAnswer}"]`);
                            if (userOption) userOption.classList.add('incorrect');
                            
                            // Mark correct answer
                            const correctOption = document.querySelector(`[data-question="${question}"][data-option="${correctAnswer}"]`);
                            correctOption.classList.add('correct');
                        }
                    });
                    
                    state.activities[3].completed = true;
                    state.activities[3].correct = correctCount;
                    state.activities[3].score = Math.round((correctCount / 4) * 100);
                    
                    status.textContent = 'Completed';
                    status.style.color = '#10b981';
                    document.querySelector('#activity-3').classList.add('completed');
                    feedback.classList.add('show');
                    
                    updateProgressSummary();
                }
            }

            // Reset All Activities
            function resetAllActivities() {
                // Reset state
                Object.keys(state.activities).forEach(key => {
                    state.activities[key] = {
                        completed: false,
                        correct: 0,
                        total: parseInt(key) === 1 ? 8 : parseInt(key) === 2 ? 4 : 4,
                        score: 0,
                        answers: {}
                    };
                });
                
                // Reset UI
                activityCards.forEach(card => {
                    card.classList.remove('completed');
                    const status = card.querySelector('.activity-status');
                    status.textContent = 'Not Started';
                    status.style.color = '';
                    const feedback = card.querySelector('.feedback-container');
                    feedback.classList.remove('show');
                });
                
                // Reset Activity 1
                document.querySelectorAll('.eligibility-item').forEach(item => {
                    item.classList.remove('selected', 'eligible', 'not-eligible');
                });
                
                document.querySelectorAll('.process-step').forEach(step => {
                    step.classList.remove('active');
                });
                
                // Reset Activity 2
                document.querySelectorAll('.parking-btn').forEach(btn => {
                    btn.classList.remove('legal', 'illegal');
                });
                
                document.getElementById('parking-space').innerHTML = 'üÖøÔ∏è HANDICAPPED PARKING<div style="font-size: 0.8rem; margin-top: 10px;">Valid Permit Displayed ‚úì</div>';
                document.getElementById('parking-space').classList.remove('occupied');
                document.getElementById('scenario-feedback').textContent = '';
                
                // Reset Activity 3
                document.querySelectorAll('#activity-3 .quiz-option').forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                });
                
                // Reset results
                resultsPanel.classList.remove('show');
                
                // Reset timer
                state.startedAt = new Date();
                state.timeSpent = 0;
                updateTimer();
                
                // Update progress
                updateProgressSummary();
            }

            // Check All Answers
            function checkAllAnswers() {
                // Force check all activities
                if (!state.activities[1].completed) {
                    // Auto-select all eligibility items
                    document.querySelectorAll('.eligibility-item').forEach(item => {
                        item.classList.add('selected', 'eligible');
                    });
                    
                    // Auto-activate all process steps
                    document.querySelectorAll('.process-step').forEach(step => {
                        step.classList.add('active');
                    });
                    
                    state.activities[1].completed = true;
                    state.activities[1].correct = 8;
                    state.activities[1].score = 100;
                    document.querySelector('#activity-1 .activity-status').textContent = 'Completed';
                    document.querySelector('#activity-1').classList.add('completed');
                    document.querySelector('#feedback-1').classList.add('show');
                }
                
                if (!state.activities[2].completed) {
                    // Auto-complete parking scenarios
                    document.querySelectorAll('.parking-btn').forEach(btn => {
                        if (btn.dataset.scenario === 'correct-parking') {
                            btn.classList.add('legal');
                        } else {
                            btn.classList.add('illegal');
                        }
                    });
                    
                    document.getElementById('scenario-feedback').textContent = '‚úÖ Correct! Valid permit displayed in designated space.';
                    document.getElementById('scenario-feedback').style.color = '#10b981';
                    
                    state.activities[2].completed = true;
                    state.activities[2].correct = 4;
                    state.activities[2].score = 100;
                    document.querySelector('#activity-2 .activity-status').textContent = 'Completed';
                    document.querySelector('#activity-2').classList.add('completed');
                    document.querySelector('#feedback-2').classList.add('show');
                }
                
                if (!state.activities[3].completed) {
                    // Auto-select correct answers
                    Object.keys(quizAnswers).forEach(question => {
                        const correctOption = document.querySelector(`[data-question="${question}"][data-option="${quizAnswers[question]}"]`);
                        if (correctOption) {
                            correctOption.classList.add('selected', 'correct');
                            state.activities[3].answers[question] = quizAnswers[question];
                        }
                    });
                    
                    state.activities[3].completed = true;
                    state.activities[3].correct = 4;
                    state.activities[3].score = 100;
                    document.querySelector('#activity-3 .activity-status').textContent = 'Completed';
                    document.querySelector('#activity-3').classList.add('completed');
                    document.querySelector('#feedback-3').classList.add('show');
                }
                
                updateProgressSummary();
            }

            // View Final Results
            function viewFinalResults() {
                let totalScore = 0;
                let activityCount = 0;
                
                Object.values(state.activities).forEach(activity => {
                    if (activity.completed) {
                        totalScore += activity.score;
                        activityCount++;
                    }
                });
                
                const averageScore = activityCount > 0 ? Math.round(totalScore / activityCount) : 0;
                finalScore.textContent = `${averageScore}%`;
                
                resultsPanel.classList.add('show');
                resultsPanel.scrollIntoView({ behavior: 'smooth' });
            }

            // Initialize all activities
            initActivity1();
            initActivity2();
            initActivity3();

            // Event listeners
            resetBtn.addEventListener('click', resetAllActivities);
            checkBtn.addEventListener('click', checkAllAnswers);
            resultsBtn.addEventListener('click', viewFinalResults);

            // Initial progress update
            updateTimer();
            updateProgressSummary();
        });
    </script>
</body>
</html>
